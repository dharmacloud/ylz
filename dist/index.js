var app=function(){"use strict";function n(){}function t(n,t){for(const e in t)n[e]=t[e];return n}function e(n){return n()}function i(){return Object.create(null)}function s(n){n.forEach(e)}function o(n){return"function"==typeof n}function r(n,t){return n!=n?t==t:n!==t||n&&"object"==typeof n||"function"==typeof n}let l,c,a;function u(n,t){return n===t||(l||(l=document.createElement("a")),l.href=t,n===l.href)}function d(t,...e){if(null==t){for(const n of e)n(void 0);return n}const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function f(n){let t;return d(n,(n=>t=n))(),t}function h(n,t,e){n.$$.on_destroy.push(d(t,e))}function p(n,t,e,i){if(n){const s=g(n,t,e,i);return n[0](s)}}function g(n,e,i,s){return n[1]&&s?t(i.ctx.slice(),n[1](s(e))):i.ctx}function m(n,t,e,i){if(n[2]&&i){const s=n[2](i(e));if(void 0===t.dirty)return s;if("object"==typeof s){const n=[],e=Math.max(t.dirty.length,s.length);for(let i=0;i<e;i+=1)n[i]=t.dirty[i]|s[i];return n}return t.dirty|s}return t.dirty}function $(n,t,e,i,s,o){if(s){const r=g(t,e,i,o);n.p(r,s)}}function v(n){if(n.ctx.length>32){const t=[],e=n.ctx.length/32;for(let n=0;n<e;n++)t[n]=-1;return t}return-1}function k(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function b(n,t){n.appendChild(t)}function y(n,t,e){n.insertBefore(t,e||null)}function x(n){n.parentNode&&n.parentNode.removeChild(n)}function w(n,t){for(let e=0;e<n.length;e+=1)n[e]&&n[e].d(t)}function A(n){return document.createElement(n)}function C(n){return document.createTextNode(n)}function O(){return C(" ")}function P(){return C("")}function I(n,t,e,i){return n.addEventListener(t,e,i),()=>n.removeEventListener(t,e,i)}function T(n,t,e){null==e?n.removeAttribute(t):n.getAttribute(t)!==e&&n.setAttribute(t,e)}function _(n){let t;return{p(...e){t=e,t.forEach((t=>n.push(t)))},r(){t.forEach((t=>n.splice(n.indexOf(t),1)))}}}function S(n,t){t=""+t,n.data!==t&&(n.data=t)}function N(n,t){n.value=null==t?"":t}function E(n,t,e,i){null==e?n.style.removeProperty(t):n.style.setProperty(t,e,i?"important":"")}function z(){if(void 0===c){c=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(n){c=!0}}return c}function L(n,t,e){n.classList.toggle(t,!!e)}class M{c(n){this.h(n)}m(n,t,e=null){this.e||(this.is_svg?this.e=function(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}(t.nodeName):this.e=A(11===t.nodeType?"TEMPLATE":t.nodeName),this.t="TEMPLATE"!==t.tagName?t:t.content,this.c(n)),this.i(e)}h(n){this.e.innerHTML=n,this.n=Array.from("TEMPLATE"===this.e.nodeName?this.e.content.childNodes:this.e.childNodes)}i(n){for(let t=0;t<this.n.length;t+=1)y(this.t,this.n[t],n)}p(n){this.d(),this.h(n),this.i(this.a)}d(){this.n.forEach(x)}constructor(n=!1){k(this,"is_svg",!1),k(this,"e",void 0),k(this,"n",void 0),k(this,"t",void 0),k(this,"a",void 0),this.is_svg=n,this.e=this.n=null}}function j(n){a=n}function F(){if(!a)throw new Error("Function called outside component initialization");return a}function B(n){F().$$.on_mount.push(n)}function q(n){F().$$.on_destroy.push(n)}function R(){const n=F();return(t,e,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[t];if(s){const o=function(n,t,{bubbles:e=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:t,bubbles:e,cancelable:i})}(t,e,{cancelable:i});return s.slice().forEach((t=>{t.call(n,o)})),!o.defaultPrevented}return!0}}const H=[],U=[];let W=[];const D=[],K=Promise.resolve();let J=!1;function Y(n){W.push(n)}function Q(n){D.push(n)}const V=new Set;let G=0;function X(){if(0!==G)return;const n=a;do{try{for(;G<H.length;){const n=H[G];G++,j(n),Z(n.$$)}}catch(n){throw H.length=0,G=0,n}for(j(null),H.length=0,G=0;U.length;)U.pop()();for(let n=0;n<W.length;n+=1){const t=W[n];V.has(t)||(V.add(t),t())}W.length=0}while(H.length);for(;D.length;)D.pop()();J=!1,V.clear(),j(n)}function Z(n){if(null!==n.fragment){n.update(),s(n.before_update);const t=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,t),n.after_update.forEach(Y)}}const nn=new Set;let tn;function en(){tn={r:0,c:[],p:tn}}function sn(){tn.r||s(tn.c),tn=tn.p}function on(n,t){n&&n.i&&(nn.delete(n),n.i(t))}function rn(n,t,e,i){if(n&&n.o){if(nn.has(n))return;nn.add(n),tn.c.push((()=>{nn.delete(n),i&&(e&&n.d(1),i())})),n.o(t)}else i&&i()}function ln(n){return void 0!==(null==n?void 0:n.length)?n:Array.from(n)}function cn(n,t){const e={},i={},s={$$scope:1};let o=n.length;for(;o--;){const r=n[o],l=t[o];if(l){for(const n in r)n in l||(i[n]=1);for(const n in l)s[n]||(e[n]=l[n],s[n]=1);n[o]=l}else for(const n in r)s[n]=1}for(const n in i)n in e||(e[n]=void 0);return e}function an(n){return"object"==typeof n&&null!==n?n:{}}function un(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function dn(n,t,e){const i=n.$$.props[t];void 0!==i&&(n.$$.bound[i]=e,e(n.$$.ctx[i]))}function fn(n){n&&n.c()}function hn(n,t,i){const{fragment:r,after_update:l}=n.$$;r&&r.m(t,i),Y((()=>{const t=n.$$.on_mount.map(e).filter(o);n.$$.on_destroy?n.$$.on_destroy.push(...t):s(t),n.$$.on_mount=[]})),l.forEach(Y)}function pn(n,t){const e=n.$$;null!==e.fragment&&(!function(n){const t=[],e=[];W.forEach((i=>-1===n.indexOf(i)?t.push(i):e.push(i))),e.forEach((n=>n())),W=t}(e.after_update),s(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function gn(n,t){-1===n.$$.dirty[0]&&(H.push(n),J||(J=!0,K.then(X)),n.$$.dirty.fill(0)),n.$$.dirty[t/31|0]|=1<<t%31}function mn(t,e,o,r,l,c,u=null,d=[-1]){const f=a;j(t);const h=t.$$={fragment:null,ctx:[],props:c,update:n,not_equal:l,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:i(),dirty:d,skip_bound:!1,root:e.target||f.$$.root};u&&u(h.root);let p=!1;if(h.ctx=o?o(t,e.props||{},((n,e,...i)=>{const s=i.length?i[0]:e;return h.ctx&&l(h.ctx[n],h.ctx[n]=s)&&(!h.skip_bound&&h.bound[n]&&h.bound[n](s),p&&gn(t,n)),e})):[],h.update(),p=!0,s(h.before_update),h.fragment=!!r&&r(h.ctx),e.target){if(e.hydrate){const n=function(n){return Array.from(n.childNodes)}(e.target);h.fragment&&h.fragment.l(n),n.forEach(x)}else h.fragment&&h.fragment.c();e.intro&&on(t.$$.fragment),hn(t,e.target,e.anchor),X()}j(f)}class $n{$destroy(){pn(this,1),this.$destroy=n}$on(t,e){if(!o(e))return n;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(e),()=>{const n=i.indexOf(e);-1!==n&&i.splice(n,1)}}$set(n){var t;this.$$set&&(t=n,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}constructor(){un(this,"$$",void 0),un(this,"$$set",void 0)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const vn=/\^([#@\/\.\:a-z_\-\d~]*)([<\{\[](?:\\.|.)*?[>\}\]])?/g,kn=/\u001a(\d+)/g,bn=/([a-z_\:]+)(.*)/,yn=/^([a-z\d]+[_a-z\d\-~\.]*)/,xn=/"((?:\\.|.)*?)"/g,wn=/^(>\d+)?(<\d+)?(:[\-\d]+)?$/,An=/^([a-z\.\d\-_]+\:)(>\d+)?(<\d+)?(:[\-\d]+)?$/,Cn=/^([a-z\.\d\-_]+\:)?([^<>\d:]+[^:<>]*)(>\d+)?(<\d+)?(:[\-\d]+)?$/,On={BMP:[19968,40869],SurrogageLeft:[55296,56319],SurrogageRight:[56320,57343],ExtA:[13312,19967],ExtB:[131072,173823],ExtC:[173824,177983],ExtD:[177984,178207],ExtE:[178208,183983],ExtF:[183984,191456],ExtG:[196608,201551],ExtH:[201552,205743],ExtZ:[655360,870399]},Pn=n=>{let t=0;if("string"==typeof n){const e=parseInt(n,16);t=isNaN(e)?n.codePointAt(0)||0:e}for(let n in On){const[e,i]=On[n];if(t>=e&&t<=i)return n}},In=n=>{if(!n)return!1;const t=n.charCodeAt(0);return t>=12289&&t<=12319||t>65280||t>=65040&&t<=65131},Tn=n=>{if(!n)return"";const t="<{[(｛「『〔（︹︵︷【︻《〈︽︿﹁﹃﹙﹝﹛‘“〝‵".indexOf(n.slice(0,1));return~t?">}])｝」』〕）︺︶︸】︼》〉︾﹀﹂﹄﹚﹞﹜’”〞′"[t]:""},_n=n=>{const t=Tn(n);return t&&n.slice(n.length-1)==t?n.slice(1,n.length-1):n},Sn={"「":"﹁","」":"﹂","『":"﹃","』":"﹄"},Nn=(n,t,e)=>{if(!n||!e||e<0)return"";let i=t;for(;e>0&&i<n.length;)n.codePointAt(i)>65535&&i++,e--,i++;return n.slice(t,i)},En=n=>(n=>{if(!n)return[];let t=0;const e=[];for(;t<n.length;){const i=n.codePointAt(t)||0;e.push(i),t++,i>65535&&t++}return e})(n).map((n=>String.fromCodePoint(n))),zn=/(^[\u2e80-\u2fd5\u3400-\u9fff\ud400-\udfff\ue000\uffff]+)/,Ln=/([\dA-Za-z\u1000-\u1049\u0900-\u0963\u96f\u00c0-\u02af\u1e00-\u1faf][\dA-Za-z\u1000-\u1049\u0900-\u0963\u96f\u00c0-\u02af\u1e00-\u1faf\d]* ?)/g;var Mn=function(n){return n[n.UNSEARCHABLE=1]="UNSEARCHABLE",n[n.OFFTAG=3]="OFFTAG",n[n.SEARCHABLE=16]="SEARCHABLE",n[n.ROMANIZE=32]="ROMANIZE",n[n.MYANMAR=33]="MYANMAR",n[n.CJK=48]="CJK",n[n.CJK_BMP=49]="CJK_BMP",n[n.CJK_SURROGATE=50]="CJK_SURROGATE",n}({});function jn(n,t,e,i,s=0){return{text:n,choff:t,tkoff:e,type:i}}const Fn=n=>{const t=[];let e=0,i=0;if("string"!=typeof n)return[];for(;e<n.length;){let s=n.codePointAt(e)||0;if(s>65535){const n=String.fromCodePoint(s);t.push(jn(n,e,i,50)),i++,e+=2;continue}if(s>=8192&&s<=65535){const o=s>=2e80&&s<=12287||s>=12353&&s<=40959||s>=54272&&s<57343||s>=57344&&s<64223?49:1;t.push(jn(n[e],e,i,o)),1!==o&&i++,e++;continue}let o="",r=0,l=e;for(;l<n.length&&s<8192;)o+=n[l],s=n.codePointAt(++l)||0;o.replace(Ln,((n,s,l)=>{for(l>r&&t.push(jn(o.substring(r,l),r+e,i,1));" "==o[l];)l++;return t.push(jn(s,e+l,i,32)),i++,r=l+n.length,""})),r<o.length&&t.push(jn(o.substring(r),r+e,i,1)),e=l}return t},Bn={"[":"]","{":"}"},qn=n=>{if("{"!==n.charAt(0))return["",0];let t=n[0],e=Bn[t],i=-1,s=0;return((n,t)=>{let e;for(let i=0;i<n.length&&(e=t(n[i],i,n),!e);i++);})(n=n.substring(0),((n,o)=>{if(n===t?s++:n===e&&s--,!s)return i=o,!0})),-1===i?["",0]:[n.substring(0,i+1),i+1]};function Rn(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}const Hn=(n,t)=>{let e=Array();const i=(n,t=!1)=>n.replace(kn,((n,i)=>(t?'"':"")+e[parseInt(i)]+(t?'"':"")));const s=(n?n.slice(1,n.length-1).replace(xn,((n,t)=>(e.push(t),""+(e.length-1)))):"").split(/( +)/),o={};for(t&&Object.assign(o,(n=>{const t={},e=n.split(/([@#~])/);for(;e.length;){let n=e.shift();if("~"===n)t.to=e.shift();else if("@"===n)t.ln=e.shift();else if("#"===n){n=e.shift()||"";const i=n.match(yn);i&&(t.id=i[1])}else t.id=n}return t})(t));s.length;){const n=s.shift()||"";let t=-1,e="";"~"==n[0]||"#"==n[0]||"@"==n[0]?(e=n[0],"#"==e&&(e="id"),"@"==e&&(e="ln"),"~"==e&&(e="to"),t="="==n[1]?1:0):(t=n.indexOf("="),t>0&&(e=n.slice(0,t))),t>-1?(o[e]=i(n.slice(t+1)),s.length&&!s[0].trim()&&s.shift()):n&&(o[n]=!0)}return o},Un=(n,t)=>{let e={};if("^"==n[0]&&(n=n.slice(1)),t)if("<"!==t[0]&&"{"!==t[0])t="";else{const e=n.indexOf("<");(n.indexOf("{")>0||e>0)&&(t=n.slice(e),n=n.slice(0,e))}const i=n.match(bn);if(i){let[n,s,o]=i;if(t&&"{"==t.charAt(0)){const n=(n=>{try{return JSON.parse(n)}catch(t){return n=n.replace(/([a-zA-Z0-9_$]+\s*):/g,'"$1":').replace(/'([^']+?)'([\s,\]\}])/g,'"$1"$2'),JSON.parse(n)}})(t);e=Hn("",o);for(let t in n)e[t]=n[t]}else(o||t)&&(e=Hn(t,o));return[s,e]}return console.log("\ninvalid tag, raw",n,"attr",t),[n,{}]},Wn=(n,t=0)=>{if(!n||-1==n.indexOf("^"))return[n||"",[]];let e=Array(),i=0,s=0,o=n.replace(vn,((o,r,l,c)=>{if(!r){if(l&&l.startsWith("[")){const n={name:"",offset:c,aoffset:c+1,attrs:{},line:t,choff:i,width:0,start:c+2,end:c+l.length,active:!1};e.push(n);return _n(l)}return""}let[a,u]=Un(r,l),d=0,f=c+o.length,h=f,p=u["~"];if(p)if(isNaN(parseInt(p))){d=0;let t=0;const e=p.match(/\+(\d+)$/);e&&(p=p.slice(0,p.length-e.length),t=parseInt(e[1]));let i=n.indexOf(p,f);for(;~i&&t;)i=n.indexOf(p,i+1),t--;~i&&(h=i+p.length,delete u["~"])}else d=parseInt(p);else{const t=Tn(n.charAt(f));if(t){const e=n.indexOf(t,f+1);~e&&(h=e+t.length)}}const g=c+r.length+1;i+=c-s;let m={name:a,offset:c,aoffset:g,attrs:u,line:t,choff:i,width:d,start:f,end:h,active:!1};return e.push(m),i-=o.length,s=c,""}));return((n,t,e)=>{for(let n=0;n<e.length;n++){const t=e[n];let i=n;if(t.end>t.start&&!t.width){for(;i<e.length&&t.end>e[i].start;)i++;(i<e.length&&e[i].start>t.end||i==e.length)&&i--;const n=i<e.length?e[i]:t;t.width=t.end-n.start,t.width+=n.choff-t.choff}}for(let n=0;n<e.length;n++){const i=e[n];if(i.width&&i.end==i.start){i.width=Nn(t,i.choff,i.width).length;let s=n+1;for(;s<e.length&&i.choff+i.width>e[s].choff;)s++;(s<e.length&&e[s].choff>i.choff+i.width||s==e.length)&&s--;const o=s<e.length?e[s]:i;o===i?i.end+=i.width:i.end=o.start+(i.choff+i.width-o.choff)}}})(0,o,e),e.length&&e[e.length-1].choff>=o.length&&(o+=" "),[o,e]},Dn=(n,t,e)=>{for(let i in e.attrs)if(e.attrs[i]!=t.attrs[i]){let s="string"!=typeof e.attrs[i]?JSON.stringify(e.attrs[i]):e.attrs[i];s.indexOf(" ")>0&&(s='"'+s+'"');const o=new RegExp("\\b"+i+' *= *"?'+t.attrs[i]+'"?');n=n.replace(o,i+"="+s)}return n};class Kn{getTag(n){return this.tags[n]}tagText(n,t=!1){return"number"==typeof n&&(n=this.tags[n]),n?t?this.raw.slice(n.start,n.end):this.plain.slice(n.choff,n.choff+n.width):""}tagRawText(n){return this.tagText(n,!0)}constructor(n,t=0){Rn(this,"raw",void 0),Rn(this,"plain",void 0),Rn(this,"tags",void 0),this.raw=n;let[e,i]=Wn(n,t);this.plain=e,this.tags=i}}const Jn=n=>{let t=0;const e=n.match(/\.(\d+)/);e&&(t=parseInt(e[1]),n=n.replace(e[0],""));let[i,s]=n.split("@");return[i,s,t]},Yn=n=>{n.startsWith("^")&&(n=n.slice(1));let t="",e=n;n.indexOf("[")||(t=(n=>{let t="",e=0,i=n.charAt(0);if("{"==i){const[t,e]=qn(n);return n.slice(0,e)}for(;t.length<128&&i&&e<n.length;){const s=n.charCodeAt(e)||0;if(!(s>45&&s<=59||s>=97&&s<=122||64==s||35==s||95==s||126==s))break;t+=i,e++,i=n.charAt(e)}return t})(n),e=_n(n.slice(t.length)));const i=e.indexOf("|");let s=e;return i>0&&(s=e.slice(0,i),e=e.slice(i+1)),[t,e,s]},Qn=(n,t)=>{let e,i=0,s=n.length-1;for(;i<s;){if(e=i+s>>1,n[e]===t){for(;e>-1&&n[e-1]===t;)e--;return e}n[e]<t?i=e+1:s=e}return i},Vn=(n,t)=>{let e,i=0,s=n.length-1;for(;i<s;){if(e=i+s>>1,n[e]===t){for(;e>-1&&n[e-1]===t;)e--;return e}n[e]<t?i=e+1:s=e}return i},Gn=(n,t)=>{let e=0,i=parseInt(n(-1))-1;for(;e<i;){let s=e+i>>1;if(n(s)===t){for(;s>-1&&n(s-1)===t;)s--;return s}n(s)<t?e=s+1:i=s}return e},Xn=(n,t)=>n>t?1:n<t?-1:0,Zn=(n,t)=>n[0]>t[0]?1:n[0]<t[0]?-1:0,nt=(n,t=!1)=>{if(!n||!n.length)return[];t||n.sort("string"==typeof n[0]?Xn:(n,t)=>n-t);let e,i=[];for(let t=0;t<n.length;t++)n[t]!==e&&i.push(n[t]),e=n[t];return i},tt=(n,t)=>{const e=[];for(let i in n)t?"function"==typeof t?e.push(t(i,n[i])):e.push([i,n[i]]):e.push(i+"\t"+n[i]);return t&&"function"!=typeof t&&e.sort(((n,t)=>t[1]-n[1])),e},et=(n,t)=>{const e=[];for(let i=0;i<n.length;i++)~n[i].indexOf(t)&&e.push(i);return e},it=14,st=113,ot=5017,rt=209321,lt=8866703,ct=334961425,at=(n,t=!1)=>{let e=[];if(!n)return[];let i,s=0,o=0,r=0;for(;s<n.length;){if(i=n.charCodeAt(s)-it,i<45);else if(i<89){const t=n.charCodeAt(++s)-it;i-=45,i=i*st+t+45}else if(i<105){const t=n.charCodeAt(++s)-it,e=n.charCodeAt(++s)-it;i-=89,i=i*st*st+t*st+e+ot}else if(i<112){const t=n.charCodeAt(++s)-it,e=n.charCodeAt(++s)-it,o=n.charCodeAt(++s)-it;i-=105,i=i*st*st*st+t*st*st+e*st+o+rt}else{if(!(i<127))throw new Error("exit max integer 0x7f,"+i);{const t=n.charCodeAt(++s)-it,e=n.charCodeAt(++s)-it,o=n.charCodeAt(++s)-it,r=n.charCodeAt(++s)-it;i-=112,i=i*st*st*st*st+t*st*st*st+e*st*st+o*st+r+rt}}e[o]=i+(t?r:0)-1,r=e[o],o++,s++}return e},ut=n=>at(n,!0),dt=n=>n?ft(n,!0):[],ft=(n,t=!1)=>{if(!n)return[];const e=n.split("");return 1==e.length?[at(e[0])]:e.map((n=>at(n,t)))},ht=(n,t=!1)=>{const e=[];for(let i=0;i<n.length;i++)e.push(pt(n[i],t));return e.join("")},pt=(n,t=!1)=>{if(0==n.length)return"";const e=5*n.length;let i=new Uint8Array(e),s=n[0]+1,o=n[0],r=0;for(let e=1;e<=n.length;e++){if(s<45)i[r++]=s+it;else if(s<ot){let n,t;s-=45,n=s%st,t=Math.floor(s/st),i[r++]=t+45+it,i[r++]=n+it}else if(s<rt){let n,t,e;s-=ot,n=s%st,s=Math.floor(s/st),t=s%st,e=Math.floor(s/st),i[r++]=e+89+it,i[r++]=t+it,i[r++]=n+it}else if(s<lt){let n,t,e,o;s-=rt,n=s%st,s=Math.floor(s/st),t=s%st,s=Math.floor(s/st),e=s%st,o=Math.floor(s/st),i[r++]=o+105+it,i[r++]=e+it,i[r++]=t+it,i[r++]=n+it}else{if(!(s<ct))throw new Error("exist max int boundary "+ct+" i"+e+",val:"+n[e]+" int"+s);{let n,t,e,o,l;s-=lt,n=s%st,s=Math.floor(s/st),t=s%st,s=Math.floor(s/st),e=s%st,s=Math.floor(s/st),o=s%st,l=Math.floor(s/st),i[r++]=l+112+it,i[r++]=o+it,i[r++]=e+it,i[r++]=t+it,i[r++]=n+it}}if(s=(t?n[e]-o:n[e])+1,s<0&&t)throw console.log("arr length",n.length,"now",n[e],"prev",o),new Error("negative delta");o=n[e]||0}return(new TextDecoder).decode(i.subarray(0,r))},gt=n=>ht(n,!0);function mt(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}const $t="";class vt{buildcharpos(){let n=-1;for(;0<this.buf.length;){const t=this.buf.indexOf(this.sep,n);if(-1==t){this.charpos.push(this.buf.length);break}this.charpos.push(t+1),n=t+1}}len(){return this.charpos.length}reset(){this.now=0}first(){return this.reset(),this.next()}next(){if(-1==this.now)return;const n=this.buf.indexOf(this.sep,this.now);if(-1==n){if(this.now>=0){const n=this.buf.slice(this.now);return this.now=-1,n}return void(this.now=-1)}const t=this.buf.slice(this.now,n);return this.now=n+1,t}get(n){if(-1==n)return this.charpos.length.toString();if(this.sequencial||n<0)return"";const t=0==n?0:this.charpos[n-1],e=this.charpos[n]-(n==this.charpos.length-1?0:1);return this.buf.slice(t,e)}at(n){return Qn(this.charpos,n)}find(n){const t=this.get.bind(this);this.delimiter&&(n+=this.delimiter);const e=Gn(t,n);return t(e).endsWith(n)?e:-1}indexOf(n){let t;for(t=this.buf.indexOf(n);t>-1;){if(0==t&&this.buf.charAt(n.length)==this.sep)return 0;if(this.buf.length==n.length+t&&this.buf.charAt(t-1)==this.sep)return this.len()-1;if(this.buf.charAt(t-1)==this.sep&&this.buf.charAt(t+n.length)==this.sep)return Qn(this.charpos,t)+1;t=this.buf.indexOf(n,t+n.length)}return-1}enumMiddle(n,t=999){if(this.middleCache.hasOwnProperty(n))return this.middleCache[n];let e=this.buf.indexOf(n);const i=Array();for(;e>-1;){const s=this.at(e),o=s?this.charpos[s-1]:0,r=this.charpos[s]-1-n.length;if(e>o&&e<r&&(i.push(s),i.length>t))break;e=this.buf.indexOf(n,this.charpos[s]+this.sep.length)}return this.middleCache[n]=i,i}enumStart(n,t=999){const e=this.get.bind(this);let i=Gn(e,n);if(-1==i)return[];const s=Array(),o=this.len();for(;i<o;){if(!this.get(i).startsWith(n))break;if(s.push(i),s.length>t)break;i++}return s}enumEnd(n,t=999){if(this.endCache.hasOwnProperty(n))return console.log("cache"),this.endCache[n];n[n.length-1]!==this.sep&&(n+=this.sep);let e=this.buf.indexOf(n);const i=Array();for(;e>-1&&this.buf.charAt(e-1)!==this.sep;){const s=this.at(e);if(i.push(s),i.length>t)break;e=this.buf.indexOf(n,e+this.sep.length)}return this.endCache[n]=i,i}enumAny(n,t=999){if(this.middleCache.hasOwnProperty(n))return this.middleCache[n];let e=this.buf.indexOf(n);const i=Array();for(;e>-1;){const s=this.at(e),o=s?this.charpos[s-1]:0,r=this.charpos[s]-1-n.length;if(e>=o&&e<=r&&(i.push(s),i.length>t))break;e=this.buf.indexOf(n,this.charpos[s]+this.sep.length)}return this.middleCache[n]=i,i}enumMode(n,t=0,e){return 3==t?this.enumAny(n,e):0==t?this.enumStart(n,e):1==t?this.enumMiddle(n,e):2==t?this.enumEnd(n,e):[]}matchLongest(n){const t=this.get.bind(this),e=Gn(t,n)-1,i=[];let s=e-1;n.startsWith(this.get(e))&&i.push([this.get(e),e]);let o=e+1;for(;s>0;){const t=this.get(s);if(n.startsWith(t))i.push([t,s]);else if(n.codePointAt(0)<256||n[0]!==t[0])break;s--}for(;o<this.len();){const t=this.get(o);if(n.startsWith(t))i.push([t,o]);else if(n.codePointAt(0)<256||n[0]!==t[0])break;o++}return i.sort(((n,t)=>t[0].length-n[0].length)),i}getValue(n){const t=this.find(n);return~t?this.get(t).slice(n.length+this.delimiter.length):""}constructor(n,t={}){mt(this,"buf",""),mt(this,"sep",""),mt(this,"charpos",[]),mt(this,"middleCache",{}),mt(this,"endCache",{}),mt(this,"now",void 0),mt(this,"sequencial",void 0),mt(this,"delimiter",void 0),mt(this,"findMatches",(n=>{let t=0;const e=[];for(;t<n.length;){const i=n.slice(t),s=this.matchLongest(i);s.length?(t+=s.length,e.push([t,s[0][0],s[0][1]])):t++}return e})),this.sequencial=t.sequencial,this.delimiter=t.delimiter||"",this.buf=n,this.sep=t.sep||"\n",this.now=0,this.sequencial||this.buildcharpos()}}function kt(n,t){let e;return function(...i){clearTimeout(e),e=setTimeout(n.bind(this,...i),t)}}const bt=n=>{const t=n.indexOf("{"),e=n.indexOf("},`")+1;let i=n.substring(e+2,n.length-1);return"`"==i[i.length-1]&&(i=i.slice(0,i.length-1)),i.indexOf("\\\\")>-1&&(i=i.replace(/\\\\/g,"\\")),i.indexOf("\\`")>-1&&(i=i.replace(/\\`/g,"`")),i.indexOf("$\\{")>-1&&(i=i.replace(/\$\\\{/g,"${")),[JSON.parse(n.substring(t,e)),i]},yt={"Ⅰ":10,"ⅰ":10,"⒜":26,"Ⓐ":26,"ⓐ":26,"⓫":10,"㉑":15,"㍘":25,"㍙":24,"㈠":10,"㊀":10,"㋀":12,"㏠":31,"①":50,"⑴":20,"⒈":20,"⓵":10,"❶":10,"➀":10,"➊":10,"₁":9},xt=(n,t="①",e=1)=>{let i=yt[t];if("number"!=typeof n&&(n=parseInt(n)||0),i){if(n-e>=i)return n.toString();if("①"==t&&(n>35?(t="㊱",n-=35):n>20&&(t="㉑",n-=20),0==n))return"⓪";let s=t.charCodeAt(0)+n-e;return String.fromCharCode(s)}return n.toString()},wt=n=>{window.location.hash="#"+n},At=()=>{let n=window.location.hash;"#"==n[0]&&(n=n.slice(1));let t=decodeURI(n);return~t.indexOf("%")&&(t=decodeURIComponent(t)),~t.indexOf("bk")||~t.indexOf("ak")||(t=""),t},Ct="㑔㑯\n㑇㑳\n㐹㑶\n刾㓨\n㘎㘚\n㚯㜄\n㛣㜏\n㟆㠏\n㤘㥮\n㨫㩜\n㧐㩳\n擜㩵\n㻪㻽\n䀥䁻\n鿎䃮\n䌶䊷\n䌺䋙\n䌻䋚\n䌿䋹\n䌾䋻\n䎬䎱\n䙌䙡\n䜧䜀\n䞍䝼\n䦂䥇\n鿏䥑\n䥾䥱\n䦶䦛\n䦷䦟\n䯅䯀\n鲃䰾\n䲣䱷\n䲝䱽\n鳚䲁\n鳤䲘\n鹮䴉\n丢丟\n并<併並\n干<幹>乾\n乱亂\n亚亞\n伫佇\n来來\n仑侖\n侣侶\n俣俁\n系<繫係\n伣俔\n侠俠\n伡俥\n伥倀\n俩倆\n俫倈\n仓倉\n个個\n们們\n伦倫\n㑈倲\n伟偉\n㐽偑\n侧側\n侦偵\n伪僞偽\n㐷傌\n杰<傑\n伧傖\n伞傘\n备備\n佣<傭\n偬傯\n传傳\n伛傴\n债債\n伤傷\n倾傾\n偻僂\n仅僅\n佥僉\n侨僑\n仆<僕\n侥僥\n偾僨\n价<價\n仪儀\n㑺儁\n侬儂\n亿億\n侩儈\n俭儉\n傧儐\n俦儔\n侪儕\n尽盡儘\n偿償\n优<優\n储儲\n俪儷\n㑩儸\n傩儺\n傥儻\n俨儼\n兑兌\n儿<兒\n兖兗\n内內\n两兩\n册冊\n幂冪\n净凈\n冻凍\n凛凜\n凯凱\n别別\n删刪\n刭剄\n则則\n克<剋\n刹剎\n刬剗\n刚剛\n剥剝\n剐剮\n剀剴\n创創\n划<劃\n剧劇\n刘劉\n刽劊\n刿劌\n剑劍\n㓥劏\n剂劑\n㔉劚\n劲勁\n动動\n务務\n勋勛\n胜<勝\n劳勞\n势勢\n勚勩\n劢勱\n励勵\n劝勸\n匀勻\n匦匭\n汇彙匯\n匮匱\n区區\n协協\n却卻\n厍厙\n厌厭\n厉厲\n厣厴\n参參\n叁叄\n丛叢\n咤>吒\n吴吳\n呐吶\n吕呂\n呙咼\n员員\n呗唄\n吣唚\n问問\n哑啞\n启啟\n唡啢\n㖞喎\n唤喚\n丧喪\n乔喬\n单單\n哟喲\n呛嗆\n啬嗇\n唝嗊\n吗嗎\n呜嗚\n唢嗩\n哔嗶\n叹嘆\n喽嘍\n啯嘓\n呕嘔\n啧嘖\n尝嘗\n唛嘜\n哗嘩\n唠嘮\n啸嘯\n叽嘰\n哓嘵\n呒嘸\n啴嘽\n嘘噓\n㖊噚\n咝噝\n哒噠\n哝噥\n哕噦\n嗳噯\n哙噲\n喷噴\n吨<噸\n当當噹\n咛嚀\n吓嚇\n哜嚌\n噜嚕\n啮嚙\n呖嚦\n咙嚨\n亸嚲\n喾嚳\n严嚴\n嘤嚶\n啭囀\n嗫囁\n嚣囂\n冁囅\n呓囈\n啰囉\n嘱囑\n囱囪\n囵圇\n国國\n围圍\n园園\n圆圓\n图圖\n团團\n埯垵\n垭埡\n采<採埰\n执執\n坚堅\n垩堊\n垴堖\n埚堝\n尧堯\n报報\n场場\n块塊\n茔塋\n垲塏\n埘塒\n涂<塗\n坞塢\n埙塤\n尘塵\n堑塹\n垫墊\n坠墜\n堕墮\n坟墳\n垯墶\n垦墾\n坛罈壇\n垱壋\n压壓\n垒壘\n圹壙\n垆壚\n坏<壞\n垄壟\n垅壠\n坜壢\n坝壩\n塆壪\n壮壯\n壶壺\n壸壼\n寿壽\n够夠\n梦夢\n夹夾\n奂奐\n奥奧\n奁奩\n夺奪\n奨奬\n奋奮\n姹奼\n妆妝\n姗姍\n奸<姦\n娱娛\n娄婁\n妇婦\n娅婭\n娲媧\n妫媯\n㛀媰\n媪媼\n妈媽\n妪嫗\n妩嫵\n娴嫻\n婳嫿\n媭嬃\n娆嬈\n婵嬋\n娇嬌\n嫱嬙\n嫒嬡\n嬷嬤\n嫔嬪\n婴嬰\n婶嬸\n㛤孋\n娈孌\n孙孫\n学學\n孪孿\n宫宮\n寝寢\n实實\n宁<寧\n审審\n写寫\n宽寬\n㝦寯\n宠寵\n宝寶\n将將\n专專\n寻尋\n对對\n导導\n尴尷\n届屆\n尸<屍\n屃屓\n屉屜\n屡屢\n层層\n屦屨\n属屬\n冈岡\n岘峴\n岛島\n峡峽\n崃崍\n岗崗\n峥崢\n岽崬\n岚嵐\n㟥嵾\n嵝嶁\n崭嶄\n岖嶇\n嵚嶔\n崂嶗\n峤嶠\n峣嶢\n峄嶧\n崄嶮\n岙嶴\n嵘嶸\n岭<嶺\n屿嶼\n岿巋\n峦巒\n巅巔\n巯巰\n帅帥\n师師\n帐帳\n带帶\n帧幀\n帏幃\n㡎幓\n帼幗\n帻幘\n帜幟\n币幣\n帮幫\n帱幬\n么<麼>幺>麽\n几<幾\n库庫\n厕廁\n厢廂\n厩廄\n厦廈\n厨廚\n厮廝\n庙廟\n厂<廠\n庑廡\n废廢\n广廣\n廪廩\n庐廬\n厅廳\n弑弒\n弪弳\n张張\n强強\n弹彈\n弥彌\n弯彎\n彝<彞\n彟彠\n彦彥\n彨彲\n后<>後\n径徑\n从從\n徕徠\n复<複復>覆\n征<>徵\n彻徹\n恒恆\n耻恥\n悦悅\n悮悞\n怅悵\n闷悶\n恶惡\n恼惱\n恽惲\n恻惻\n爱愛\n惬愜\n悫愨\n怆愴\n恺愷\n忾愾\n栗<慄\n态態\n愠慍\n惨慘\n惭慚\n恸慟\n惯慣\n怄慪\n怂慫\n虑慮\n悭慳\n庆慶\n㥪慺\n忧憂\n惫憊\n㤭憍\n怜<憐\n凭憑\n愦憒\n慭憖\n惮憚\n愤憤\n悯憫\n怃憮\n宪憲\n忆憶\n恳懇\n应應\n怿懌\n懔懍\n怼懟\n懑懣\n㤽懤\n㤖懧\n恹懨\n惩懲\n懒懶\n怀<懷\n悬懸\n忏<懺\n惧懼\n慑懾\n恋戀\n戆戇\n戋戔\n戗戧\n戬戩\n战戰\n戯戱\n戏戲\n户戶\n抛拋\n捝挩\n挟挾\n舍<捨\n扪捫\n扫掃\n抡掄\n㧏掆\n挜掗\n挣掙\n挂<掛\n拣揀\n扬揚\n换換\n挥揮\n损損\n摇搖\n捣搗\n揾搵\n抢搶\n掴摑\n掼摜\n搂摟\n挚摯\n抠摳\n抟摶\n掺摻\n捞撈\n挦撏\n撑撐\n挠撓\n㧑撝\n挢撟\n掸撣\n拨撥\n抚撫\n扑<撲\n揿撳\n挞撻\n挝撾\n捡撿\n拥擁\n掳擄\n择擇\n击擊\n挡擋\n㧟擓\n担擔\n据<據\n挤擠\n㧛擥\n拟擬\n摈擯\n拧擰\n搁擱\n掷擲\n扩擴\n撷擷\n摆擺\n擞擻\n撸擼\n㧰擽\n扰<擾\n摅攄\n撵攆\n拢攏\n拦攔\n撄攖\n搀攙\n撺攛\n携攜\n摄攝\n攒攢\n挛攣\n摊攤\n搅攪\n揽攬\n败敗\n叙敘\n敌敵\n数數\n敛斂\n毙斃\n敩斆\n斓斕\n斩斬\n断斷\n于<>於\n时時\n晋晉\n昼晝\n晕暈\n晖暉\n旸暘\n畅暢\n暂暫\n晔曄\n历歷曆\n昙曇\n晓曉\n向<曏\n暧曖\n旷曠\n昽曨\n晒<曬\n书書\n会會\n胧朧\n东東\n栅柵\n杆<桿\n栀梔\n枧梘\n条條\n枭梟\n棁梲\n弃棄\n枨棖\n枣棗\n栋棟\n㭎棡\n栈棧\n栖<棲\n梾棶\n桠椏\n㭏椲\n杨楊\n枫楓\n桢楨\n业業\n极<極\n杩榪\n荣榮\n榅榲\n桤榿\n构<構\n枪槍\n梿槤\n椠槧\n椁槨\n椮槮\n桨槳\n椢槶\n椝槼\n桩樁\n乐樂\n枞樅\n楼樓\n标標\n枢樞\n㭤樢\n样樣\n㭴樫\n桪樳\n朴<樸\n树樹\n桦樺\n椫樿\n桡橈\n桥橋\n机<機\n椭橢\n横橫\n檩檁\n柽檉\n档檔\n桧檜\n槚檟\n检檢\n樯檣\n梼檮\n台<颱臺檯\n槟檳\n柠檸\n槛檻\n柜<櫃\n橹櫓\n榈櫚\n栉櫛\n椟櫝\n橼櫞\n栎櫟\n橱櫥\n槠櫧\n栌櫨\n枥櫪\n橥櫫\n榇櫬\n蘖櫱\n栊櫳\n榉櫸\n樱櫻\n栏欄\n权權\n椤欏\n栾欒\n榄欖\n棂欞\n钦欽\n欧歐\n欤歟\n欢歡\n岁歲\n归歸\n殁歿\n残殘\n殒殞\n殇殤\n㱮殨\n殚殫\n殓殮\n殡殯\n㱩殰\n歼殲\n杀殺\n壳殼\n毁毀\n殴毆\n毵毿\n牦氂\n毡氈\n氇氌\n气<氣\n氢氫\n氩氬\n氲氳\n决決\n没沒\n冲衝沖\n况況\n汹洶\n浃浹\n泾涇\n凉涼\n泪淚\n渌淥\n沦淪\n渊淵\n涞淶\n浅淺\n涣渙\n减減\n沨渢\n涡渦\n测測\n浑渾\n凑湊\n浈湞\n汤湯\n沩溈\n准<準\n沟溝\n温溫\n浉溮\n涢溳\n沧滄\n灭滅\n涤滌\n荥滎\n沪滬\n滞滯\n渗滲\n浒滸\n浐滻\n滚滾\n满滿\n渔漁\n溇漊\n沤漚\n汉漢\n涟漣\n渍漬\n涨漲\n溆漵\n渐漸\n浆漿\n颍潁\n泼潑\n洁<潔\n㴋潚\n潜潛\n润潤\n浔潯\n溃潰\n滗潷\n涠潿\n涩澀\n浇澆\n涝澇\n涧澗\n渑澠\n泽澤\n滪澦\n泶澩\n浍澮\n淀<澱\n㳠澾\n浊濁\n浓濃\n㳡濄\n湿濕\n泞<濘\n溁濚\n浕濜\n济濟\n涛濤\n㳔濧\n滥濫\n潍濰\n滨濱\n溅濺\n泺濼\n滤濾\n澛瀂\n滢瀅\n渎瀆\n㲿瀇\n泻瀉\n沈<瀋\n浏瀏\n濒瀕\n泸瀘\n沥瀝\n潇瀟\n潆瀠\n潴瀦\n泷瀧\n濑瀨\n㳽瀰\n潋瀲\n澜瀾\n沣灃\n滠灄\n洒<灑\n漓<灕\n滩灘\n灏灝\n漤灠\n㳕灡\n湾灣\n滦灤\n滟灧\n灾災\n为為\n乌烏\n烃烴\n无無\n炼煉\n炜煒\n烟煙\n茕煢\n焕煥\n烦煩\n炀煬\n㶽煱\n煴熅\n荧熒\n炝熗\n热熱\n颎熲\n炽熾\n烨燁\n灯燈\n烧燒\n烫燙\n焖燜\n营營\n灿燦\n烛燭\n烩燴\n㶶燶\n烬燼\n焘燾\n烁爍\n炉爐\n烂爛\n争爭\n爷爺\n尔爾\n墙牆\n牍牘\n牵牽\n荦犖\n犊犢\n牺犧\n状狀\n狭狹\n狈狽\n狰猙\n犹猶\n狲猻\n犸獁\n狱獄\n狮獅\n奖獎\n独獨\n狯獪\n猃獫\n狝獮\n狞獰\n㺍獱\n获穫獲\n猎獵\n犷獷\n兽獸\n獭獺\n献獻\n猕獼\n猡玀\n现現\n珐琺\n珲琿\n玮瑋\n玚瑒\n琐瑣\n瑶瑤\n莹瑩\n玛瑪\n玱瑲\n琏璉\n琎璡\n玑璣\n瑷璦\n珰璫\n㻅璯\n环環\n玙璵\n瑸璸\n玺璽\n琼瓊\n珑瓏\n璎瓔\n瓒瓚\n瓯甌\n产產\n亩畝\n毕畢\n画畫\n异<異\n畴疇\n叠疊\n痉痙\n疴痾\n痖瘂\n疯瘋\n疡瘍\n痪瘓\n瘗瘞\n疮瘡\n疟瘧\n瘆瘮\n疭瘲\n瘘瘺\n疗療\n痨癆\n痫癇\n瘅癉\n疠癘\n瘪癟\n痒<癢\n疖癤\n症<癥\n疬癧\n癞癩\n癣癬\n瘿癭\n瘾癮\n痈癰\n瘫癱\n癫癲\n发髮發\n皑皚\n疱皰\n皲皸\n皱皺\n盗盜\n盏盞\n监監\n盘盤\n卢盧\n荡蕩盪\n眦眥\n众眾\n困<睏\n睁睜\n睐睞\n眍瞘\n䁖瞜\n瞒瞞\n瞆瞶\n睑瞼\n眬矓\n瞩矚\n矫矯\n硁硜\n硖硤\n砗硨\n砚硯\n硕碩\n砀碭\n砜碸\n确<確\n码碼\n䂵碽\n硙磑\n砖磚\n硵磠\n碜磣\n碛磧\n矶磯\n硗磽\n䃅磾\n硚礄\n硷鹼礆\n础礎\n碍礙\n矿礦\n砺礪\n砾礫\n矾礬\n砻礱\n禄祿\n祸禍\n祯禎\n祎禕\n祃禡\n御<禦\n禅禪\n礼禮\n祢禰\n祷禱\n秃禿\n籼秈\n税稅\n秆稈\n䅉稏\n禀稟\n种<種\n称稱\n谷<穀\n䅟穇\n稣穌\n积積\n颖穎\n秾穠\n穑穡\n秽穢\n稳穩\n稆穭\n窝窩\n洼<窪\n穷窮\n窑窯\n窎窵\n窭窶\n窥窺\n窜竄\n窍竅\n窦竇\n窃竊\n竞競\n笔筆\n笋筍\n笕筧\n䇲筴\n笺箋\n筝箏\n节節\n范<範\n筑<築\n箧篋\n筼篔\n笃篤\n筛篩\n筚篳\n箦簀\n篓簍\n箪簞\n简簡\n篑簣\n箫簫\n筜簹\n签簽\n帘<簾\n篮籃\n筹籌\n䉤籔\n箓籙\n篯籛\n箨籜\n籁籟\n笼籠\n笾籩\n簖籪\n篱<籬\n箩籮\n粤粵\n糁糝\n粪糞\n粮糧\n粝糲\n籴糴\n粜糶\n纟糹\n纠糾\n纪紀\n纣紂\n约約\n红紅\n纡紆\n纥紇\n纨紈\n纫紉\n纹紋\n纳納\n纽紐\n纾紓\n纯純\n纰紕\n纼紖\n纱紗\n纮紘\n纸紙\n级級\n纷紛\n纭紜\n纴紝\n纺紡\n䌷紬\n细細\n绂紱\n绁紲\n绅紳\n纻紵\n绍紹\n绀紺\n绋紼\n绐紿\n绌絀\n终終\n组組\n䌹絅\n绊絆\n绗絎\n结結\n绝絕\n绦縧絛\n绔絝\n绞絞\n络絡\n绚絢\n给給\n绒絨\n绖絰\n统統\n丝絲\n绛絳\n绢絹\n绑綁\n绡綃\n绠綆\n绨綈\n绤綌\n绥綏\n䌼綐\n经經\n综綜\n缍綞\n绿綠\n绸綢\n绻綣\n绶綬\n维維\n绹綯\n绾綰\n纲綱\n网<網\n缀綴\n䌽綵\n纶綸\n绺綹\n绮綺\n绽綻\n绰綽\n绫綾\n绵綿\n绲緄\n缁緇\n紧緊\n绯緋\n绪緒\n绬緓\n绱鞝緔\n缃緗\n缄緘\n缂緙\n线線\n缉緝\n缎緞\n缔締\n缗緡\n缘緣\n缌緦\n编編\n缓緩\n缅緬\n纬緯\n缑緱\n缈緲\n练練\n缏緶\n缇緹\n致<緻\n萦縈\n缙縉\n缢縊\n缒縋\n绉縐\n缣縑\n缊縕\n缞縗\n缚縛\n缜縝\n缟縞\n缛縟\n县縣\n缝縫\n缡縭\n缩縮\n纵縱\n缧縲\n䌸縳\n缦縵\n絷縶\n缕縷\n缥縹\n总總\n绩績\n绷繃\n缫繅\n缪繆\n缯繒\n织織\n缮繕\n缭繚\n绕繞\n绣繡\n缋繢\n绳繩\n绘繪\n茧<繭\n缰韁繮\n缳繯\n缲繰\n缴繳\n䍁繸\n绎繹\n继繼\n缤繽\n缱繾\n䍀繿\n颣纇\n缬纈\n纩纊\n续續\n累<纍\n缠纏\n缨纓\n纤纖\n缵纘\n缆纜\n钵缽\n罂罌\n罚罰\n骂罵\n罢罷\n罗羅\n罴羆\n羁羈\n芈羋\n羟羥\n义義\n习習\n翚翬\n翘翹\n翙翽\n耧耬\n耢耮\n圣<聖\n闻聞\n联聯\n聪聰\n声聲\n耸聳\n聩聵\n聂聶\n职職\n聍聹\n听<聽\n聋聾\n肃肅\n胁脅\n脉脈\n胫脛\n脱脫\n胀脹\n肾腎\n胨腖\n脶腡\n脑腦\n肿腫\n脚腳\n肠腸\n腽膃\n腘膕\n肤膚\n䏝膞\n胶膠\n腻膩\n胆膽\n脍膾\n脓膿\n䐪臇\n脸臉\n脐臍\n膑臏\n腊<臘\n胪臚\n脏髒臟\n脔臠\n臜臢\n临臨\n与<與\n兴興\n举舉\n旧舊\n舱艙\n舣艤\n舰艦\n舻艫\n艰艱\n艳艷\n刍芻\n苎苧\n兹茲\n荆荊\n庄<莊\n茎莖\n荚莢\n苋莧\n华華\n苌萇\n莱萊\n万<萬\n荝萴\n莴萵\n叶葉\n荭葒\n着>著\n荮葤\n苇葦\n荤葷\n莳蒔\n莅蒞\n苍蒼\n荪蓀\n盖蓋\n莲蓮\n苁蓯\n莼蓴\n荜蓽\n蒌蔞\n蒋蔣\n葱蔥\n茑蔦\n荫蔭\n荨蕁\n蒇蕆\n荞蕎\n荬蕒\n芸<蕓\n莸蕕\n荛蕘\n蒉蕢\n芜蕪\n萧蕭\n蓣蕷\n蕰薀\n荟薈\n蓟薊\n芗薌\n蔷薔\n荙薘\n莶薟\n荐<薦\n萨薩\n䓕薳\n苧<薴\n䓓薵\n荠薺\n蓝藍\n荩藎\n艺藝\n药藥\n薮藪\n苈藶\n蔼藹\n蔺藺\n萚蘀\n蕲蘄\n芦蘆\n苏蘇\n蕴蘊\n苹<蘋\n藓蘚\n蔹蘞\n茏蘢\n兰蘭\n蓠蘺\n萝蘿\n蔂<虆\n处處\n虚虛\n虏虜\n号號\n亏虧\n虬虯\n蛱蛺\n蜕蛻\n蚬蜆\n蚀蝕\n猬蝟\n虾蝦\n蜗蝸\n蛳螄\n蚂螞\n萤螢\n䗖螮\n蝼螻\n螀螿\n蛰蟄\n蝈蟈\n螨蟎\n虮<蟣\n蝉蟬\n蛲蟯\n虫<蟲\n蛏蟶\n蚁蟻\n蚃蠁\n蝇蠅\n虿蠆\n蛴蠐\n蝾蠑\n蜡<蠟\n蛎蠣\n蟏蠨\n蛊蠱\n蚕<蠶\n蛮蠻\n术術\n同<衕\n胡<鬍衚\n卫衛\n衮袞\n袅裊\n补補\n装裝\n里<裡\n制<製\n裈褌\n袆褘\n裤褲\n裢褳\n褛褸\n亵褻\n裥襇\n褝襌\n袯襏\n袄襖\n裣襝\n裆襠\n褴襤\n袜襪\n䙓襬\n衬襯\n袭襲\n襕襴\n见見\n觃覎\n规規\n觅覓\n视視\n觇覘\n觋覡\n觍覥\n觎覦\n亲親\n觊覬\n觏覯\n觐覲\n觑覷\n觉覺\n览覽\n觌覿\n观觀\n觞觴\n觯觶\n触<觸\n讠訁\n订訂\n讣訃\n计計\n讯訊\n讧訌\n讨討\n讦訐\n讱訒\n训訓\n讪訕\n讫訖\n讬託\n记記\n讹訛\n讶訝\n讼訟\n䜣訢\n诀訣\n讷訥\n讻訩\n访訪\n设設\n许許\n诉訴\n诃訶\n诊診\n注<註\n诂詁\n诋詆\n讵詎\n诈詐\n诒詒\n诏詔\n评評\n诐詖\n诇詗\n诎詘\n诅詛\n词詞\n咏詠\n诩詡\n询詢\n诣詣\n试試\n诗詩\n诧詫\n诟詬\n诡詭\n诠詮\n诘詰\n话話\n该該\n详詳\n诜詵\n诙詼\n诖詿\n诔誄\n诛誅\n诓誆\n夸<誇\n志<誌\n认認\n诳誑\n诶誒\n诞誕\n诱誘\n诮誚\n语語\n诚誠\n诫誡\n诬誣\n误誤\n诰誥\n诵誦\n诲誨\n说說\n谁誰\n课課\n谇誶\n诽誹\n谊誼\n訚誾\n调調\n谄諂\n谆諄\n谈談\n诿諉\n请請\n诤諍\n诹諏\n诼諑\n谅諒\n论論\n谂諗\n谀諛\n谍諜\n谞諝\n谝諞\n诨諢\n谔諤\n谛諦\n谐諧\n谏諫\n谕諭\n谘諮\n讳諱\n谙諳\n谌諶\n讽諷\n诸諸\n谚諺\n谖諼\n诺諾\n谋謀\n谒謁\n谓謂\n誊謄\n诌謅\n谎謊\n谜謎\n谧謐\n谑謔\n谡謖\n谤謗\n谦謙\n谥謚\n讲講\n谢謝\n谣謠\n谟謨\n谪謫\n谬謬\n谫譾謭\n讴謳\n谨謹\n谩謾\n证證\n谲譎\n讥譏\n谮譖\n识識\n谯譙\n谭譚\n谱譜\n谵譫\n译譯\n议議\n谴譴\n护護\n诪譸\n䛓譼\n誉譽\n读讀\n谉讅\n变變\n詟讋\n䜩讌\n雠讎\n谗讒\n让讓\n谰讕\n谶讖\n谠讜\n谳讞\n岂豈\n竖豎\n丰<豐\n猪豬\n豮豶\n猫貓\n䝙貙\n贝貝\n贞貞\n贠貟\n负負\n财財\n贡貢\n贫貧\n货貨\n贩販\n贪貪\n贯貫\n责責\n贮貯\n贳貰\n赀貲\n贰貳\n贵貴\n贬貶\n买買\n贷貸\n贶貺\n费費\n贴貼\n贻貽\n贸貿\n贺賀\n贲賁\n赂賂\n赁賃\n贿賄\n赅賅\n资資\n贾賈\n贼賊\n赈賑\n赊賒\n宾賓\n赇賕\n赒賙\n赉賚\n赐賜\n赏賞\n赔賠\n赓賡\n贤賢\n卖賣\n贱賤\n赋賦\n赕賧\n质質\n账賬\n赌賭\n䞐賰\n赖賴\n赗賵\n赚賺\n赙賻\n购購\n赛賽\n赜賾\n贽贄\n赘贅\n赟贇\n赠贈\n赞贊\n赝贗贋\n赡贍\n赢贏\n赆贐\n赃贓\n赑贔\n赎贖\n赣贛\n赪赬\n赶<趕\n赵趙\n趋趨\n趱趲\n迹跡\n践踐\n踊<踴\n跄蹌\n跸蹕\n蹒蹣\n踪蹤\n跷蹺\n跶躂\n趸躉\n踌躊\n跻躋\n跃躍\n䟢躎\n踯躑\n跞躒\n踬躓\n蹰躕\n跹躚\n蹑躡\n蹿躥\n躜躦\n躏躪\n躯軀\n车車\n轧軋\n轨軌\n军軍\n轪軑\n轩軒\n轫軔\n轭軛\n软軟\n轷軤\n轸軫\n轱軲\n轴軸\n轵軹\n轺軺\n轲軻\n轶軼\n轼軾\n较較\n辂輅\n辁輇\n辀輈\n载載\n轾輊\n辄輒\n挽<輓\n辅輔\n轻輕\n辆輛\n辎輜\n辉輝\n辋輞\n辍輟\n辊輥\n辇輦\n辈輩\n轮輪\n辌輬\n辑輯\n辏輳\n输輸\n辐輻\n辗輾\n舆輿\n辒轀\n毂轂\n辖轄\n辕轅\n辘轆\n转轉\n辙轍\n轿轎\n辚轔\n轰轟\n辔轡\n轹轢\n轳轤\n办辦\n辞辭\n辫辮\n辩辯\n农農\n迳逕\n这這\n连連\n进進\n运運\n过過\n达達\n违違\n遥遙\n逊遜\n递遞\n远遠\n适<適\n迟遲\n迁遷\n选選\n遗遺\n辽遼\n迈邁\n还還\n迩邇\n边邊\n逻邏\n逦邐\n郏郟\n邮郵\n郓鄆\n乡鄉\n邹鄒\n邬鄔\n郧鄖\n邓鄧\n郑鄭\n邻鄰\n郸鄲\n邺鄴\n郐鄶\n邝鄺\n酂酇\n郦酈\n丑<醜\n酝醞\n医醫\n酱醬\n酦醱\n酿釀\n衅釁\n酾釃\n酽釅\n释釋\n厘<釐\n钅釒\n钆釓\n钇釔\n钌釕\n钊釗\n钉釘\n钋釙\n针針\n钓釣\n钐釤\n钏釧\n钒釩\n钗釵\n钍釷\n钕釹\n钎釺\n䥺釾\n钯鈀\n钫鈁\n钘鈃\n钭鈄\n钚鈈\n钠鈉\n钝鈍\n钩鉤鈎\n钤鈐\n钣鈑\n钑鈒\n钞鈔\n钮鈕\n钧鈞\n钙鈣\n钬鈥\n钛鈦\n钪鈧\n铌鈮\n铈鈰\n钶鈳\n铃鈴\n钴鈷\n钹鈸\n铍鈹\n钰鈺\n钸鈽\n铀鈾\n钿鈿\n钾鉀\n钜鉅\n铊鉈\n铉鉉\n铇鉋\n铋鉍\n铂鉑\n钷鉕\n钳鉗\n铆鉚\n铅鉛\n钺鉞\n钲鉦\n鿭鑈鉨\n钼鉬\n钽鉭\n铏鉶\n铰鉸\n铒鉺\n铬鉻\n铪鉿\n银銀\n铳銃\n铜銅\n铚銍\n铣銑\n铨銓\n铢銖\n铭銘\n铫銚\n铦銛\n衔銜\n铑銠\n铷銣\n铱銥\n铟銦\n铵銨\n铥銩\n铕銪\n铯銫\n铐銬\n铞銱\n锐銳\n销銷\n锈鏽銹\n锑銻\n锉銼\n铝鋁\n锒鋃\n锌鋅\n钡鋇\n铤鋌\n铗鋏\n锋鋒\n铻鋙\n锊鋝\n锓鋟\n铘鋣\n锄鋤\n锃鋥\n锔鋦\n锇鋨\n铓鋩\n铺鋪\n铖鋮\n锆鋯\n锂鋰\n铽鋱\n锍鋶\n锯鋸\n钢鋼\n锞錁\n录錄\n锖錆\n锫錇\n锩錈\n铔錏\n锥錐\n锕錒\n锟錕\n锤錘\n锱錙\n铮錚\n锛錛\n锬錟\n锭錠\n锜錡\n钱錢\n锦錦\n锚錨\n锠錩\n锡錫\n锢錮\n错錯\n锰錳\n表<錶\n铼錸\n锝鍀\n锨鍁\n锪鍃\n钔鍆\n锴鍇\n锳鍈\n锅鍋\n镀鍍\n锷鍔\n铡鍘\n钖鍚\n锻鍛\n锽鍠\n锸鍤\n锲鍥\n锘鍩\n锹鍬\n锾鍰\n键鍵\n锶鍶\n锗鍺\n钟鐘鍾\n镁鎂\n锿鎄\n镅鎇\n镑鎊\n镕鎔\n锁鎖\n镉鎘\n镈鎛\n镃鎡\n钨鎢\n蓥鎣\n镏鎦\n铠鎧\n铩鎩\n锼鎪\n镐鎬\n镇鎮\n镒鎰\n镋鎲\n镍鎳\n镓鎵\n鿔鎶\n镎鎿\n镞鏃\n镟鏇\n链鏈\n镆鏌\n镙鏍\n镠鏐\n镝鏑\n铿鏗\n锵鏘\n镗鏜\n镘鏝\n镛鏞\n铲鏟\n镜鏡\n镖鏢\n镂鏤\n錾鏨\n镚鏰\n铧鏵\n镤鏷\n镪鏹\n䥽鏺\n铙鐃\n铴鐋\n镣鐐\n铹鐒\n镦鐓\n镡鐔\n镫鐙\n镢鐝\n镨鐠\n䦅鐥\n锎鐦\n锏鐧\n镄鐨\n镌鐫\n镰鐮\n䦃鐯\n镯鐲\n镭鐳\n铁鐵\n镮鐶\n铎鐸\n铛鐺\n镱鐿\n铸鑄\n镬鑊\n镔鑌\n鉴鑒\n镲鑔\n锧鑕\n镴鑞\n铄鑠\n镳鑣\n镥鑥\n镧鑭\n钥鑰\n镵鑱\n镶鑲\n镊鑷\n镩鑹\n锣鑼\n钻鑽\n銮鑾\n凿鑿\n䦆钁\n长長\n门門\n闩閂\n闪閃\n闫閆\n闬閈\n闭閉\n开開\n闶閌\n闳閎\n闰閏\n闲閒閑\n间間\n闵閔\n闸閘\n阂閡\n阁閣\n阀閥\n闺閨\n闽閩\n阃閫\n阆閬\n闾閭\n阅閱\n阊閶\n阉閹\n阎閻\n阏閼\n阍閽\n阈閾\n阌閿\n阒闃\n板<闆\n闱闈\n阔闊\n阕闋\n阑闌\n阇闍\n阗闐\n阘闒\n闿闓\n阖闔\n阙闕\n闯闖\n关關\n阚闞\n阓闠\n阐闡\n辟<闢\n阛闤\n闼闥\n坂>阪\n陉陘\n陕陝\n阵陣\n阴陰\n陈陳\n陆陸\n阳陽\n陧隉\n队隊\n阶階\n陨隕\n际際\n随隨\n险險\n陦隯\n隐隱\n陇隴\n隶隸\n只<隻\n隽雋\n虽雖\n双雙\n雏雛\n杂雜\n鸡雞\n离<離\n难難\n云<雲\n电電\n霡霢\n雾霧\n霁霽\n雳靂\n霭靄\n叇靆\n灵靈\n叆靉\n靓靚\n静靜\n䩄靦\n靥靨\n鼗鞀\n巩鞏\n鞒鞽\n鞑韃\n鞯韉\n韦韋\n韧韌\n韨韍\n韩韓\n韪韙\n韬韜\n韫韞\n韵韻\n响響\n页頁\n顶頂\n顷頃\n项項\n顺順\n顸頇\n须鬚須\n顼頊\n颂頌\n颀頎\n颃頏\n预預\n顽頑\n颁頒\n顿頓\n颇頗\n领領\n颌頜\n颉頡\n颐頤\n颏頦\n头頭\n颒頮\n颊頰\n颋頲\n颕頴\n颔頷\n颈頸\n颓頹\n频頻\n颗顆\n题題\n额額\n颚顎\n颜顏\n颙顒\n颛顓\n愿<願\n颡顙\n颠顛\n类類\n颟顢\n颢顥\n顾顧\n颤顫\n颥顬\n显顯\n颦顰\n颅顱\n颞顳\n颧顴\n风風\n飐颭\n飑颮\n飒颯\n刮<颳\n飓颶\n飔颸\n飏颺\n飖颻\n飕颼\n飗飀\n飘飄\n飙飆\n飚飈\n飞飛\n饣飠\n饥飢\n饤飣\n饦飥\n饨飩\n饪飪\n饫飫\n饬飭\n饭飯\n饮飲\n饴飴\n饲飼\n饱飽\n饰飾\n饳飿\n饺餃\n饸餄\n饼餅\n饷餉\n养養\n饵餌\n饹餎\n饻餏\n饽餑\n馁餒\n饿餓\n馂餕\n饾餖\n余<餘\n肴<餚\n馄餛\n馃餜\n饯餞\n馅餡\n馆館\n糇餱\n饧餳\n馉餶\n馇餷\n馎餺\n饩餼\n馏餾\n馊餿\n馌饁\n馍饃\n馒饅\n馐饈\n馑饉\n馓饊\n馈饋\n馔饌\n饶饒\n飨饗\n餍饜\n馋饞\n馕饢\n马馬\n驭馭\n冯馮\n驮馱\n驰馳\n驯馴\n驲馹\n驳駁\n驻駐\n驽駑\n驹駒\n驵駔\n驾駕\n骀駘\n驸駙\n驶駛\n驼駝\n驷駟\n骈駢\n骇駭\n骃駰\n骆駱\n骎駸\n骏駿\n骋騁\n骍騂\n骓騅\n骔騌\n骒騍\n骑騎\n骐騏\n骛騖\n骗騙\n骙騤\n䯄騧\n骞騫\n骘騭\n骝騮\n腾騰\n驺騶\n骚騷\n骟騸\n骡騾\n蓦驀\n骜驁\n骖驂\n骠驃\n骢驄\n驱驅\n骅驊\n骕驌\n骁驍\n骣驏\n骄驕\n验驗\n惊<驚\n驿驛\n骤驟\n驴驢\n骧驤\n骥驥\n骦驦\n骊驪\n骉驫\n肮<骯\n髅髏\n体<體\n髌髕\n髋髖\n松<鬆\n鬓鬢\n斗<鬥\n闹鬧\n阋鬩\n阄鬮\n郁<鬱\n鬶鬹\n魉魎\n魇魘\n鱼魚\n鱽魛\n鱾魢\n鲀魨\n鲁魯\n鲂魴\n鱿魷\n鲄魺\n鲅鮁\n鲆鮃\n鲌鮊\n鲉鮋\n鲏鮍\n鲇鮎\n鲐鮐\n鲍鮑\n鲋鮒\n鲊鮓\n鲒鮚\n鲘鮜\n鲕鮞\n䲟鮣\n鲖鮦\n鲔鮪\n鲛鮫\n鲑鮭\n鲜鮮\n鲓鮳\n鲪鮶\n鲝鮺\n鲧鯀\n鲠鯁\n鲩鯇\n鲤鯉\n鲨鯊\n鲬鯒\n鲻鯔\n鲯鯕\n鲭鯖\n鲞鯗\n鲷鯛\n鲴鯝\n鲱鯡\n鲵鯢\n鲲鯤\n鲳鯧\n鲸鯨\n鲮鯪\n鲰鯫\n鲶鯰\n鲺鯴\n鳀鯷\n鲫鯽\n鳊鯿\n鳈鰁\n鲗鰂\n鳂鰃\n䲠鰆\n鲽鰈\n鳇鰉\n䲡鰌\n鳅鰍\n鲾鰏\n鳄鱷鰐\n鳆鰒\n鳃鰓\n鳒鰜\n鳑鰟\n鳋鰠\n鲥鰣\n鳏鰥\n䲢鰧\n鳎鰨\n鳐鰩\n鳍鰭\n鳁鰮\n鲢鰱\n鳌鰲\n鳓鰳\n鳘鰵\n鲦鰷\n鲣鰹\n鲹鰺\n鳗鰻\n鳛鰼\n鳔鰾\n鳉鱂\n鳙鱅\n鳕鱈\n鳖鱉\n鳟鱒\n鳝鱔\n鳜鱖\n鳞鱗\n鲟鱘\n鲼鱝\n鲎鱟\n鲙鱠\n鳣鱣\n鳡鱤\n鳢鱧\n鲿鱨\n鲚鱭\n鳠鱯\n鲈鱸\n鲡鱺\n鸟鳥\n凫鳧\n鸠鳩\n鸤鳲\n凤鳳\n鸣鳴\n鸢鳶\n䴓鳾\n鸩鴆\n鸨鴇\n鸦鴉\n鸰鴒\n鸵鴕\n鸳鴛\n鸲鴝\n鸮鴞\n鸱鴟\n鸪鴣\n鸯鴦\n鸭鴨\n鸸鴯\n鸹鴰\n鸻鴴\n䴕鴷\n鸿鴻\n鸽鴿\n䴔鵁\n鸺鵂\n鸼鵃\n鹀鵐\n鹃鵑\n鹆鵒\n鹁鵓\n鹈鵜\n鹅鵝\n鹄鵠\n鹉鵡\n鹌鵪\n鹏鵬\n鹐鵮\n鹎鵯\n鹊鵲\n鹓鵷\n鹍鵾\n䴖鶄\n鸫鶇\n鹑鶉\n鹒鶊\n鹋鶓\n鹙鶖\n鹕鶘\n鹗鶚\n鹖鶡\n鹛鶥\n鹜鶩\n䴗鶪\n鸧鶬\n莺鶯\n鹟鶲\n鹤鶴\n鹠鶹\n鹡鶺\n鹘鶻\n鹣鶼\n鹚鷀\n鹢鷁\n鹞鷂\n䴘鷉鷈\n鹝鷊\n鹧鷓\n鹥鷖\n鸥鷗\n鸷鷙\n鹨鷚\n鸶鷥\n鹪鷦\n鹔鷫\n鹩鷯\n鹫鷲\n鹇鷳\n鹬鷸\n鹰鷹\n鹭鷺\n鸴鷽\n䴙鸊鷿\n㶉鸂\n鹯鸇\n鹱鸌\n鹲鸏\n鸬鸕\n鹴鸘\n鹦鸚\n鹳鸛\n鹂鸝\n鸾鸞\n卤鹵\n咸<鹹\n鹾鹺\n盐鹽\n丽麗\n麦麥\n麸麩\n曲<麯\n麹>麴\n面<麵\n黄黃\n黉黌\n点點\n党<黨\n黪黲\n黡黶\n黩黷\n黾黽\n鼋黿\n鼍鼉\n鼹鼴\n齐齊\n斋齋\n赍齎\n齑齏\n齿齒\n龀齔\n龁齕\n龂齗\n龅齙\n龇齜\n龃齟\n龆齠\n龄齡\n出<齣\n龈齦\n龊齪\n龉齬\n龋齲\n腭齶\n龌齷\n龙龍\n厐龎\n庞龐\n䶮龑\n龚龔\n龛龕\n龟龜\n䜤鿁\n䲤鿐\n鿓鿒".split(/\r?\n/);Ct.push("“「"),Ct.push("‘『"),Ct.push("”」"),Ct.push("’』");const Ot={"获":"獲穫","缰":"繮韁","赝":"贋贗","伪":"僞偽","汇":"匯彙","坛":"壇罈","台":"臺颱檯","冲":"沖衝","硷":"礆鹼","绱":"緔鞝","脏":"臟髒","谫":"謭譾","钩":"鈎鉤","鿭":"鉨鑈","锈":"銹鏽","闲":"閑閒","须":"須鬚","鳄":"鰐鱷"},Pt={},It={},Tt={};Ct.forEach(((n,t)=>{const e=n.match(/(.)(<?)(.+)/u);if(!e)throw"wrong data format "+t;let[i,s,o,r]=e,l=r;if(Ot[s]&&(r=Ot[s]),""==o)if(1==r.length)Pt[r]=s;else if(">"==r[0])It[r.substring(1)]=s;else{Pt[r[0]]=s,r=r.substring(1);for(let n=0;n<r.length;n++){const t=r.codePointAt(n);if(!t)break;It[String.fromCodePoint(t)]=s}}else if(1==r.length)It[r]=s;else for(;r&&">"!==r[0];){const n=String.fromCodePoint(r.codePointAt(0));It[n]=s,r=r.substring(n.length)}r=l.replace(/\>/g,""),Tt[s]="<"==o?r.replace(s,"")+s:r}));const _t=(n,t=1)=>{if(!n)return n;let e="",i=0;if(!t)return n;for(;i<n.length;){const s=n.codePointAt(i),o=String.fromCodePoint(s);if(!o)break;let r=Pt[o];2!=t||r||(r=It[o]),e+=r||o,i++,s>65535&&i++}return e},St=(n,t=1,e="()")=>{let i="",s=0;if(!t||!n)return n;for(;s<n.length&&n[s];){const o=n.codePointAt(s),r=String.fromCodePoint(o);if(!r)break;let l=Tt[r];l?1!=t||l.codePointAt(1)?2==t?i+=String.fromCodePoint(l.codePointAt(0)):3==t?l.codePointAt(1)?i+=e[0]+l+e[1]:i+=l:i+=r:i+=l:i+=r,s++,o>65535&&s++}return i};class Nt{nPostingOf(n){const t=[],e=Fn(n);for(let i=0;i<e.length;i++){const{type:s,text:o}=e[i];let r=-1;if(s==Mn.CJK_BMP){const n=o.charCodeAt(0);if(r=Qn(this.bmpwithposting,n),this.bmpwithposting[r]!==n){const n=St(o).charCodeAt(0);if(r=Qn(this.bmpwithposting,n),this.bmpwithposting[r]!==n)continue}}else if(s>=Mn.SEARCHABLE)if(~r)r+=this.bmppostingcount;else{let t=this.words.find(n);~t&&(r=t+this.bmppostingcount)}t.push(r)}return t}constructor(n,t){this.words=new vt(n.shift(),{sep:$t}),this.bmpwithposting=ut(n.shift()),this.tokenlinepos=ut(n.shift()),this.postings=[],this.postingStart=t,this.bmppostingcount=0;for(let n=1;n<65536;n++)this.bmpwithposting[n]&&this.bmppostingcount++}}const Et=(n,t,e=0)=>{let i=1,s=e;for(;s<n.length;){if(t>n[s])i++;else{if(i<=1)break;s-=i,i=1}s+=i}return s},zt=(n,t,e=1)=>{let i=0,s=0;if(!n||!t||0==n.length||0==t.length)return[];Math.min(n.length,t.length);let o=[];for(let r=0;r<n.length;r++){let l=n[r]+e,c=t[i];for(;l>c&&i<t.length;)c=t[++i];l===c&&(o[s++]=l-e)}return o.slice(0,s)},Lt=(n,t)=>{let e=0,i=0,s=0;const o=[];for(let r=0;r<t.length;r++){const[l,c]=t[r];for(i=e,l>n[e]&&(i=Et(n,l,e)),s=i;n[s]<c&&s<n.length;)s++;o[r]=s>i?s-i:0,e=s}for(let n=0;n<o.length;n++)"number"!=typeof o[n]&&(o[n]=0);return o},Mt=(n,t,e)=>{const i=Qn(n,t);let s=Qn(n,e)+1;const o=n.slice(i,s);for(;o[0]<t;)o.shift();for(;o[o.length-1]>e;)o.pop();return o},jt=(n,t)=>{if(!t||!t.length)return n;const e=[];let i=0,s=t[i];for(let o=0;o<n.length;o++){const r=n[o];for(r>=s[0]&&s[1]>=r&&e.push(r);r>s[0]&&i<t.length-1;)s=t[++i];if(i>=t.length)break}return e},Ft=(n,t,e=!1)=>{let i=0;const s=[],o=[];for(;i<n.length;){let r=n[i],l=Qn(t,r);l>=0&&l<t.length&&(s[s.length-1]!==l&&s.push(l),e&&(o[s.length-1]||(o[s.length-1]=[]),o[s.length-1].push(r-t[l-1])),r=n[i]),i++}return[s,o]};function Bt(n){const t=this,e=t.inverted.nPostingOf(n);for(let n=0;n<e.length;n++){const i=e[n];if(-1==i)continue;const s=t.inverted.postingStart+e[n];if(!t.inverted.postings[i]){const n=t.getLine(s);t.inverted.postings[i]=ut(n)}}return this.getPostings(n)}function qt(n){const t=this.inverted.nPostingOf(n),e=this.inverted.postings;return t.map((n=>e[n]))}async function Rt(n){const t=this;return await(async(n,t)=>{if(!n.inverted)return;const e=n.inverted.nPostingOf(t),i=[];for(let t=0;t<e.length;t++){if(e[t]<0)continue;const s=n.inverted.postingStart+e[t];i.push([s,s+1])}return i.sort(((n,t)=>n[0]-t[0])),await n.loadLines(i),i})(t,n),t.loadPostingsSync.call(t,n)}function Ht(){}function Ut(n,t,e,i,s){for(var o,r=[];t;)r.push(t),o=t.previousComponent,delete t.previousComponent,t=o;r.reverse();for(var l=0,c=r.length,a=0,u=0;l<c;l++){var d=r[l];if(d.removed)d.value=n.join(i.slice(u,u+d.count)),u+=d.count;else{if(!d.added&&s){var f=e.slice(a,a+d.count);f=f.map((function(n,t){var e=i[u+t];return e.length>n.length?e:n})),d.value=n.join(f)}else d.value=n.join(e.slice(a,a+d.count));a+=d.count,d.added||(u+=d.count)}}return r}function Wt(n,t){var e;for(e=0;e<n.length&&e<t.length;e++)if(n[e]!=t[e])return n.slice(0,e);return n.slice(0,e)}function Dt(n,t){var e;if(!n||!t||n[n.length-1]!=t[t.length-1])return"";for(e=0;e<n.length&&e<t.length;e++)if(n[n.length-(e+1)]!=t[t.length-(e+1)])return n.slice(-e);return n.slice(-e)}function Kt(n,t,e){if(n.slice(0,t.length)!=t)throw Error("string ".concat(JSON.stringify(n)," doesn't start with prefix ").concat(JSON.stringify(t),"; this is a bug"));return e+n.slice(t.length)}function Jt(n,t,e){if(!t)return n+e;if(n.slice(-t.length)!=t)throw Error("string ".concat(JSON.stringify(n)," doesn't end with suffix ").concat(JSON.stringify(t),"; this is a bug"));return n.slice(0,-t.length)+e}function Yt(n,t){return Kt(n,t,"")}function Qt(n,t){return Jt(n,t,"")}function Vt(n,t){return t.slice(0,function(n,t){var e=0;n.length>t.length&&(e=n.length-t.length);var i=t.length;n.length<t.length&&(i=n.length);var s=Array(i),o=0;s[0]=0;for(var r=1;r<i;r++){for(t[r]==t[o]?s[r]=s[o]:s[r]=o;o>0&&t[r]!=t[o];)o=s[o];t[r]==t[o]&&o++}o=0;for(var l=e;l<n.length;l++){for(;o>0&&n[l]!=t[o];)o=s[o];n[l]==t[o]&&o++}return o}(n,t))}Ht.prototype={diff:function(n,t){var e,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=i.callback;"function"==typeof i&&(s=i,i={});var o=this;function r(n){return n=o.postProcess(n,i),s?(setTimeout((function(){s(n)}),0),!0):n}n=this.castInput(n,i),t=this.castInput(t,i),n=this.removeEmpty(this.tokenize(n,i));var l=(t=this.removeEmpty(this.tokenize(t,i))).length,c=n.length,a=1,u=l+c;null!=i.maxEditLength&&(u=Math.min(u,i.maxEditLength));var d=null!==(e=i.timeout)&&void 0!==e?e:1/0,f=Date.now()+d,h=[{oldPos:-1,lastComponent:void 0}],p=this.extractCommon(h[0],t,n,0,i);if(h[0].oldPos+1>=c&&p+1>=l)return r(Ut(o,h[0].lastComponent,t,n,o.useLongestToken));var g=-1/0,m=1/0;function $(){for(var e=Math.max(g,-a);e<=Math.min(m,a);e+=2){var s=void 0,u=h[e-1],d=h[e+1];u&&(h[e-1]=void 0);var f=!1;if(d){var $=d.oldPos-e;f=d&&0<=$&&$<l}var v=u&&u.oldPos+1<c;if(f||v){if(s=!v||f&&u.oldPos<d.oldPos?o.addToPath(d,!0,!1,0,i):o.addToPath(u,!1,!0,1,i),p=o.extractCommon(s,t,n,e,i),s.oldPos+1>=c&&p+1>=l)return r(Ut(o,s.lastComponent,t,n,o.useLongestToken));h[e]=s,s.oldPos+1>=c&&(m=Math.min(m,e-1)),p+1>=l&&(g=Math.max(g,e+1))}else h[e]=void 0}a++}if(s)!function n(){setTimeout((function(){if(a>u||Date.now()>f)return s();$()||n()}),0)}();else for(;a<=u&&Date.now()<=f;){var v=$();if(v)return v}},addToPath:function(n,t,e,i,s){var o=n.lastComponent;return o&&!s.oneChangePerToken&&o.added===t&&o.removed===e?{oldPos:n.oldPos+i,lastComponent:{count:o.count+1,added:t,removed:e,previousComponent:o.previousComponent}}:{oldPos:n.oldPos+i,lastComponent:{count:1,added:t,removed:e,previousComponent:o}}},extractCommon:function(n,t,e,i,s){for(var o=t.length,r=e.length,l=n.oldPos,c=l-i,a=0;c+1<o&&l+1<r&&this.equals(e[l+1],t[c+1],s);)c++,l++,a++,s.oneChangePerToken&&(n.lastComponent={count:1,previousComponent:n.lastComponent,added:!1,removed:!1});return a&&!s.oneChangePerToken&&(n.lastComponent={count:a,previousComponent:n.lastComponent,added:!1,removed:!1}),n.oldPos=l,c},equals:function(n,t,e){return e.comparator?e.comparator(n,t):n===t||e.ignoreCase&&n.toLowerCase()===t.toLowerCase()},removeEmpty:function(n){for(var t=[],e=0;e<n.length;e++)n[e]&&t.push(n[e]);return t},castInput:function(n){return n},tokenize:function(n){return Array.from(n)},join:function(n){return n.join("")},postProcess:function(n){return n}};var Gt="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Xt=new RegExp("[".concat(Gt,"]+|\\s+|[^").concat(Gt,"]"),"ug"),Zt=new Ht;function ne(n,t,e,i){if(t&&e){var s=t.value.match(/^\s*/)[0],o=t.value.match(/\s*$/)[0],r=e.value.match(/^\s*/)[0],l=e.value.match(/\s*$/)[0];if(n){var c=Wt(s,r);n.value=Jt(n.value,r,c),t.value=Yt(t.value,c),e.value=Yt(e.value,c)}if(i){var a=Dt(o,l);i.value=Kt(i.value,l,a),t.value=Qt(t.value,a),e.value=Qt(e.value,a)}}else if(e)n&&(e.value=e.value.replace(/^\s*/,"")),i&&(i.value=i.value.replace(/^\s*/,""));else if(n&&i){var u=i.value.match(/^\s*/)[0],d=t.value.match(/^\s*/)[0],f=t.value.match(/\s*$/)[0],h=Wt(u,d);t.value=Yt(t.value,h);var p=Dt(Yt(u,h),f);t.value=Qt(t.value,p),i.value=Kt(i.value,u,p),n.value=Jt(n.value,u,u.slice(0,u.length-p.length))}else if(i){var g=i.value.match(/^\s*/)[0],m=Vt(t.value.match(/\s*$/)[0],g);t.value=Qt(t.value,m)}else if(n){var $=Vt(n.value.match(/\s*$/)[0],t.value.match(/^\s*/)[0]);t.value=Yt(t.value,$)}}Zt.equals=function(n,t,e){return e.ignoreCase&&(n=n.toLowerCase(),t=t.toLowerCase()),n.trim()===t.trim()},Zt.tokenize=function(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.intlSegmenter){if("word"!=e.intlSegmenter.resolvedOptions().granularity)throw new Error('The segmenter passed must have a granularity of "word"');t=Array.from(e.intlSegmenter.segment(n),(function(n){return n.segment}))}else t=n.match(Xt)||[];var i=[],s=null;return t.forEach((function(n){/\s/.test(n)?null==s?i.push(n):i.push(i.pop()+n):/\s/.test(s)?i[i.length-1]==s?i.push(i.pop()+n):i.push(s+n):i.push(n),s=n})),i},Zt.join=function(n){return n.map((function(n,t){return 0==t?n:n.replace(/^\s+/,"")})).join("")},Zt.postProcess=function(n,t){if(!n||t.oneChangePerToken)return n;var e=null,i=null,s=null;return n.forEach((function(n){n.added?i=n:n.removed?s=n:((i||s)&&ne(e,s,i,n),e=n,i=null,s=null)})),(i||s)&&ne(e,s,i,null),n},(new Ht).tokenize=function(n){var t=new RegExp("(\\r?\\n)|[".concat(Gt,"]+|[^\\S\\n\\r]+|[^").concat(Gt,"]"),"ug");return n.match(t)||[]};var te=new Ht;function ee(n){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ee(n)}te.tokenize=function(n,t){t.stripTrailingCr&&(n=n.replace(/\r\n/g,"\n"));var e=[],i=n.split(/(\n|\r\n)/);i[i.length-1]||i.pop();for(var s=0;s<i.length;s++){var o=i[s];s%2&&!t.newlineIsToken?e[e.length-1]+=o:e.push(o)}return e},te.equals=function(n,t,e){return e.ignoreWhitespace?(e.newlineIsToken&&n.includes("\n")||(n=n.trim()),e.newlineIsToken&&t.includes("\n")||(t=t.trim())):e.ignoreNewlineAtEof&&!e.newlineIsToken&&(n.endsWith("\n")&&(n=n.slice(0,-1)),t.endsWith("\n")&&(t=t.slice(0,-1))),Ht.prototype.equals.call(this,n,t,e)},(new Ht).tokenize=function(n){return n.split(/(\S.+?[.!?])(?=\s+|$)/)},(new Ht).tokenize=function(n){return n.split(/([{}:;,]|\s+)/)};var ie=new Ht;function se(n,t,e,i,s){var o,r;for(t=t||[],e=e||[],i&&(n=i(s,n)),o=0;o<t.length;o+=1)if(t[o]===n)return e[o];if("[object Array]"===Object.prototype.toString.call(n)){for(t.push(n),r=new Array(n.length),e.push(r),o=0;o<n.length;o+=1)r[o]=se(n[o],t,e,i,s);return t.pop(),e.pop(),r}if(n&&n.toJSON&&(n=n.toJSON()),"object"===ee(n)&&null!==n){t.push(n),r={},e.push(r);var l,c=[];for(l in n)Object.prototype.hasOwnProperty.call(n,l)&&c.push(l);for(c.sort(),o=0;o<c.length;o+=1)r[l=c[o]]=se(n[l],t,e,i,l);t.pop(),e.pop()}else r=n;return r}ie.useLongestToken=!0,ie.tokenize=te.tokenize,ie.castInput=function(n,t){var e=t.undefinedReplacement,i=t.stringifyReplacer,s=void 0===i?function(n,t){return void 0===t?e:t}:i;return"string"==typeof n?n:JSON.stringify(se(n,null,null,s),s,"  ")},ie.equals=function(n,t,e){return Ht.prototype.equals.call(ie,n.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"),e)};var oe=new Ht;oe.tokenize=function(n){return n.slice()},oe.join=oe.removeEmpty=function(n){return n};const re=(n,t)=>{if(0==n.length)return 0;let e=0,i=0;for(let s=0;s<t.length;s++)n[s]&&(i++,e+=t[s]*(n[s]>1?Math.sqrt(n[s]):1));let s=i/t.length;return s*=s,e*s};function le(n,t,e){e=e||this.inverted.tokenlinepos,tlplast=e[e.length-1],t=t||this.defines.ck.linepos;const i=tlplast/e.length,s=n.reduce(((n,t)=>t.length+n),0),o=n.map((n=>Math.sqrt(s/n.length)));let r=0,l=[];const c=new Array(n.length);c.fill(0);let a=0;for(;r<e.length-1;){let s=tlplast;const u=e[r],d=e[r+1];let f=[];a=0;for(let t=0;t<n.length;t++){const e=n[t];let i=e[c[t]];for(;i<u&&c[t]<e.length;)c[t]++,i=e[c[t]];for(;i>=u&&i<d;){if(f[t]||(f[t]=0),f[t]++,0==t)a=i;else{const n=i-a-t;f[t]+=0==n?3:1/n}c[t]++,i=e[c[t]]}s>i&&(s=i)}const h=re(f,o);let p=i/(d-u+1)*10;p<10&&(p=10);const g=Math.log(p);if(h>0){const n=Qn(t,r)-1;l.push([r+1,h*g,n])}for(r++;s>e[r+1];)r++}return l=l.sort(((n,t)=>t[1]-n[1])),l}function ce(n,t=null){if(!(t=t||this.loadPostingsSync(n)))return[];n=n.trim();const e=this.name+"@"+n;let i=this.queryCache[e];if(i)return i;i=t[0];for(let n=1;n<t.length;n++){i=zt(i,t[n],n)}return this.queryCache[e]=i||[],this.queryCache[e]}async function ae(n){const t=await this.loadPostings(n);return t?ce.call(this,n,t):[]}async function ue(n,t){t=t||{};const e=n.split(/[, 　]/);e.length>5&&(e.length=5);const i=[],s=[];for(let n=0;n<e.length;n++){if(!e[n].trim())continue;let o=await ae.call(this,e[n]);o&&o.length||"zh"!=this.attributes.lang||(o=await ae.call(this,St(e[n]))),t.ranges&&t.ranges.length&&(o=jt(o,t.ranges)),i.push(e[n]),s.push(o||[])}return[i,s]}async function de(n,t){const e=this,[i,s]=await e.parseQuery(n,t);if(!s.length||!e.inverted)return[];const o=(null==t?void 0:t.groupby)||"ak",r=e.defines[o],l=[],c=e.inverted.tokenlinepos;if(r){for(let n=0;n<r.linepos.length;n++){const t=c[r.linepos[n+1]]||c[c.length-1];l.push([c[r.linepos[n]],t])}const n=new Array(l.length);n.fill(0);for(let t=0;t<s.length;t++){const e=Lt(s[t],l);for(let t=0;t<l.length;t++)n[t]+=e[t]}return n.map(((n,t)=>{const e=r.fields.id.values[t];return{count:n,caption:r.getInnertext(t),scope:o+(parseInt(e)?e:"#"+e)}}))}return[{count:s.length,caption:"-",name:"-"}]}function fe(n,t){const e=this.inverted.tokenlinepos,i=[];for(let s=0;s<t.length;s++){const o=e[n-1],r=e[n],l=Mt(t[s],o,r).map((n=>n-o));i.push(l)}return i}const he=(n,t=0,e=0)=>{if(-1==t)return[n];let i=Array();if(e>0)return[n.slice(t,t+e)];n.length<4&&i.push(n);for(let e=t;e<=n.length;e++){let s=n.slice(t,e);s.length>1&&i.push(s.trim()),s=n.slice(t-1,e),s.length>1&&i.push(s.trim()),s=n.slice(t+1,e),s.length>1&&i.push(s.trim()),s.length}return nt(i)},pe=(n,t)=>{const e={};if(0==n.length)return[];if(1==n.length)return[[n[0],t[0]]];const i=t.reduce(((t,e,i)=>t+Math.log(n[i].length*e.length)),0)/t.length;for(let s=0;s<t.length;s++)Math.log(t[s].length*n[s].length)>i&&t[s].length>1&&(e[n[s]]=t[s]);if(!Object.keys(e).length)for(let i=0;i<t.length;i++)e[n[i]]=t[i];for(let n in e)for(let t in e)n!=t&&e[t].length&&(n.startsWith(t)||n.endsWith(t))&&1.1*e[n].length>=e[t].length&&(e[t]=[]);for(let n in e)0==e[n].length&&delete e[n];return((n,t)=>{const e=[];for(let t in n)e.push([t,n[t]]);return t?e.sort(t):e.sort(((n,t)=>+t[1]-n[1])),e})(e,((n,t)=>t[1].length-n[1].length)).slice(0,3)};async function ge(n,t=0,e=0){const i=[],s=he(n.trim(),t);for(let n=0;n<s.length;n++){const t=s[n];i.push(await ae.call(this,t))}return pe(s,i)}function me(n,t=0,e=0){if(!n.trim())return[];const i=he(n,t,e),s=i.map((n=>ce.call(this,n)));return pe(i,s)}function $e(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}class ve{tagsOf(n=!1){const t=[];if(!this.tags||!this.tags.length)return"";for(let e=0;e<this.tags.length;e++){const i=this.offtext.getTag(this.tags[e]);this.choff==i.choff+(n?i.width-1:0)&&t.push(this.tags[e])}return t}closestTag(){return this.offtext.getTag(this.tags[this.tags.length-1])}constructor(n,t,e,i){$e(this,"token",void 0),$e(this,"open",void 0),$e(this,"close",void 0),$e(this,"text",void 0),$e(this,"css",void 0),$e(this,"hide",void 0),$e(this,"postingoffset",void 0),$e(this,"choff",void 0),$e(this,"ntoken",void 0),$e(this,"tags",void 0),$e(this,"luminate",void 0),$e(this,"highlight",void 0),$e(this,"offtext",void 0),$e(this,"extra",void 0),this.token=n,this.postingoffset=i,this.choff=n.choff,this.text=n.text,this.ntoken=t,this.offtext=e,this.tags=[],this.hide=!1,this.luminate=0,this.highlight=!1,this.css=""}}const ke=(n,t,e=0)=>{for(let i=e;i<n.length;i++)if(n[i].token.text===t)return n[i]},be="undefined"!=typeof navigator&&navigator.userAgent.match(/Chrome\/(\d+)/);be&&parseInt(be[1]);let ye={};const xe=n=>ye[n],we=n=>delete ye[n],Ae=()=>{const n=Array();for(const t in ye)n.push(ye[t]);return n},Ce=n=>{var t;let e=null===(t=n.attributes)||void 0===t?void 0:t.align;e||(e=n.name.replace(/\-[^-]+$/,""));const i=Array();for(const t in ye)ye[t].attributes.align!=e&&t.replace(/\-[^-]+$/,"")!=e||n.name!==ye[t].name&&i.push(t);return i},Oe=n=>n.toString().padStart(3,"0")+".js",Pe=(n,t)=>n+"/"+Oe(t);async function Ie(n){let t=Pe(this.name,n);!fs.existsSync(t)&&fs.existsSync("../"+this.name+"/"+this.name)&&(t=Pe("../"+this.name+"/"+this.name,n));try{const e=await fs.promises.readFile(t,"utf8");this.setPage(n,...bt(e))}catch(n){console.error("readFile failed,",t,n)}}async function Te(n){throw"not implement yet"}async function _e(n){const t=this.name+"/"+Oe(n),e=this.zipstore.find(t),i=e&&(new TextDecoder).decode(e.content);i&&this.setPage(n,...bt(i))}async function Se(n){if(this.zip){const t=await this.zip.readTextFile(this.name+"/"+Oe(n));return void this.setPage(n,...bt(t))}const t=Pe(this.name,n);try{const e=await fetch(t),i=await e.text(),s=bt(i);this.setPage(n,...s)}catch(n){this.failed=!0}}const Ne=(n,t,e)=>{xe(t.name).setPage(n,t,e)};function Ee(n){return 0==n?this.pagestarts.length:this._pages[n-1]}async function ze(n){if(Ee.call(this,n))return;"function"!==(window.jsonp,!1)&&(window.jsonp=Ne);let t,e=0;const i=this;try{await(async(n,t)=>{if(t&&t())return!0;"./"==n.slice(0,2)&&(n=n.slice(2));const e=n.endsWith(".css"),i=document.head.children;for(let t=0;t<i.length;t++){const s=i[t];if(e&&"LINK"==s.tagName&&s.href.endsWith("/"+n))return t<i.length-1&&(document.head.removeChild(s),document.head.appendChild(s)),!0;if("SCRIPT"==s.tagName&&s.src.endsWith("/"+n))return!0}return new Promise(((t,i)=>{const s=document.createElement(e?"link":"script");s.type=e?"text/css":"text/javascript",e?(s.rel="stylesheet",s.href=n):s.src=n,s.onerror=i,s.async=!0,s.onload=t,document.head.appendChild(s)}))})(Pe(i.name,n),(()=>{if(Ee.call(i,n))return!0;t=setInterval((()=>{e++,(e>10||Ee.call(i,n))&&(e>10&&console.error("failed loading page",n,i.name),clearInterval(t))}),10)}))}catch(n){this.failed=!0}}function Le(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}let Me=0;class je{async loadAll(){return await this.loadLines([[0,this.pagestarts[this.pagestarts.length-1]]]),this.slice(0,this.pagestarts[this.pagestarts.length-1])}inMem(){return this.inmemory||this.zipstore}pageOfRange([n,t]){if(n<0)return[];n>t&&(t+=n);let e=this.pageOfLine(n);const i=this.pageOfLine(t),s=Array();e>1&&e--;for(let n=e;n<i+1;n++)this._pages[n]||s.push(n);return s}async loadLines(n){const t=this;let e=Array(),i=(n=>{const t=Array();let e=0;if(n=n.filter((n=>!!n)),!Array.isArray(n[0])||!n.length)return n;n.sort(((n,t)=>n-t)),e=n[0][0];for(let i=1;i<n.length;i++)n[i][0]>n[i-1][1]&&(t.push([e,n[i-1][1]]),e=n[i][0]);return n[n.length-1][1]>e&&t.push([e,n[n.length-1][1]]),t})(n);const s={};for(let n=0;n<i.length;n++)if(Array.isArray(i[n])){const[t,s]=i[n];e.push(...this.pageOfRange([t,s]))}else s[this.pageOfLine(i[n])]=!0;e.push(...Object.keys(s).map((n=>parseInt(n)))),e=nt(e.filter((n=>!t._pages[n])));const o=Array();for(let n=0;n<e.length;n++)o.push(this._loader.call(this,e[n]+1));await Promise.all(o)}lineCount(){return this.header.starts[this.header.starts.length-1]}getPageLineOffset(n,t){return n>this._pages.length||0==t?0:t>this._lineoffsets[n].length?this._pages[n].length:this._lineoffsets[n][t-1]}getLines(n){if(!n.length)return[];let t=Array(),e=n[0],i=e;for(let s=1;s<n.length;s++)e+1!==n[s]&&(t=t.concat(this.slice(i,s)),i=n[s]),e=n[s];return t=t.concat(this.slice(i,e+1)),t}getLine(n){return this.slice(n,n+1)[0]}slice(n,t){t||(t=n+1);const e=this.pageOfLine(n),i=this.pageOfLine(t);let s="";for(let o=e;o<=i;o++){if(!this._pages[o])return s.split("\n");if(o==e||o==i){let r=this.getPageLineOffset(o,n-(e>0?this.pagestarts[e-1]:0));n&&r++;const l=this.getPageLineOffset(o,t-(i>0?this.pagestarts[i-1]:0));if(i>e){const n=this._pages[o].slice(0,l);o==e?s=this._pages[o].slice(r):s+=(s&&n?"\n":"")+n}else s+=this._pages[o].slice(r,l)}else s+=(s.length?"\n":"")+this._pages[o]}return s.split("\n")}setPage(n,t,e){0==n?(this.header=t,this.name=this.header.name,this.pagestarts=t.starts,this.payload=e||"nopayload",this.opened=!0):n>0&&(this._pages[n-1]=e,this._lineoffsets[n-1]=(n=>{let t=0;const e=Array();for(;t<n.length;){const i=n.indexOf("\n",t);if(-1==i)break;e.push(i),t=i+1}return e})(e))}isReady(){if(this.payload)return!0;const n=this;let t;return new Promise((e=>{t=setInterval((()=>{n.failed?e(!1):n.payload&&(clearInterval(t),e(!0))}),50)}))}getSection(n){const[t,e]=this.sectionRange(n);return t==e?[]:this.slice(t,e)}sectionRange(n){const{sectionnames:t,sectionstarts:e}=this.header;if(!t||!t.length)return[0,0];for(let i=0;i<t.length;i++){const s=t[i];if(n&&s==n){const n=i<e.length-1?e[i+1]:this.pagestarts[this.pagestarts.length-1];return[e[i],n]}}return[0,0]}constructor(n){Le(this,"_pages",void 0),Le(this,"_lineoffsets",void 0),Le(this,"stamp",void 0),Le(this,"pagestarts",void 0),Le(this,"header",void 0),Le(this,"name",void 0),Le(this,"zip",void 0),Le(this,"zipstore",void 0),Le(this,"payload",void 0),Le(this,"_loader",void 0),Le(this,"failed",void 0),Le(this,"inmemory",void 0),Le(this,"opened",void 0),Le(this,"pageOfLine",(n=>n>=this.pagestarts[this.pagestarts.length-1]?this.pagestarts.length-1:Qn(this.pagestarts,n))),this.stamp=++Me,this._pages=[],this._lineoffsets=[],this.pagestarts=[],this.header={starts:Array(),sectionnames:Array(),sectionstarts:Array(),sectiontypes:Array(),preload:Array(),name:""},this.name=n.name||"",this.zip=n.zip,this.zipstore=n.zipstore,this.payload;let t="undefined"!=typeof chrome?"chrome-extension:":"";if("undefined"!=typeof window&&(t=window.location.protocol),this.zipstore?this._loader=_e:this._loader="http:"===t||"https:"===t||"chrome-extension:"===t?Se:"file:"==t?ze:this.zip?Te:Ie,this.failed=!1,n.contentString){const[t,e]=qn(n.contentString),i=JSON.parse(t),s=n.contentString.slice(e).split("\n"),o=(s.shift()||"").replace(/\\n/g,"\n");this.setPage(0,i,o);for(let n=0;n<i.starts.length;n++){const t=s.slice(n>0?i.starts[n-1]:0,i.starts[n]);this.setPage(n+1,{},t.join("\n"))}this.inmemory=!0}else n.inmemory||this._loader.call(this,0)}}var Fe=function(n){return n.NoKeys="NO_KEYS",n.NoKey="NO_KEY",n.NotANumber="NOT_NUMBER",n.Empty="EMPTY_BUFFER",n.Pattern="PATTERN_MISMATCH",n.NotUnique="NOT_UNIQUE",n.Mandatory="MANDANTORY",n.TypeRedef="TYPE_REDEF",n.MissingTagName="MISSING_TAGNAME",n.UnknownType="UNKNOWN_TYPE",n.ExcessiveField="EXCESSIVE_FIELD",n.PtkNamed="PTK_NAMED",n.PtkNoName="PTK_NONAME",n.RedefineChunkTag="REDEFINE_CHUNK_CHUNK_TAG",n.InvalidLinkAddress="INVALID_LINK_ADDRESS",n}({});function Be(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}Fe.MissingTypedef;class qe{resetUnique(){this.unique&&(this.unique={})}validate(n,t){if(this.unique){if(this.unique[n])return[Fe.NotUnique,"tag:"+this.name+", value:"+n,this.unique[n]];this.unique[n]=t}return[0,n]}find(){return-1}constructor(n,t){Be(this,"type",void 0),Be(this,"name",void 0),Be(this,"foreign",void 0),Be(this,"optional",void 0),Be(this,"unique",void 0),Be(this,"caption",void 0),this.name=n,this.foreign=t.foreign||"",this.pattern=t.pattern||null,this.keys=t.keys||[],this.unique=null,this.optional=!0,this.caption="",this.type=t.type||"string",this.values=[],this.sortedIndex;for(let e in t)this.hasOwnProperty(e)||console.log("unknown defining attr",e,"of",n,t),this[e]=t[e];t.unique&&(this.unique={})}}const Re=(n,t=!1)=>{if(!n)return[];const e=n.split("."),i=Array();for(let n=0;n<e.length;n++){const t=e[n].match(/^([a-z_\-]+)#([a-z\d_-]+)$/),s=e[n].match(/^([a-z_\-]+)(\d+[a-z\d_-]+)$/),o=e[n].match(/^([a-z_\-]+)(\d*)$/);if(t)i.push([t[1],t[2]]);else if(s)i.push([s[1],s[2]]);else if(o)i.push([o[1],o[2]]);else{const t=e[n].indexOf("#");t>0?i.push([e[n].slice(0,t),e[n].slice(t+1)]):i.push(["ck",e[n]])}}if(t){const n={};for(let t=0;t<i.length;t++){const[e,s]=i[t];n[e]=s}return n}return i},He=n=>{let t,e="",i="",s="",o="",r="",l=n.match(Cn);if(l)[t,e,i,s,o,r]=l;else if(l=n.match(An),l)[t,e,s,o,r]=l;else{if(l=n.match(wn),!l)return null;[t,s,o,r]=l}s=(s||"").slice(1),o=(o||"").slice(1),r=(r||"").slice(1),s||o||!r||parseInt(r)>5&&(s=parseInt(r)-Math.floor(2.5),o=s+5);let c=0;const a=r.indexOf("-");return~a&&(c=parseInt(r.slice(a+1))),e=e||"",e=e.slice(0,e.length-1),{ptkname:e,action:i,from:Math.abs(parseInt(s))||0,till:Math.abs(parseInt(o))||0,highlightline:r?parseInt(r):-1,lineoff:parseInt(r),choff:c}};function Ue(n){const t=Array(),e=this;let i=0,s=e.header.eot;for(let f=0;f<n.length;f++){const[h,p]=n[f];if(e.defines[h]){var o;const n=null===(o=e.defines[h])||void 0===o?void 0:o.fields.id,r="number"==(null==n?void 0:n.type)?parseInt(p):p,l=Qn(e.defines[h].linepos,i),c=n.values.indexOf(r,l),a=e.defines[h].linepos[c]||e.defines[h].linepos[0];let u=e.defines[h].linepos[c+1]||e.header.eot;if(!(a>=i&&n.values[c]==r))return[];i=a,u>s&&s!==e.header.eot?u=s:s=u,t.push([a,u])}else{var r,l;const n=null===(r=e.defines.bk)||void 0===r?void 0:r.fields.id.values.indexOf(h),s=-1==n?null===(l=e.defines.ak)||void 0===l?void 0:l.fields.id.values.indexOf(h):-1;if(0==f&&(~n||~s)){var c,a,u,d;const o=(null===(c=e.defines.bk)||void 0===c?void 0:c.linepos[n])||(null===(a=e.defines.ak)||void 0===a?void 0:a.linepos[s]);let r=(null===(u=e.defines.bk)||void 0===u?void 0:u.linepos[n+1])||(null===(d=e.defines.ak)||void 0===d?void 0:d.linepos[s+1]);r||(r=e.header.eot),t.push([o,r]),i=o}}}if(n.length>1){const n=e.header.sectionstarts;for(let e=0;e<t.length;e++){let[i,s]=t[e];const o=Qn(n,i+1);s>n[o]&&(t[e][1]=n[o])}}return t}function We(n){let t=n;"string"==typeof n&&(t=He(n));const{from:e,till:i,action:s,highlightline:o}=t,r=Re(s),l=Ue.call(this,r);if(l.length){const[n,t]=l[l.length-1];return[n,t,e,i,o]}return[0,0,e,i,o]}async function De(n){const t=We.call(this,n);if(!t||t[0]==t[1])return[];await this.loadLines([t]);return this.slice(t[0],t[1])}async function Ke(n,t="num"){const e=We.call(this,n);if(!e||e[0]==e[1])return[];const i=this.getSectionName(e[0]),s=i.replace("off",t),o=this.getSectionStart(i),r=this.getSectionStart(s);if(~r){const n=e[0]-o+r,i=e[1]-o+r;await this.loadLines([n,i]);let s=this.slice(n,i);return"num"==t&&(s=s.map((n=>at(n)))),s}return[]}function Je(n){let t=n;"string"==typeof n&&(t=He(n));const{action:e}=t,i=this.defines,s=Re(e),o=[];for(let n=0;n<s.length;n++){var r,l;const[t,e]=s[n];if(!i[t]||!i[t].fields.id)return"";const c=i[t].fields.id.values.indexOf(e);o.push(null===(l=i[t])||void 0===l||null===(r=l.innertext)||void 0===r?void 0:r.get(c))}return o.join("/")}function Ye(n,t){return n+(isNaN(parseInt(t))?"#":"")+t}function Qe(n){const t=Re(n),e=Array();let i=0;for(let n=0;n<t.length;n++){let[s,o]=t[n];if(!this.defines[s])continue;const r=this.defines[s].linepos,l=this.defines[s].fields.id.values,c=Qn(r,i);"number"==typeof l[0]&&(o=parseInt(o));let a=l.indexOf(o,c),u=a-c;a<0&&(a=0),u<0&&(u=0),e.push({tagname:s,at:a,rel:u}),i=r[a]}return e}function Ve(n,t){const e=this.defines[n];if(!this.defines[n])return null;const i=e.fields.id.values.indexOf(t);return~i?this.getTagFields(n,[i])[0]:null}async function Ge(n,t){const e=Ue.call(this,[[n,t]]);if(e.length){const[i,s]=e[0];await this.loadLines([i,i+1]);const o=this.getLine(i),[r,l]=Wn(o);for(let e=0;e<l.length;e++)if(l[e].name==n&&l[e].attrs.id==t)return l[e]}return null}function Xe(n,t=0,e=0){var i;e||(e=this.header.eot);const s=null===(i=this.defines[n])||void 0===i?void 0:i.linepos;if(!s)return[];const o=Qn(s,t);let r=Qn(s,e);return s[r]>e&&r--,[o,r]}function Ze(n,t){const[e,i]=this.rangeOfAddress(n),[s,o]=this.tagInRange(t,e,i);return o-s}function ni(n,t,e=""){if("string"==typeof t&&(t=this.defines[t]),!t)return-1;const i=t.linepos;if(!i)return null;const s=Qn(i,n)-1,o=n<i[i.length-1]?s:s+1;return e?t.fields[e].values[o]:o}function ti(n,t,e,i=0){let s=n.fields[t].values.indexOf(e);for(;s>=0&&n.linepos[s]<i;)s=n.fields[t].values.indexOf(e,s+1);return s}function ei(n,t){var e;const i=null===(e=this.defines[n])||void 0===e?void 0:e.fields;return!(!i||!i.id)&&("number"==i.id.type&&"number"!=typeof t&&(t=parseInt(t)),!!~i.id.values.indexOf(t))}function ii(n,t,e=[]){const i=this.defines[n];if(!i)return[];let[s,o]=t.split("=");o||(o=s,s="id");const r=Array(),l=i.fields[s];if(!l)return[];let c=l.values.indexOf(o);for(;~c;)r.push(c),c=l.values.indexOf(o,c+1);return this.getTagFields(n,r,e)}function si(n,t=null,e=null){const i=this.defines[n];if(!i)return[];const s=Array(),o=n=>{const t={at:n};if(e)for(let s=0;s<e.length;s++){const o=i.fields[e[s]];o&&(t[e[s]]=o.values[n])}else{for(let e in i.fields)i.fields[e].values[n]&&(t[e]=i.fields[e].values[n]);t.innertext=i.getInnertext(n)}return t};if(t)for(let n=0;n<t.length;n++)s.push(o(t[n]));else for(let n=0;n<i.count;n++)s.push(o(n));return s}function oi(n){const t=Array();if(!n)return t;n.endsWith(".off")||(n+=".off");const e=this.header,i=e.sectionnames.indexOf(n);if(!~i)return t;const s=e.sectionstarts[i+1]-e.sectionstarts[i];for(let n=0;n<e.sectionnames.length;n++){const o=e.sectionnames[n];if(n==i)continue;e.sectionstarts[n+1]-e.sectionstarts[n]==s&&o.match(/^[a-z]/)&&o.endsWith(".off")&&o!==e.sectionnames[i]&&t.push(o.replace(".off",""))}return t}class ri extends qe{validate(n,t){const e=He(n),i=Re(e.action);this.invertlinks[e.ptkname]||(this.invertlinks[e.ptkname]={});let s=this.invertlinks[e.ptkname];i.length;for(let n=0;n<i.length;n++){let[t,e]=i[n];0!=n||i[n][1]||(t="bk",e=i[n][0]);const o=Ye(t,e);n==i.length-1?(s[t]||(s[t]={}),s[t][e]||(s[t][e]=[]),s[t][e].push(this.count),this.count++):(s[o]||(s[o]={}),s=s[o])}return[0,n]}serializeLinks(n){const t=[];for(let e in n){const i=n[e];for(let n in i){const s=[];for(let t in i[n])s.push([t,i[n][t]]);s.sort(Zn);const o=s.map((n=>n[0])),r=s.map((n=>n[1]));t.push(e),t.push(n),t.push(o.join($t)),t.push(ht(r))}}return t}serialize(){const n={};let t=[].concat(this.values);for(let e in this.invertlinks){const i=this.serializeLinks(this.invertlinks[e]);n[e]=i.length,t=t.concat(i)}return n["*"]=this.values.length,t.push(JSON.stringify(n)),t}deserialize(n,t){const e=JSON.parse(n.pop()),i=e["*"];let s=0;for(let o in e){if("*"==o)continue;const r=e[o];for(;s<r;){const e=n[i+s],r=n[i+s+1],l=new vt(n[i+s+2],{sep:$t}),c=ft(n[i+s+3]);t.addBacklinks(this.name,o,e,r,l,c),s+=4}}const o=n.slice(0,i);return n.length=0,o}constructor(n,t){super(n,t),this.invertlinks={},this.type="link",this.count=0}}class li extends qe{validate(n,t){const e=this.keys;if(!e)return[Fe.NoKeys,n];if(!n)return[this.optional?0:Fe.Mandatory,[]];const i=Vn(e,n);return e[i]!==n?[Fe.NoKey,[]]:[0,i]}constructor(n,t){super(n,t),this.type="key"}}class ci extends qe{validate(n,t){const e=this.keys;if(!e)return[Fe.NoKeys,n];if(!n)return[this.optional?0:Fe.Mandatory,[]];const i=n.split(",").map((n=>{if(!n)return 0;const t=Vn(e,n);return e[t]===n?t:-1})).filter((n=>!!n)).sort(((n,t)=>n-t));return i.filter((n=>-1===n)).length?[Fe.NoKey,[]]:[0,i]}constructor(n,t){super(n,t),this.type="keys"}}class ai extends qe{constructor(n,t){super(n,t),this.type="text"}}class ui extends qe{_sort(){[this.values,this.sortedIndex]=(n=>{const t=n.map(((n,t)=>[n,t]));t.sort(((n,t)=>n[0]-t[0]));const e=t.map((([n,t])=>t));return[t.map((([n,t])=>n)),e]})(this.values)}find(n){if(!this.values.length)return-1;this.sortedIndex||this._sort();const t=Vn(this.values,n);return this.values[t]==n?this.sortedIndex[t]:-1}validate(n,t){const e=parseInt(n);if(e.toString()!==n&&(null==n?void 0:n.length))return[Fe.NotANumber,t];if(this.pattern&&!n.match(this.pattern))return[Fe.Pattern,0];if(this.unique&&e>=0){if(this.unique[n])return[Fe.NotUnique,"tag:"+this.name+", value:"+n,this.unique[n]];this.unique[n]=t}return[0,parseInt(n)]}constructor(n,t){super(n,t),this.type="number",this.name=n,this.sortedIndex=null}}class di extends qe{validate(n,t){void 0===n&&console.log("undefined",t);const e=n.split(",").filter((n=>!!n)),i=[];for(let n=0;n<e.length;n++){const s=e[n],o=parseInt(e[n]);if(o.toString()!==s&&s.length)return[Fe.NotANumber,t];if(this.pattern&&!s.match(this.pattern))return[Fe.Pattern,t];i.push(o)}return[0,i]}constructor(n,t){super(n,t),this.type="numbers"}}class fi extends qe{validate(n,t,e){const i=n.split(","),s=[];let o=0;for(let n=0;n<i.length;n++){const t=parseInt(i[n]);if(isNaN(t)){const t=e[i[n]];if(!t)throw"no such file "+i[n];o=t.linestart}else s.push(o+t)}return[0,s]}constructor(n,t){super(n,t),this.type="filelinepos",this.prevfn=""}}class hi extends qe{validate(n,t){if(!n)return[this.optional?0:VError.Mandatory,[]];if(this.ranges[n]||(this.ranges[n]=[]),this.ranges[n].push(t),isNaN(n))throw"group index should be numeric";return[0,parseInt(n)]}serialize(n){const t=Object.keys(this.ranges);t.sort(Xn),n.push(t.join($t));const e=[];for(let n=0;n<t.length;n++)e.push(this.ranges[t[n]]);n.push(gt(e)),n.push()}deserialize(n){const t=(n.shift()||"").split($t),e=dt(n.shift());for(let n=0;n<t.length;n++)this.ranges[t[n]]=e[n]}constructor(n,t){super(n,t),this.type=t.type||"range",this.ranges={}}}function pi(n,t,e,i=!1){if("string"!=typeof t)return new qe(n,t);let s;const o=t.match(/([a-z_]+):?([a-z_]*)\/?(.*)/);if(!o)return;const r=o[1],l=o[2];let c,a=o[3];if(a){const n=a.lastIndexOf("/");let t="";n>0&&(t=a.slice(n+1),a=a.slice(0,n)),c=new RegExp(a,t)}if("number"===r)s=new ui(n,{pattern:c,foreign:l});else if("numbers"===r)s=new di(n,{pattern:c,foreign:l});else if("filelinepos"===r)s=new fi(n,{pattern:c,foreign:l});else if("unique_number"===r)s=new ui(n,{pattern:c,unique:!0,optional:!1,foreign:l});else if("unique"===r)s=new ai(n,{pattern:c,unique:!0,optional:!1,foreign:l});else if("string"===r)s=new qe(n,{pattern:c,foreign:l});else if("link"===r)s=new ri(n,{pattern:c,foreign:l});else if("text"===r)s=new ai(n,{pattern:c});else if("key"===r){const t=e&&e[l]||i;s=new li(n,{keys:t,pattern:c,foreign:l,optional:!1})}else if("keys"===r){const t=e&&e[l]||i;s=new ci(n,{keys:t,pattern:c,foreign:l})}else if("group"===r)s=new hi(n,{type:r});else if("note"===r){const t=e&&e[l]||i;s=new qe(n,{type:r,keys:t,pattern:c,foreign:l})}else"confer"===r&&(s=new qe(n,{type:r,foreign:l}));return s||(s=new qe(n,{})),s}function gi(n,t){const e=parseInt(t.name.slice(1,2),36)-10;if(isNaN(e))return;if(!(e==this.prevdepth||e==this.prevdepth+1||e<this.prevdepth)){const n="目彔深度错误 "+this.prevdepth+"+1!="+e;this.errors.push({msg:n,offset:t.offset,prev:this.prevzline})}let i=n.tagText(t);const s=Tn(i);i.slice(i.length-1)==s&&(i=i.slice(1,i.length-1));const o=this.compiledLine+this.line;this.toc.push({depth:e,text:i,key:this.zcount,line:o}),this.zcount++,this.prevzline=o,this.prevdepth=e}function mi(n,t){const e=this.typedefs.y;e.linepos.push(this.compiledLine+this.line);e.fields.id.values.push(t.name.slice(1)+(t.attrs.id||""));let i=_n(n.tagText(t));e.innertext.push(i),e.count++}function $i(n,t){const e=this.typedefs.x;e.linepos.push(this.compiledLine+this.line);const i=e.fields.id,s=t.attrs.id+(t.attrs.ln?"@"+t.attrs.ln:"")||"";i.values.push(t.name.slice(1)+s);let o=_n(n.tagText(t));e.innertext.push(o),e.count++}function vi(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}class ki{addColumn(n){this.fieldnames.push(n),this.fieldvalues.push([])}tokenizeField(n){const t=Fn(n);for(let n=0;n<t.length;n++){const{text:e,type:i}=t[n];i>Mn.SEARCHABLE&&!this.tokentable[e]&&(this.tokentable[e]=!0)}}addRow(n,t,e,i){let s=0;for(e&&s++;s<this.fieldsdef.length;s++){const e=this.fieldsdef[s],[o,r]=e.validate(n[s],t,i);o&&this.onError&&this.onError(o,this.fieldnames[s]+" "+n[s],-1,t),this.fieldvalues[s].push(r||""),s+1==this.tokenfield&&this.tokenizeField(r)}}createFields(n){if(n)for(let t in n){const e=n[t]||"key=string",[i,s]=e.split("=");this.addColumn(i);const o=pi(i,s||{},this.primarykeys,this.keys);this.fieldsdef.push(o)}}deserialize(n){var t;if(!n.length)return;const e=n.shift(),[i,s]=Wn(e);if(!n.length)return;this.attrs=null===(t=s[0])||void 0===t?void 0:t.attrs,this.name=this.attrs.name,this.caption=this.attrs.caption;const o=i.split("\t");this.createFields(o),"serial"==this.attrs.keytype?this.keys=null:this.keys=new vt(n.shift(),{sep:$t}),this.attrs.tokenfield&&(this.tokenfield=parseInt(this.attrs.tokenfield),this.runtimetokentable=(n.shift()||"").split($t),this.runtimetokentable.sort(Xn));let r=0,l=!1;for(let t in this.fieldsdef){const e=this.fieldsdef[t];"number"===e.type?this.fieldvalues[r]=at(n.shift()):"numbers"===e.type||"filelinepos"===e.type||"keys"===e.type?this.fieldvalues[r]=dt(n.shift()):"key"===e.type?this.fieldvalues[r]=at(n.shift()):"string"===e.type?this.fieldvalues[r]=n.shift().split($t):"group"===e.type?(e.deserialize(n),this.fieldvalues[r]=at(n.shift())):"text"===e.type&&(l=!0,this.fieldvalues[r]=n),this[e.name]||(this[e.name]=this.fieldvalues[r]),r++}!l&&n.length&&console.log("section not consumed")}fromStringArray(n,t={},e=1,i){const s=Array();let o=n.first(),r=0,l=!1;for(;e>0;)o=n.next(),e--;for(;o||""===o;){const t=o.split("\t");s.push(t),o=n.next()}if("serial"!==t.keytype&&(s.sort(Zn),l=!0,this.keys=s.map((n=>n[0]))),this.createFields(this.typedef),t.tokenfield&&(this.tokenfield=parseInt(t.tokenfield||-1),this.tokentable={},0===this.tokenfield&&this.tokenizeField(this.keys.join($t))),!this.fieldnames.length)throw"missing typedef";for(let n=0;n<s.length;n++)this.addRow(s[n],n+1,l,i);const c=Array();this.keys&&c.push(this.keys.join($t)),this.tokenfield>-1&&c.push(Object.keys(this.tokentable).join($t));for(let n=0;n<this.fieldnames.length;n++){const t=this.fieldsdef[n];if("number"==t.type||"line"==t.type){const t=this.fieldvalues[n].map((n=>parseInt(n)||0))||[];c.push(pt(t))}else if("numbers"==t.type||"filelinepos"==t.type){const t=this.fieldvalues[n]||[];if(1==t.length)throw"must have more than one array";c.push(gt(t))}else if("keys"==t.type){const t=this.fieldvalues[n]||[];c.push(gt(t))}else if("key"==t.type){const t=this.fieldvalues[n]||[];c.push(pt(t))}else if("string"==t.type)c.push(this.fieldvalues[n].join($t));else if("group"==t.type)t.serialize(c),c.push(pt(this.fieldvalues[n]));else if("text"==t.type){if(n!==this.fieldnames.length-1)throw"multiline text fieldtype must be the last, "+this.fieldnames[n];r=c.length;for(let t=0;t<this.fieldvalues[n].length;t++)c.push(this.fieldvalues[n][t])}else t.type&&this.onError&&this.onError(Fe.UnknownType,t.type)}return 0==r&&(r=c.length),[c,r]}fromTSV(n,t,e=1){const i=new vt(n,{sequencial:!0});return this.fromStringArray(i,t,e,this.compiledFiles)}toTSV(){if(!this.keys)return"";let n=this.keys.first(),t=0;const e=Array();for(;n;){const i=[n];for(let n=1;n<this.fieldvalues.length;n++)i.push(this.fieldvalues[n][t]);n=this.keys.next(),t++,e.push(i.join("\t"))}return e.join("\n")}findKey(n){return this.keys?this.keys.find(n.toString()):parseInt(n)-1}fieldsByKey(n){const t=this.findKey(n);if(!n)return null;if(~t){const e={key:n};for(let n=0;n<this.fieldvalues.length;n++)e[this.fieldnames[n]]=this.fieldvalues[n][t];return e}return null}fieldByKey(n,t){const e=this.findKey(n);if(!n)return null;if(~e){const n=this.fieldnames.indexOf(t);return~n?this.fieldvalues[n][e]:this.fieldvalues[1][e]}return null}getKey(n){return this.keys?this.keys.get(n):(n+1).toString()}constructor(n={}){vi(this,"fieldvalues",void 0),vi(this,"fieldnames",void 0),vi(this,"fieldsdef",void 0),vi(this,"name",void 0),vi(this,"attrs",void 0),vi(this,"caption",void 0),vi(this,"keys",void 0),vi(this,"primarykeys",void 0),vi(this,"onError",void 0),vi(this,"tokenfield",void 0),vi(this,"tokentable",void 0),vi(this,"runtimetokentable",void 0),vi(this,"typedef",void 0),this.fieldvalues=[],this.fieldnames=[],this.fieldsdef=[],this.name="",this.keys=null,this.primarykeys=n.primarykeys||{},this.onError=n.onError,this.typedef=n.typedef,this.tokenfield=-1,this.tokentable={},this.runtimetokentable=Array()}}var bi=function(n){return n.Offtext="txt",n.TSV="tsv",n.Unknown="unknown",n}({});function yi(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}const xi={caption:!0,lazy:!1,key:!0,field:!0,text:!0,type:!0};class wi{resetChildTag(){if(this.attrs.reset){const n=this.attrs.reset.split(",");for(let t=0;t<n.length;t++){const e=this.typedefs[n[t]];if(e)for(let n in e.fields){const t=e.fields[n];t.unique&&t.resetUnique()}}}}validateFields(n,t,e,i){let s,o=!1;this.count++;for(let r in this.attrs){const l=this.fields[r];let c=n.attrs[r];l&&!l.foreign&&l.values.push(n.attrs[r]);let[a,u,d]=l&&l.validate(n.attrs[r],t,i)||[0,c,-1];a?e(a,u,d):(o||(s=Object.assign({},n),s.attrs=Object.assign({},n.attrs)),Array.isArray(u)&&(u=u.join(",")),s.attrs[r]=u,o=!0)}return s}validateTag(n,t,e,i,s,o){if((this.fields.id||this.fields["@"]||this.fields.ln||this.attrs.savelinepos)&&this.linepos.push(i+e),this.attrs.bracket){let e=n.tagText(t);e||(e=n.plain.trim()),"true"!==this.attrs.bracket&&(e=_n(e)),this.innertext.push(e.slice(0,15))}for(let n in this.mandatory)!t.attrs.hasOwnProperty(n)&&this.mandatory[n]&&o(Fe.Mandatory,t.name+" "+n);this.resetChildTag();return this.validateFields(t,e,o,s)}deserialize(n,t,e){const i=n.shift(),s=i?i.split($t):[];if(n.length>s.length&&(this.linepos=ut(n.shift()),this.count=this.linepos.length),n.length){this.fields.bracket&&(this._innertext=new vt(n.shift()||"",{sep:$t}));for(let e=0;e<s.length;e++){const i=s[e],o=this.fields[i];o?"number"===(null==o?void 0:o.type)?o.values=at(n.shift()):"text"===(null==o?void 0:o.type)?o.values=n.length?(n.shift()||"").split("\t"):[]:(null==o?void 0:o.deserialize)&&(o.values=o.deserialize(n,t)):console.error("unknown type "+i)}n.length&&console.log("unconsumed section lines",n.length,e)}}serialize(){const n=Array(),t=Array();if(!this.count)return null;var e;(this.linepos.length||this.fields.bracket)&&t.push((e=this.linepos,pt(e,!0))),this.fields.bracket&&t.push((this.innertext||[]).join($t));for(let e in this.fields){const i=this.fields[e];if(!i.foreign)if("number"==i.type)n.push(e),t.push(pt(i.values.map((n=>parseInt(n)||0))));else if("text"==i.type)n.push(e),t.push(i.values.join("\t"));else if(i.serialize){n.push(e);const s=i.serialize();for(let n=0;n<s.length;n++)t.push(s[n])}}return t.unshift(n.join($t)),t.length?t.join("\n"):null}getInnertext(n){var t;return(null===(t=this._innertext)||void 0===t?void 0:t.get(n))||""}constructor(n,t,e,i){yi(this,"count",void 0),yi(this,"fields",void 0),yi(this,"mandatory",void 0),yi(this,"tagname",void 0),yi(this,"linepos",void 0),yi(this,"innertext",void 0),yi(this,"_innertext",void 0),yi(this,"typedefs",void 0),yi(this,"column",void 0),yi(this,"attrs",void 0),this.fields={},this.mandatory={},this.tagname=t,this.linepos=[],this.typedefs=i,this.innertext=[];for(let i in n){const s=n[i],o=pi(t,"string"==typeof s?s:{optional:!1},e);o&&(this.fields[i]=o),!o||o.optional||xi[i]||(this.mandatory[i]=!0)}if(this.attrs=n,this.column="",this.count=0,this.attrs.resetby){const n=this.attrs.resetby.split(",");for(let e=0;e<n.length;e++){const i=this.typedefs[n[e]];if(i)if(i.attrs.reset){const n=i.attrs.reset.split(",");n.push(t),i.attrs.reset=nt(n).join(",")}else i.attrs.reset=t;else console.log("not such parent tag",n[e])}}}}const Ai={generic:"^:ak<id=unique bracket=false reset=n>\n^:bk<id=unique heading=text bracket=false reset=ck,dk,juan aligncaption=text>\n^:ck<id=unique heading=text bracket=false>\n^:dk<id=unique>\n^:p<id=text>\n^:b<bracket=false>\n^:n<id=number>\n^:pn<id=text>\n^:folio<id=number>\n^:m<id=text>\n^:juan<id=number>\n^:o<@=link>\n^:j<@=link>\n^:k<id=text>\n^:wiki\n^:png<id=text src=text>\n^:svg<id=text>\n^:uiicon<id=text>\n^:jpg<src=text>\n^:ad\n^:bc\n^:gatha\n^:au\n^:cut\n^:paste\n^:notranslation\n^:ver<savelinepos=true>\n^:f<id=text>\n^:i<bracket=false @=text savelinepos=true>\n^:sponsor<savelinepos=true>\n^:https<bracket=false onclick=gourl>\n^:fn<id=text>\n^:t\n^:x<id=text @=text bracket=false savelinepos=true>\n^:y<id=unique bracket=false savelinepos=true>\n^:connect<source=text target=text book=text>\n^:ln<from=text to=text pin=text>\n^:bb\n^:audio\n^:clip\n^:img\n^:sz\n^:sc\n^:missing\n^:misalign\n^:ff\n^:part\n^:vaggo\n^:errorpunc\n^:puncerror\n^:error\n^:doubt\n^:tofix\n^:add\n^:pg\n^:swap\n^:move\n^:baidu\n^:note\n^:miss\n^:person\n^:diff\n^:corr",cbeta:"^:ak<id=unique bracket=false>\n^:bk<id=unique heading=text bracket=false reset=ck,p>\n^:ck<id=unique heading=text bracket=false>\n^:https<bracket=false onclick=gourl>\n^:p<id=text>\n^:f<id=text>\n^:ver<savelinepos=true>\n^:fn<id=number>\n^:fm<id=text>\n^:k<id=text>\n^:j<@=link>\n^:v\n^:h\n^:mc\n^:l",cs:"^:ak<id=unique bracket=false>\n^:bk<id=unique heading=text bracket=false>\n^:ck<id=unique heading=text bracket=false>\n^:n<id=unique resetby=bk>\n^:p<id=number>\n^:ti<id=number heading=text bracket=false>\n^:f<id=number>\n^:h\n^:sz\n^:ckan\n^:cksn\n^:https<bracket=false onclick=gourl>\n^:t",zidian:"^:ak<id=unique bracket=false reset=ck>\n^:bk<id=unique heading=text bracket=false reset=n>\n^:ck<id=unique heading=text bracket=false>\n^:f<id=number>\n^:https<bracket=false onclick=gourl>\n^:j<@=link>\n^:o<@=link>\n",subtitle:"^:ak<id=unique bracket=false reset=n>\n^:bk<id=unique heading=text bracket=false reset=ck>\n^:ck<id=unique heading=text bracket=false>\n^:mpeg<id=text savelinepos=true>\n^:ts<id=range>\n^:ver<savelinepos=true>"},Ci=n=>{const t={};for(let e=0;e<n.length;e++){const i=n[e].match(/(\d+)\.(.+)/);if(!i)throw"invalid note "+n[e]+" filename:"+filename;if(t[i[1]]||(t[i[1]]={}),t[i[1]][i[2]])throw"repeat note "+n[e];t[i[1]][i[2]]=0}return t};function Oi(n,t){const e=Ci(t),i=n.footnote||"bk",s=this.typedefs[i],o=this.typedefs.i;for(let n=0;n<s.fields.id.values.length;n++){const t=s.fields.id.values[n],r=s.linepos[n],l=s.linepos[n+1],c=Qn(o.linepos,r);let a=Qn(o.linepos,l);if(o.linepos[c]<r)continue;(!a||o.linepos[a]<l)&&(a=o.linepos.length);const u=o.innertext.slice(c,a);for(let n=c;n<a;n++)o.fields.ln&&o.fields.ln.values[n]&&(u[n-c]=o.fields.ln.values[n]);for(let n=0;n<u.length;n++){let r=t,l=u[n],a=l.indexOf(".");a>0&&(r=l.slice(0,a),l=l.slice(a+1),l||(l=o.innertext[n+c])),e[r]?e[r].hasOwnProperty(l)?e[r][l]++:console.log(i+"#"+t,"not found",u[n],n):console.log("no such id",r,l,i,s.fields.id.values)}}}function Pi(n,t,e){if(!n.footnote)return;const i=n.footnote||"bk",s=this.typedefs[i],o=this.typedefs.f;var r,l;if(s)if(this.typedefs.i&&Oi.call(this,n,t),o)if("bk"==i){const i=s.fields.id.values.indexOf(n.name),c=s.linepos[i],a=s.linepos[i+1]||this.compiledLine,u=Qn(o.linepos,c);let d=Qn(o.linepos,a);if(o.linepos[u]>c){(!d||o.linepos[d]<a)&&(d=o.linepos.length);const n=o.fields.id.values.slice(u,d).sort(Xn);n.join()!==t.join()&&console.log(e,"footnote missing match",(l=n,(r=t).filter((n=>!l.includes(n))).concat(l.filter((n=>!r.includes(n))))),t.join())}}else{const n=Ci(t);for(let t in n){const e=n[t],r=s.fields.id.values.indexOf(t),l=s.linepos[r],c=s.linepos[r+1]||this.compiledLine,a=Qn(o.linepos,l);let u=Qn(o.linepos,c);const d=o.fields.id.values.slice(a,u).sort(Xn);for(let n=0;n<d.length;n++){const s=d[n];e.hasOwnProperty(s)?e[s]++:console.log("no note for ^f"+s,"in ^"+i+t)}}}else console.log("no f tag in source");else console.log("unknown tag",s,"checkfootnote")}function Ii(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}const Ti=(n,t="")=>{const e=n.indexOf("\n");let i,s=!0,o="",r="",l=!1,c=bi.Unknown;t&&(t.endsWith(".tsv")&&(c=bi.TSV),t.endsWith(".off")&&(c=bi.Offtext)),n=e>-1?n.slice(0,e):n;const[a,u]=Wn(n);if(u.length&&":"==u[0].name){var d;const n=u[0].attrs;n.hasOwnProperty("lazy")&&(s=!!n.lazy),c=(null===(d=u[0].attrs.type)||void 0===d?void 0:d.toLowerCase())||c,o=n.name,r=n.caption,l=!0,"tsv"==c&&(l=!1,s=!1),i=u[0]}return{sourcetype:c,tag:i,lazy:s,name:o,caption:r,consumed:l}};class _i{reset(n={}){this.compilingname="",this.line=0,this.compiledLine=0,this.compiledFiles={},this.primarykeys={},this.errors=[],this.typedefs={},this.stopcompile=!1,this.tagdefs=[],this.backtransclusions={},this.toc=[],this.zcount=0,this.prevzline=0,this.prevdepth=0}onError(n,t,e=-1,i){this.errors.push({name:this.compilingname,line:i||this.line,code:n,msg:t,refline:e}),this.errors.length>=3&&(this.stopcompile=!0)}setPredefine(n="generic"){const t=Ai[n]||"";this.compileOfftext(t,this.tagdefs)}compileOfftext(n,t){if(-1==n.indexOf("^"))return n;const e=new Kn(n);for(let i=0;i<e.tags.length;i++){const s=e.tags[i];let o=n.slice(s.offset,s.end);if(":"==s.name[0]&&s.name.length>1){const n=s.name.slice(1);this.typedefs[n]=new wi(s.attrs,n,this.primarykeys,this.typedefs),t.push(o)}else if("z"==s.name[0])gi.call(this,e,s);else if("y"==s.name[0])mi.call(this,e,s);else if("x"==s.name[0])$i.call(this,e,s);else if(":"!==s.name)if(s.name){const t=this.typedefs[s.name];if(t){const i=t.validateTag(e,s,this.line,this.compiledLine,this.compiledFiles,this.onError.bind(this));i&&(n=Dn(n,s,i))}else console.error("unknown tag\n",s.name)}else{const n=e.tagText(s,!0),[t,i]=Yn("^["+n+"]");this.backtransclusions[i]||(this.backtransclusions[i]=new Array),this.backtransclusions[i].push(this.compiledLine+this.line)}}return n}clearCompiled(n){delete this.compiledFiles[n]}compileBuffer(n,t){if(!n)return this.onError(Fe.Empty);if(!t)return this.onError(Fe.PtkNoName);let e=!1,i=Array(),s={};const o=new vt(n,{sequencial:!0}),r=o.first()||"",{sourcetype:l,tag:c,lazy:a,name:u,caption:d,consumed:f}=Ti(r,t);"txt"==l&&f&&i.push(r);let h=u||t,p=0;this.compilingname=t,this.stopcompile=!1;let g=Array();":"==(null==c?void 0:c.name)&&(c.attrs.ptk&&(this.ptkname&&this.ptkname!==c.attrs.ptk?this.onError(Fe.PtkNamed,this.ptkname):this.ptkname=c.attrs.ptk),"txt"!==c.attrs.type&&"0.off"!=t||this.setPredefine(c.attrs.define||c.attrs.template),s=c.attrs);const m=this.compiledLine;if(l===bi.TSV){var $;const[n,i]=Wn(r),s=(null===($=i[0])||void 0===$?void 0:$.attrs)||{},l=n.split("\t"),c=new ki({typedef:l,primarykeys:this.primarykeys,onError:this.onError.bind(this)}),[a,u]=c.fromStringArray(o,s,1,this.compiledFiles);s.hasOwnProperty("nocheck")||Pi.call(this,s,c.keys,t),p=u,a?(h=(null==s?void 0:s.name)||t,a.unshift(r),(null==s?void 0:s.name)&&(this.primarykeys[s.name]=c.keys),this.compiledLine+=a.length,g=a,p++,e=!0):g=[]}else if(l===bi.Offtext){const n=Array();let t=o.first();for(f&&(t=o.next()),this.line=0,Object.keys(i).length||this.setPredefine();t||""===t;){const e=this.compileOfftext(t,i);if((e||""==e)&&(n.push(e),this.line++),t=o.next(),this.stopcompile)break}this.compiledLine+=n.length,g=n}else{if(!h.endsWith(".num"))throw"unknown extension "+h;{let n=o.first();const t=Array();for(;n||""===n;){const e=pt(n.split(",").map((n=>parseInt(n||"0"))));if(t.push(e),n=o.next(),this.stopcompile)break}this.compiledLine+=t.length,p=t.length,g=t}}return this.compiledFiles[t]={name:h,caption:d,lazy:a,sourcetype:l,processed:g,textstart:p,errors:this.errors,samepage:e,tagdefs:i,attributes:s,linestart:m},this.compiledFiles[t]}constructor(n={}){Ii(this,"typedefs",void 0),Ii(this,"ptkname",void 0),Ii(this,"compilingname",void 0),Ii(this,"line",void 0),Ii(this,"compiledLine",void 0),Ii(this,"compiledFiles",void 0),Ii(this,"primarykeys",void 0),Ii(this,"errors",void 0),Ii(this,"stopcompile",void 0),Ii(this,"toc",void 0),Ii(this,"zcount",void 0),Ii(this,"prevzline",void 0),Ii(this,"prevdepth",void 0),Ii(this,"tagdefs",void 0),Ii(this,"backtransclusions",void 0),this.reset(n)}}function Si(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}class Ni{constructor(n){Si(this,"lines",void 0),Si(this,"depths",void 0),Si(this,"texts",void 0),this.lines=ut(n.shift()),this.depths=at(n.shift()),this.texts=new vt(n.shift())}}function Ei(n){for(let t=0;t<n.length;t++){const e=n[t],i=Array();if(!this.defines[e]){console.log("not such tag",e);continue}const s=this.defines[e].fields.id.values;for(let n=0;n<s.length;n++)i.push(s[n].split(/(\d+)/).filter((n=>!!n)).length);this.defines[e].depths=i}}const zi=()=>[],Li={};function Mi(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}((n,t)=>{Li[n]=t,t.getFilters||(t.getFilters=zi),t.runFilter||(t.runFilter=zi),t.getCorrespondence||(t.getCorrespondence=zi)})("generic",{});class ji extends je{async init(){var n;if(!this.payload)return;const t=new _i;t.compileBuffer(this.payload,"0.off"),this.defines=t.typedefs,this.attributes=null===(n=t.compiledFiles["0.off"])||void 0===n?void 0:n.attributes,this.lang=this.attributes.lang||"zh",this.template=Li[this.attributes.template]||Li.generic;const e=Array();for(let n=0;n<this.header.preload.length;n++){const t=this.sectionRange(this.header.preload[n]);t&&t[1]>t[0]&&e.push(t)}for(let n in this.defines)if(!this.defines[n].fields.lazy){const t=this.sectionRange("^"+n);t&&t[1]>t[0]&&e.push(t)}this.inmemory||await this.loadLines(e);for(let n=0;n<this.header.preload.length;n++){const t=this.getSection(this.header.preload[n]);t.length&&this.deserialize(t,this.header.preload[n])}for(const n in this.defines){if(!this.defines[n].fields.lazy){const t=this.getSection("^"+n);t&&t.length?this.defines[n].deserialize(t,this,n):this.defines[n].empty=!0}for(let t in this.defines[n].fields){const e=this.defines[n].fields[t];e.foreign&&this.primarykeys[e.foreign]&&(e.keys=this.primarykeys[e.foreign])}}for(const n in this.defines)this.defines[n].empty&&delete this.defines[n];for(const n in this.columns){var i;const t=null===(i=this.columns[n].attrs)||void 0===i?void 0:i.tagname;t&&this.defines[t]&&(this.defines[t].column=n)}}deserialize(n,t){if(!n.length)return;if(n[0]||n.shift(),!n.length)return;const e=n[0];Ti(e);const i=this.header.sectionnames.indexOf(t);if("tsv"===this.header.sectiontypes[i]){const t=new ki;t.deserialize(n),this.columns[t.name]=t,this.primarykeys[t.name]=t.keys}}typedefOf(n){return this.defines[n]}getSectionStart(n){const t=this.header.sectionnames.indexOf(n);return~t?this.header.sectionstarts[t]:-1}getSectionName(n){const t=Qn(this.header.sectionstarts,n+1)-1;return this.header.sectionnames[t]}constructor(n){super(n),Mi(this,"defines",void 0),Mi(this,"primarykeys",void 0),Mi(this,"columns",void 0),Mi(this,"attributes",void 0),Mi(this,"tocs",void 0),Mi(this,"rangeOfAddress",void 0),Mi(this,"tagAtAction",void 0),Mi(this,"innertext",void 0),Mi(this,"inverted",void 0),Mi(this,"lang",void 0),Mi(this,"template",void 0),this.defines={},this.attributes={},this.primarykeys={},this.columns={},this.inverted=null,this.lang=""}}const Fi=new WebAssembly.Instance(new WebAssembly.Module(Uint8Array.from(atob("AGFzbQEAAAABCgJgAABgAn9/AXwDAwIAAQUDAQACBwkCAW0CAAFjAAEIAQAKlQECSQEDfwNAIAEhAEEAIQIDQCAAQQF2IABBAXFBoIbi7X5scyEAIAJBAWoiAkEIRw0ACyABQQJ0IAA2AgAgAUEBaiIBQYACRw0ACwtJAQF/IAFBf3MhAUGAgAQhAkGAgAQgAGohAANAIAFB/wFxIAItAABzQQJ0KAIAIAFBCHZzIQEgAkEBaiICIABJDQALIAFBf3O4Cw"),(n=>n.charCodeAt(0))))),{c:Bi,m:qi}=Fi.exports;var Ri;(Ri=qi,new Uint8Array(Ri.buffer||Ri)).subarray(65536);var Hi=function(n){return n[n.fileHeaderSignature=1347093252]="fileHeaderSignature",n[n.descriptorSignature=1347094280]="descriptorSignature",n[n.centralHeaderSignature=1347092738]="centralHeaderSignature",n[n.endSignature=1347093766]="endSignature",n[n.fileHeaderLength=30]="fileHeaderLength",n[n.centralHeaderLength=46]="centralHeaderLength",n[n.endLength=22]="endLength",n[n.descriptorLength=16]="descriptorLength",n}({});function Ui(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}class Wi{loadFiles(n,t,e){const i=this.zipbuf.length-Hi.endLength-t,s=new DataView(this.zipbuf.buffer);let o=i;for(let t=0;t<n;t++){if(s.getUint32(o)!==Hi.centralHeaderSignature)break;const n=s.getUint32(o+20,!0),r=s.getUint16(o+28,!0),l=s.getUint16(o+30,!0),c=s.getUint16(o+32,!0);let a=s.getUint32(o+42,!0);o+=Hi.centralHeaderLength;const u=this.zipbuf.subarray(o,o+r),d=(new TextDecoder).decode(u);let f;o+=r,o+=l+c,0===t&&(this.zipStart=a),a+=Hi.fileHeaderLength+r;const h=e-i;a-h>=0&&(f=this.zipbuf.subarray(a-h,a-h+n)),this.files.push({name:d,offset:a,size:n,content:f})}}find(n){for(let t=0;t<this.files.length;t++)if(this.files[t].name==n)return this.files[t]}loadEndRecord(){const n={signature:0,fileCount:0,centralSize:0,centralOffset:0},t=new DataView(this.zipbuf.buffer),e=this.zipbuf.length-Hi.endLength;if(n.signature=t.getUint32(e),n.signature!==Hi.endSignature)throw console.log("endrecord signature",n.signature,"zipbuf length",this.zipbuf.length),"wrong endRecord signature";return n.fileCount=t.getUint16(e+8,!0),n.centralSize=t.getUint32(e+12,!0),n.centralOffset=t.getUint32(e+16,!0),n}constructor(n){Ui(this,"zipbuf",void 0),Ui(this,"files",void 0),Ui(this,"zipStart",void 0),n instanceof ArrayBuffer&&(n=new Uint8Array(n)),this.zipbuf=n instanceof Uint8Array?n:new Uint8Array(n.buffer),this.files=[],this.zipStart=0;const{fileCount:t,centralSize:e,centralOffset:i}=this.loadEndRecord();t&&this.loadFiles(t,e,i)}}const Di=async(n,t=null)=>{let e=Ki(n);if(e)return e;if(!n)return null;const i={name:n};if(t&&(i.zipstore=new Wi(t)),e=new ji(i),((n,t)=>{ye[n]=t})(n,e),await e.isReady())return await e.init(),e;we(n)},Ki=n=>n?xe(n):null,Ji=n=>n.replace(/【([^】]*)】/g,((n,t)=>"【"+"-".repeat(t.length)+"】")),Yi=async(n,t)=>{const{choff:e,lineoff:i,action:s}=He(t),[o,r]=n.rangeOfAddress(s);if(!r)return{};const l=n.defines.folio;let c=Qn(n.defines.folio.linepos,o+1)-1;-1==c&&(c=0);const a=Qn(n.defines.ck.linepos,o+1)-1,u=l.fields.id.values[c];if(!u)return{};const d=n.defines.ck.fields.id.values[a],f=new Qi(n);await f.load(u);const[h,p,g]=f.toFolioPos(d,i,e);return{id:u,pb:h,line:p,ch:g}};class Qi{toFolioPos(n="1",t=0,e=0){const[i,s]=this.chunkRange(n),o=this.offtext.slice(i,s);let r=0;for(;t>0&&r<o.length;)"\n"==o.charAt(r)&&t--,r++;const l=i+r+e,c=Qn(this.pbpos,l+e+1)-1,[a,u]=this.pbRange(this.pbs[c]),d=Math.min(l,u);let f=this.offtext.slice(a,d);"^lb"==this.offtext.slice(d,d+3)&&(f+="^lb");const h=f.split("^lb"),p=h.length,g=this.countFolioChar(h[h.length-1]);return[this.pbs[c],p-1,g]}folioPageText(n){const[t,e]=this.pbRange(n);return(i=this.offtext.slice(t,e).split("\n"))&&i.length?(i[0].match(/(\^pb\d+)/),Ji(i.join("\t")).replace(/(..)\^pb/g,"$1^lb^pb").split("^lb")):[];var i}countFolioChar(n){return(n=>{let t=0,e="",i=0;const s=()=>{t&&"【"==e[0]&&(e=e.replace(/【([^】]*)】/,((n,t)=>"【"+"-".repeat(t.length)+"】")));const n=En(e);let s=0;for(;s<n.length;)(Pn(n[s])||"　"==n[s])&&i++,s++};return n.replace(vn,((i,o,r,l)=>{e=n.slice(t,l),s(),t=l+i.length})),e=n.slice(t),s(),i})(n)}skipFolioChar(n,t){if(!n)return 0;let e=0,i=0,s="";const o=()=>{e&&"【"==s[0]&&(s=s.replace(/【([^】]*)】/,((n,t)=>"【"+"-".repeat(t.length)+"】")));const n=En(s);let o=0;for(;t>-1&&o<n.length;){(Pn(n[o])||"　"==n[o])&&t--,t>=0&&(i+=n[o].codePointAt(0)>=131072?2:1),o++}};let r=0;return n.replace(vn,((i,l,c,a)=>{s=n.slice(e,a),o(),t<=0||(e=a+i.length,r+=i.length)})),s=n.slice(e),o(),i+r}fromFolioPos(n,t=0,e=0){let i=n;"object"==typeof n&&([i,t,e]=n);const[s,o]=this.pbRange(i),r=Ji(this.offtext.slice(s,o)),l=r.split("^lb");let c=s||0;for(let n=0;n<t;n++){var a;c+=((null===(a=l[n])||void 0===a?void 0:a.length)||0)+(n>0?3:0)}c+=this.skipFolioChar(r.slice(c-s),e);let u=Qn(this.chunkpos,c+1)-1;const d=this.chunks[u<0?0:u],[f,h]=this.chunkRange(d),p=this.offtext.slice(f,h).split("\n");let g=f||0,m=0,$=0,v=0;for(v=0;v<p.length;v++){if(g+p[v].length>=c){$=c-g;break}m++,g+=p[v].length+1}const k=this.from+this.chunklinepos[u]+m,b=this.chunklinepos[u+1]-this.chunklinepos[u],y=Qn(this.ptk.defines.ck.linepos,k+1)-1,x=this.ptk.getChunk(y+1);return{ckid:d,lineoff:m,choff:$,linetext:p[v]||"",ptkline:k,linecount:b,at:y,ck:x}}chunkRange(n){const t=this.chunks.indexOf(n);return-1==t?[0,0]:[this.chunkpos[t],this.chunkpos[t+1]]}chunkText(n){const[t,e]=this.chunkRange(n);return this.offtext.slice(t,e)}pbRange(n){"number"==typeof n&&(n=n.toString());const t=this.pbs.indexOf(n);return-1==t?[0,0]:[this.pbpos[t],this.pbpos[t+1]]}async load(n){const t=this.ptk;let e,i,s="",o=n;n.match(/\d$/)?s=n.replace(/\d+$/g,""):(o="",s=n);const r=(s?"bk#"+s:"")+(o?".":"")+(o?"folio#"+o:"");if([e,i]=t.rangeOfAddress(r),e==i)return["",e,i];await t.loadLines([e,i]),this.folio=o,this.offtext=t.slice(e,i).join("\n"),this.from=e,this.to=i;let l=0,c=0;for(;l<this.offtext.length;){const n=this.offtext.slice(l,l+3);if("^pb"==n){this.pbpos.push(l),l+=3;const n=this.offtext.slice(l).match(/([\d]+)/);this.pbs.push(n[1]),l+=n[1].length}else if("^ck"==n){this.chunkpos.push(l),l+=3,"#"==this.offtext.charAt(l)&&l++;const n=this.offtext.slice(l).match(/([a-z\d]+)/);this.chunks.push(n[1]),this.chunklinepos.push(c),l+=n[1].length}else"\n"==n[0]&&c++,l++}this.pbpos.push(this.offtext.length-1),this.chunkpos.push(this.offtext.length-1),this.chunklinepos.push(c+1)}constructor(n){this.ptk=n,this.offtext="",this.pbs=[],this.pbpos=[],this.chunks=[],this.chunkpos=[],this.chunklinepos=[],this.ck=n.defines.ck}}const Vi=(n,t,e)=>{const i=n.columns[t];if(!i||!i.keys)return[-1,""];const s=i.keys.indexOf(e);if(-1==s)return[-1,""];const o=i.dkat[s],[r,l]=n.rangeOfAddress("bk#"+t+".dk#"+o);return[o,n.slice(r,l).join("\n"),t]},Gi=(n,t,e)=>{if(!e)return[-1,""];if(t)return Vi(n,t,e);{let t,i;for(let s of Object.keys(n.columns))if([t,i]=Vi(n,s,e),t>-1)return[t,i,s];return[-1,""]}},Xi=/@(.+)$/,Zi=(n,t,e="")=>((n,t,e)=>{let[i,s,o]=Gi(n,t,e),r=s.match(Xi);for(;r&&(s="",e=r[1],r);)[i,s]=Gi(n,t,r[1]),r=s.match(/@([^ <>\[\]\{\}]+)$/);return[s,[{key:e}],i,0]})(n,e,t);function ns(n){let t,[e,i]=Gi(this,"",n),s=n;for(;t=i.match(Xi);)s=t[1],[e,i]=Gi(this,"",s);return s}function ts(n,t,e){const i=this.columns[n],s=i.fieldnames.indexOf(t);return i.fieldvalues[s][e]}async function es(n,t){const e=this.defines[n],i=this.columns[e.fields.type.foreign];if(!i)return;const s=i.findKey(t),o=e.attrs.text,r=i.fieldnames.indexOf(o),l=i.fieldvalues[r];return l&&l[s]||""}function is(n,t,e=-1){const i=this.columns[n];"string"==typeof e&&(e=i.fieldnames.indexOf(e));const s=[];if(e>0)s.push({name:name,typedef:i.fieldsdef[e],value:i.fieldvalues[e][t]});else for(let n=0;n<i.fieldnames.length;n++){const e=i.fieldnames[n];s.push({name:e,typedef:i.fieldsdef[n],value:i.fieldvalues[n][t]})}return s}const ss=(n,t,e)=>n+":"+t+"="+e;function os(n,t,e){const i=St(e);let s=ss(n,t,e),o=this.scanCache[s];if(o||i===e||(o=this.scanCache[ss(n,t,i)]),!o){const r=this.columns[n][t];if(!r)return console.log("missing field",t,"in column",n),null;let l=et(r,e);l.length||i===e||(l=et(r,i),l.length&&(s=ss(n,t,i)));o={name:n,field:t,caption:this.columns[n].caption||n,contain:l},this.scanCache[s]=o}return o}function rs(n){const t=[];if(!n)return[];for(let e in this.columns){if(!this.columns[e].attrs.scan)continue;const i=this.columns[e].attrs.scan.split(",");for(let s=0;s<i.length;s++){const o=os.call(this,e,i[s],n);t.push(o)}}for(let e in this.primarykeys){if(!this.columns[e].attrs.bme)continue;const i=e+"="+n;let s=this.scanCache[i];if(!s){const t=this.primarykeys[e],o=t.enumStart(n),r=t.enumMiddle(n),l=t.enumEnd(n);s={name:e,caption:this.columns[e].caption||e,start:o,middle:r,end:l},this.scanCache[i]=s}t.push(s)}return t}function ls(n,t){const e=this,i=function(n,t,e){const i=n.nearestChunk(e),s=n.defines.fn;if(~n.findClosestTag(s,"id",t,e))return n.name+":bk#"+i.bk.id+".fm"+t}(e,n,t);if(i)return i;const s=e.nearestChunk(t),o=e.defines.ck,r=e.defines.bk,l="fn_"+s.bkid,c=r.fields.id.values.indexOf(l);if(-1==c)return e.name+":"+s.bk.id+".fm"+n;const a=r.linepos[c],u=e.findClosestTag(o,"id",s.id,a),d=o.fields.id.values[u];return e.name+":"+l+".ck"+(parseInt(d)?d:"#"+d)+".fn"+n}function cs(n,t){const e=this;let i="",s=!1;if(!n)return"";if(n&&~n.indexOf(".")?(i=e.getChunk(n.slice(0,n.indexOf("."))),s=!0):i=e.nearestChunk(t),!i)return"";let o=i.bkid+"-note",r=e.columns[o];if(r||(o=i.bkid,r=e.columns[o]),!r)return"--no note--";"ck"!=r.attrs.footnote||s||(n=i.id+"."+n);let l=r.fieldByKey(n,"note")||"";if(!l){const t=i.id+"."+n;l=Vi(e,o,t)[1]}return l}function as(n,t){const e=this,i=e.nearestChunk(t),s=e.defines.ck,o=e.defines.ck,r=e.defines.f;let l=i.bkid.replace("_fn","");const c=o.fields.id.values.indexOf(l);0==c?l="":l+=".";const a=o.linepos[c],u=e.findClosestTag(s,"id",i.id,a),d=s.fields.id.values[u],f=e.findClosestTag(r,"id",parseInt(n),s.linepos[u]),h=r.linepos[f]-s.linepos[u];return l+"ck"+d+(h?":"+h:"")}const us=n=>{let t=n;const e=n.lastIndexOf("_");return~e&&(t=n.slice(0,e)),t};function ds(n,t,e=!1){const i=n.nearestChunk(t+1);if(!i)return[];const s=this.defines.bk,o=this.getParallelBook(i.bkid,e).map((n=>s.fields.id.values.indexOf(n))),r=t-n.defines.bk.linepos[i.bkat],l=[];for(let n=0;n<o.length;n++){const t=s.fields.id.values[o[n]],[e,c]=this.rangeOfAddress("bk#"+t+".ck#"+i.id),a=s.linepos[o[n]],u=a+r;u<=c&&l.push([this,e-a,u])}return l}function hs(n,t){if("number"==typeof n&&(n=this.defines.bk.fields.id.values[n]),!n)return[];const e=us(n);return this.defines.bk.fields.id.values.filter((i=>us(i)==e&&(t||n!==i)))}function ps(n,t){const e=this.defines[n],i=null==e?void 0:e.linepos;if(!e||!i)return[];const s=Qn(i,t),o=e.fields.id.values[s].toString(),r=[];for(let t in this.foreignlinks){const e=xe(t),i=this.foreignlinks[t];for(let s=0;s<i.length;s++){const[l,c,a,u,d]=i[s];if(a!==n)continue;const f=e.defines[l].linepos,h=u.find(o),p=this.defines[l].fields["@"].values,g=d[h];for(let n=0;n<(null==g?void 0:g.length);n++){const i=p[g[n]],s=f[g[n]],o=e.nearestChunk(s+1);r.push({text:i,line:s,ck:o,basket:t})}}}return r}function gs(n){const t=this,e=t.rangeOfAddress(n),i=t.nearestChunk(e[0]+1);if(!i)return[];const s="bk#"+i.bkid+".ck#"+i.id,o=Ce(t),r=[t.header.name];for(let n=0;n<o.length;n++){const t=xe(o[n]),[e,i]=t.rangeOfAddress(s);i>0&&r.push(o[n])}return r}function ms(n,t,e,i,s,o){t||(t="*"),this.backlinks[t]||(this.backlinks[t]={}),this.backlinks[t][this.name]||(this.backlinks[t][this.name]=[]),this.backlinks[t][this.name].push([n,e,i,s,o])}function $s(n){for(let t in n.backlinks)if(t==this.name||"*"===t)for(let e in n.backlinks[t])this.foreignlinks[e]=n.backlinks[t][e]}function vs(n,t){const e=this.LocalBackLinks[n];return e&&e[t]||[]}function ks(n){const t=this;if(!t.backtransclusions)return[];const e=t.keyOfEntry(n);return(t.backtransclusions[e]||[]).map((n=>((n,t,e=!1)=>{const i=[];for(let e of Object.keys(n.columns)){const s=n.columns[e];if(s.dkat)for(let o=0;o<s.dkat.length;o++){const[r,l]=n.rangeOfAddress("bk#"+e+".dk#"+s.dkat[o]);n.slice(r,l).join("\n").endsWith("@"+t)&&i.push(s.keys.get(o))}}return 0==i.length?t:e?i[0]||"":i})(t,n,!0))).filter((n=>!!n))}function bs(n){const t=(n=_n(n)).match(zn);if(t)return this.BookIdByName[t[1]]}function ys(n){const t=this.getTagById("bk",n);return this.defines.bk.getInnertext(null==t?void 0:t.at)}const xs=(n,t,e)=>{if(Object.keys(n.columns),e&&n.columns[e]){const i=n.columns[e].dkat.indexOf(parseInt(t));if(~i)return n.columns[e].keys.get(i)}else for(let e in n.columns){var i;const s=null===(i=n.columns[e].dkat)||void 0===i?void 0:i.indexOf(t);if(~s)return n.columns[e].keys.get(s)}return""};const ws=n=>{n.BookIdByName={},n.BookNameById={},n.guessBookId=bs,n.bookNameById=ys,n.backLinksOf=vs,n.backTransclusionOf=ks,n.keyOfEntry=ns,(n=>{var t;for(let e=0;e<(null===(t=n.defines.bk)||void 0===t?void 0:t.linepos.length);e++){const t=n.defines.bk.fields.id.values[e],i=n.defines.bk.getInnertext(e);i&&(n.BookIdByName[i]=t,n.BookIdByName[_t(i)]=t,n.BookNameById[t]=i)}})(n),n.LocalBackLinks=function(n){const t=n.defines.x,e=n.defines.y,i={};if(!t||!e)return;const s=t.fields.id.values,o=n.defines.x.linepos;for(let e=0;e<s.length;e++){let[r,l,c]=Jn(s[e]);if(!l){const i=t.getInnertext(e);l=bs.call(n,i)}const a=n.nearestTag(o[e],"bk","id");l||(l=a);const u="bk#"+l+".y#"+r,[d,f]=n.rangeOfAddress(u);i[l]||(i[l]={}),i[l][d+c]||(i[l][d+c]=[]),i[l][d+c].push(o[e])}return i}(n),n.backtransclusions=function(n){const t=n.getSection("_backtransclusions");if(!t.length)return{};const e={},i=new vt(t.shift(),{sep:$t}),s=n.defines.dk;if(!s)return e;for(let o=0;o<i.len();o++){const r=ut(t.shift()),l=[];for(let t=0;t<r.length;t++){const e=s.linepos.indexOf(r[t]);if(~e){const i=n.nearestTag(r[t],"bk","id"),o=s.fields.id.values[e],c=xs(n,o,i);c&&l.push(c)}}const[c,a]=Zi(n,i.get(o)),u=a[0].key;e[u]?(e[u].concat(l),e[u].sort()):e[u]=l}return e}(n)};function As(n){return Ft(n,this.inverted.tokenlinepos)[0]}const Cs=n=>{const t=n.getSection("toc");if(n.attributes.toctag&&t&&t.length>1){const e=t.shift(),{name:i}=Ti(e);n.tocs||(n.tocs={}),n.tocs[i||"*"]=new Ni(t,i);const s=n.attributes.toctag.split(",");Ei.call(n,s)}};function Os(n,t=!1){var e,i;const s=this.defines.ck;let o=null==s?void 0:s.getInnertext(n);const r=null==s||null===(i=s.fields)||void 0===i||null===(e=i.id)||void 0===e?void 0:e.values[n],l=this.template.onChunkCaption;var c,a;o||(o=(null===(a=this.columns[null==s?void 0:s.column])||void 0===a||null===(c=a.keys)||void 0===c?void 0:c.get(n))||"",!o&&l&&(o=l(r)));const u=null==o?void 0:o.indexOf(";");let d=o||"";return~u&&(d=o.slice(u),o=o.slice(0,u)),t?d:o}function Ps(n){let t=this.getCaption(n),e=0;for(;t&&t.endsWith("-");)e++,t=t.slice(0,t.length-1);let i=n,s=[];for(;i>0&&e;){i--;const n=this.getCaption(i).split(/[- ]+/),t=n.length;for(;!n[n.length-1];)n.pop();if(t-1>e);else if(n.length>1||1==t)for(;n.length&&e;)s.unshift("-"+n.pop()),e--}return t+s.join("")}function Is(n){const t=this.defines.ck||this.defines.dk,e=this.nearestTag(n,t);return this.getChunk(e)}function Ts(n){var t,e;if(!n)return"";const i=this.defines.ck,s=this.defines.bk,o=(null==i?void 0:i.linepos)||[],r=Qn(o,n+1)-1,l=n-o[r],c=null==i||null===(e=i.fields)||void 0===e||null===(t=e.id)||void 0===t?void 0:t.values[r],a=this.nearestTag(n+1,s),u=_s.call(this,a),d=null==u?void 0:u.id;return{id:c,tagname:"ck",caption:this.caption(r),lineoff:l,bk:u,bkid:d}}function _s(n){var t;const e=this.defines.bk,i=e.fields.id.values[n];let s=null==e?void 0:e.getInnertext(n),o=s.slice(0,2);const r=(null==e||null===(t=e.fields.heading)||void 0===t?void 0:t.values[n])||(null==e?void 0:e.getInnertext(n)),l=s.indexOf(";");return~l&&(o=s.slice(l+1),s=s.slice(0,l)),{id:i,caption:s,short:o,heading:r,at:n}}function Ss(n){n=parseInt(n);const t=this.defines.ck||this.defines.dk,e=this.defines.bk;if(n<0)return null;if(n>=t.fields.id.values.length)return null;const i=t.linepos[n],s=this.nearestTag(i+1,e),o=_s.call(this,s),r=o.id,l=t.fields.id.values[n],c=t.getInnertext(n);return{bk:o,bkid:r,bkat:s,caption:this.caption(n),at:n,id:l,depth:t.depths&&t.depths[n]||1,line:t.linepos[n],lineend:t.linepos[n+1]||-1,innertext:c}}function Ns(n,t){const e=this.defines.ck;if(!e.depths)return[];let i=e.linepos[n],s=e.depths[n];const o=[];for(;i>t&&s>1;)s>e.depths[n]&&(o.unshift(n),s--),n--,i=e.linepos[n];return o}function Es(n,t){let e=n-1;const i=this.defines.ck;if(!i.depths&&n>0)return n-1;for(;e>0;){if(i.depths[e]==i.depths[n])return e;if(i.depths[e]<i.depths[n])break;if(e--,t<i.linepos[e])break}return-1}function zs(n,t){let e=n+1;const i=this.defines.ck;if(!i.depths&&n<t)return n+1;for(;e<i.linepos.length;){if(i.depths[e]==i.depths[n])return e;if(i.depths[e]<i.depths[n])break;if(e++,i.linepos[e]>=t)break}return-1}function Ls(n){const t=this.defines.ck;return t.depths&&t.depths[n+1]==t.depths[n]+1?n+1:-1}function Ms(n){const t=this,e=this.defines[((n,t)=>{for(let i in n.defines){var e;if((null===(e=n.defines[i].attrs.reset)||void 0===e?void 0:e.split(",").indexOf(t))>-1)return i}return null})(this,"ck")],i=e?this.nearestTag(n,e)-1:0,s=e?e.linepos[i]:0,o=e&&e.linepos[i+1]||t.header.eot,r=Ns.call(this,n,s),l=r.map((n=>t.getChunk.call(t,n))),c=Es.call(this,n);c>-1&&(!r.length||r[r.length-1]<c)&&l.push(this.getChunk(c)),l.push(this.getChunk(n));const a=Ls.call(this,n,s);a>-1&&l.push(this.getChunk(a));const u=zs.call(this,n,o);return u>-1&&l.push(this.getChunk(u)),l}function js(n,t="zh"){let e=this.attributes[t]||this.name;const i=e.indexOf("|");return-1==i?e:n?e.slice(0,i):e.slice(i+1)}const Fs=n=>{(n=>{n.innertext=Je,n.humanName=js,n.fetchAddress=De,n.fetchAddressExtra=Ke,n.findClosestTag=ti,n.validId=ei,n.nearestTag=ni,n.getTagFields=si,n.queryTagFields=ii,n.tagInRange=Xe,n.tagCount=Ze,n.fetchTag=Ge,n.getTagById=Ve,n.rangeOfAddress=We,n.rangeOfElementId=Ue,n.nearestChunk=Is,n.getChunk=Ss,n.neighborChunks=Ms,n.getCaption=Os,n.getHeading=Ts,n.caption=Ps,n.alignable=oi})(n),Cs(n),(n=>{const t=n.getSection("_tokens");if(!n.inverted&&t&&t.length){t.shift();const e=n.sectionRange("_postings")[0];n.queryCache={},n.inverted=new Nt(t,e),n.loadPostings=Rt,n.loadPostingsSync=Bt,n.getPostings=qt,n.postingline=As,n.searchSentenceSync=me,n.searchSentence=ge,n.parseQuery=ue,n.scanText=de,n.hitsOfLine=fe,n.scoreLine=le}})(n),ws(n),(n=>{n.inlineNote=es,n.footNoteAddress=ls,n.footNoteByAddress=as,n.footNoteInTSV=cs})(n),n.scanColumnFields=rs,n.searchColumnField=os,n.tagAtAction=Qe,n.scanCache={},n.queryCache={},n.columnField=ts,n.foreignLinksAtTag=ps,n.getParallelBook=hs,n.getParallelLine=ds,n.enumParallelsPtk=gs,n.taggedLines={},n.foreignlinks={},n.addForeignLinks=$s,n.addBacklinks=ms,n.backlinks={},n.rowOf=is,n.parallels={}},Bs=async(n,t,e,i={})=>{const s=((n,t,e=!1,i=!0,s=!1)=>{const o=[];if(!n)return o;const r=n.nearestTag(t+1,"bk"),l=n.defines.bk.linepos[r];e&&o.push([n,l,t]);const c=t-l,a=n.defines.bk.fields.id.values[r],u=n.getParallelBook(a);if(n.rangeOfAddress("bk#"+a),i)for(let t=0;t<u.length;t++){const[e,i]=n.rangeOfAddress("bk#"+u[t]);c<=i-e&&o.push([n,e-l,e+c])}if(s){const e=Ce(n);for(let i=0;i<e.length;i++)Ki(e[i]).getParallelLine(n,t,!0).forEach((n=>o.push([...n])))}return o})(n,t,!0,i.local,i.remote),o=[];for(let n=0;n<s.length;n++){const[t,e,i]=s[n];await t.loadLines([i]);const r=t.getLine(i),l=t.getHeading(i);o.push({ptk:t,heading:l,linetext:r,line:i})}return e&&e.push(...o),o};"undefined"!=typeof process&&(process.env,process.stdout&&process.stdout.isTTY);const qs=n=>`left:${n.left}px;width:${n.width}px;top:${n.top}px;height:${n.height}px`,Rs="YLZ.",Hs=()=>{for(let n in Ws)localStorage.setItem(n,Ws[n]),delete Ws[n];clearTimeout(Us)};let Us;const Ws={},Ds=n=>{let t,e=!1;for(let i in n)if(n.hasOwnProperty(i)&&Ks[i]!==n[i]){let s=n[i];"object"==typeof s&&(s=JSON.stringify(n[i]),t=JSON.stringify(localStorage.getItem(i))),s!==t&&(Ws[Rs+i]=s,"object"==typeof n[i]?Ks[i]=JSON.parse(JSON.stringify(n[i])):Ks[i]=n[i],e=!0)}e&&(clearTimeout(Us),Us=setTimeout(Hs,5e3))},Ks=(()=>{const n=localStorage.getItem(Rs+"autodict")||"off",t=localStorage.getItem(Rs+"newbie")||"on",e=localStorage.getItem(Rs+"playnextjuan")||"on",i=localStorage.getItem(Rs+"showpunc")||"on",s=localStorage.getItem(Rs+"showsponsor")||"off",o=localStorage.getItem(Rs+"showyoutube")||"off",r=parseFloat(localStorage.getItem(Rs+"heightratio")||"1")||1,l=parseInt(localStorage.getItem(Rs+"textsize")||"150")||150,c=parseInt(localStorage.getItem(Rs+"playrate")||"100")||100,a=localStorage.getItem(Rs+"vip")||"",u=localStorage.getItem(Rs+"tosim")||"0";let d=localStorage.getItem(Rs+"favorites")||"{}",f=localStorage.getItem(Rs+"preferaudio")||"{}",h=localStorage.getItem(Rs+"tofindhistory")||'["淨信",""]',p={},g={},m=[];try{p=JSON.parse(d),g=JSON.parse(f),m=JSON.parse(h)}catch(n){console.log(n),p={},g={}}return{tosim:u,vip:a,activefolioid:"pphs",heightratio:r,tofindhistory:m,playrate:c,textsize:l,showsponsor:s,showyoutube:o,autodict:n,newbie:t,favorites:p,playnextjuan:e,preferaudio:g,showpunc:i}})(),Js=[];function Ys(t,e=n){let i;const s=new Set;function o(n){if(r(t,n)&&(t=n,i)){const n=!Js.length;for(const n of s)n[1](),Js.push(n,t);if(n){for(let n=0;n<Js.length;n+=2)Js[n][0](Js[n+1]);Js.length=0}}}function l(n){o(n(t))}return{set:o,update:l,subscribe:function(r,c=n){const a=[r,c];return s.add(a),1===s.size&&(i=e(o,l)||n),r(t),()=>{s.delete(a),0===s.size&&i&&(i(),i=null)}}}}const Qs="v1::ylz",Vs="25.5.10";let Gs;const Xs={vid:"",performer:"-靜默-"},Zs="/baudio/",no=n=>{Gs=n},to=async(n,t,e=!1)=>{let i=[];if(!Gs)return i;const s=Gs.columns.timestamp;if(!s)return i;const o=await caches.open(Qs),r=(await o.keys()).map((n=>n.url.slice(window.location.origin.length+8).replace(".mp3","")));for(let t=0;t<s.keys.len();t++){const o=s.keys.get(t),l=s.videohost[t];let c=s.performer[t],a="";const u=c.indexOf("|");~u&&(e&&(a=c.slice(u+1)),c=c.slice(0,u));const d=s.timestamp[t],f=s.bookid[t],h=1-!~r.indexOf(o.replace(/\^\d+$/,""));n==f&&i.push({aid:o,performer:c,youtube:a,incache:h,bookid:f,timestamp:d,audiohost:l})}i.sort(((n,t)=>n.performer==t.performer?0:n.performer<t.performer?-1:1));const l=i.filter((n=>!n.incache)).concat();return i=i.filter((n=>n.incache)).concat(l),i.unshift(Xs),t&&t.set(i),i},eo=Ys(navigator.onLine),io=Ys(null),so=Ys("ylz-prjn"),oo=Ys({}),ro=Ys(!1),lo=Ys(!1),co=Ys(Ks.autodict),ao=Ys("1"),uo=Ys(Ks.activefolioid),fo=Ys(0),ho=Ys(0),po=Ys(!1),go=Ys(Ks.favorites),mo=Ys(Ks.preferaudio),$o=Ys(Ks.showpunc),vo=Ys(Ks.showsponsor),ko=Ys(Ks.showyoutube),bo=Ys(!1),yo=Ys(!1),xo=Ys(""),wo=Ys("folio"),Ao=Ys(null),Co=Ys(""),Oo=Ys(Ks.tofindhistory),Po=Ys(Ks.heightratio),Io=Ys(Ks.textsize),To=Ys(Ks.vip),_o=Ys(Ks.tosim),So=Ys(!0),No=Ys(Ks.playrate);let Eo;const zo=Ys([Xs]),Lo=Ys(""),Mo=(n,t)=>{if(t){const t=dc.defines.folio,e=dc.defines.bk,i=t.fields.id.values.indexOf(n);if(!~i)return"";const s=t.linepos[i]+1,o=Qn(e.linepos,s)-1;return e.fields.id.values[o]}return n.replace(/\d+$/,"")},jo=Ys(""),Fo=()=>Ki(f(so)),Bo=function(n){var t;const e=Ki(f(so)),i=n||f(uo),s=null===(t=e.defines.folio.fields.id)||void 0===t?void 0:t.values.indexOf(i);return~s&&e.defines.folio.fields.lines.values[s]||5},qo=Ys(17),Ro=Ys(!1),Ho=Ys(!1),Uo=Ys(Ks.playnextjuan),Wo=Ys(["2",0,0]),Do=Ys(-1),Ko=Ys(Ks.newbie),Jo=Ys(0),Yo=Ys(!1),Qo=["ylz-prjn","ylz-tg","ylz_sanskrit","ylz-rite","dc"],Vo=["ylz-prjn","ylz-tg","ylz-svk","ylz-vny","ylz-rite","ylz_sanskrit","dc"],Go=Ys(!1);uo.subscribe((n=>Ds({activefolioid:n}))),co.subscribe((n=>Ds({autodict:n}))),Ko.subscribe((n=>Ds({newbie:n}))),$o.subscribe((n=>Ds({showpunc:n}))),vo.subscribe((n=>Ds({showsponsor:n}))),ko.subscribe((n=>Ds({showyoutube:n}))),go.subscribe((n=>Ds({favorites:n}))),No.subscribe((n=>Ds({playrate:n}))),mo.subscribe((n=>Ds({preferaudio:n}))),Oo.subscribe((n=>Ds({tofindhistory:n}))),Po.subscribe((n=>Ds({heightratio:n}))),_o.subscribe((n=>Ds({tosim:n}))),Go.subscribe((n=>{Ds({reverseswipe:n})})),Io.subscribe((n=>{const t=(n/100).toFixed(2)+"em";document.documentElement.style.setProperty("--textsize",t),Ds({textsize:n})})),To.subscribe((n=>Ds({vip:n})));const Xo=(n,t="timestamp")=>{const e=Ki("dc");if(!e.columns[t])return null;return{id:n,...e.columns[t].fieldsByKey(n)}},Zo=()=>{Eo&&Eo.paused&&(null==Eo||Eo.pause()),Ro.set(!1),Do.set(-1)},nr=n=>{const t=Ki("ylz_sanskrit"),e=n.indexOf("_");return~e&&(n=n.slice(0,e)),~t.defines.bk.fields.id.values.indexOf(n+"_variorum")},tr=n=>{const t=Ki("ylz_sanskrit"),e=n.indexOf("_");~e&&(n=n.slice(0,e));return~t.defines.bk.fields.id.values.indexOf(n)},er=(n,t)=>n.getParallelBook(t).length,ir=(n,t=0,e=0)=>{"string"!=typeof n&&(t=n[1],e=n[2],n=n[0]);const i=f(Ao);if(!i||!i.fromFolioPos)return"";const{ckid:s,lineoff:o,choff:r}=i.fromFolioPos(n,t,e),l=((n="",t="",e=0,i=0,s=0,o=0)=>{if("object"==typeof n){const r=n;n=r.ptkname,t=r.action||"",e=r.from||0,i=r.till||0,s=r.highlightline||r.lineoff||0,o=r.choff||0}let r="";return o>0?r=s+"-"+o:s>0&&(r=s.toString()),(n?n+":":"")+t+(e?">"+e:"")+(i?"<"+i:"")+(r?":"+r:"")})("","bk#"+Mo(f(uo))+".ck#"+s,0,0,o,r);return l},sr=()=>ir(f(Wo)),or=(n,t)=>{t=t||f(uo);const e=n.defines.folio,i=t.indexOf("_"),s=(~i?t.slice(0,i):t).replace(/1$/,""),o=[],r=e.fields.id.values;for(let n=0;n<r.length;n++)~r[n].indexOf("_variorum")||r[n].startsWith(s+"_")&&r[n]!==t&&!r[n].replace(/1$/,"").match(/\d$/)&&o.push(n);return o},rr=(n,t)=>{if(0==f(Do)&&Do.set(-1),n){const t=f(mo);t[f(uo)]=n,mo.set(Object.assign({},t)),Ro.set(!0)}else Zo();jo.set(n||""),t&&ao.set("1"),setTimeout((()=>{Eo.play()}),100)},lr=()=>{const n=(100*(.45*window.innerHeight)/window.innerWidth).toFixed(2);return"left:"+n+"vw;width:"+(100-n)+"vw"},cr=(n,t=1,e)=>{let i="100vw";if(t=t||1,f(bo)){i=(100*(.45*window.innerHeight*t)/window.innerWidth).toFixed(2)+"vw"}return e&&(null==e?void 0:e.update)&&setTimeout((()=>{(null==e?void 0:e.update)&&(null==e||e.update())}),100),i},ar=["施主※陳碧吟","施主※甯耀南","施主※葉雅柏","施主※李玉媚"],ur=()=>{const n=lr().match(/width:(\d+)/);return n&&n[1]&&parseInt(n[1])>20},dr=["♡","🤍","❤️","💚","💙","💜","🖤"],fr=n=>(n||(n=ir(f(Wo))),location.origin+location.pathname+"#"+n),hr=n=>{const t=f(Oo),e=t.indexOf(n);return~e&&(t.splice(e,1),Oo.set(t.slice(0,t.length))),t},pr=async n=>{const t=await caches.open(Qs),e=(await t.keys()).filter((n=>n.url.endsWith(".zip")&&~n.url.indexOf("folio/"))).map((n=>{return(t=n.url).slice(t.indexOf("folio/")+6).replace(".zip","");var t}));if(!n)return e;{const t={};for(let n=0;n<e.length;n++)t[e[n]]=!0;n.set(t)}},gr=(n,t)=>{const e=[],i="bk#"+Mo(t),[s,o]=n.rangeOfAddress(i),r=n.defines.folio,l=Qn(r.linepos,s),c=Qn(r.linepos,o);for(let n=l;n<c;n++)e.push(r.fields.id.values[n]);return e},mr="◆",$r=(n,t)=>{if(ao.set(n),t){const n=f(Ao),[e,i,s]=n.toFolioPos(t);Wo.set([e,i,s]),wt(sr())}},vr=async(n,t)=>{const e=n.defines.ck,i=n.defines.pb,s=e.linepos[t],o=n.nearestTag(s+1,"pb"),r=i.fields.id.values[o];$r(r,e.fields.id.values[t])},kr=(n,t)=>{let e=0;n==f(uo)?t&&t(n):(Zo(),jo.set(""),ro.set(!0),lo.set(!0),uo.set(n),e=setInterval((()=>{f(lo)||(clearInterval(e),setTimeout((()=>{t&&t(n),ro.set(!1),wt(sr()),setTimeout((()=>{pr(oo)}),100)}),100))}),30))},br=(n,t)=>{t=t||f(uo);const e=n.defines.folio.fields.id.values,i=t.match(/([a-z\_]+)(\d+$)/),s=[];if(!i)return[];for(let n=0;n<e.length;n++)if(e[n].startsWith(i[1])){const t=e[n].slice(i[1].length);parseInt(t)&&s.push(t)}return s},yr=n=>{const t=f(Ao).toFolioPos(n);ao.set(t[0]),Wo.set(t)},xr=(n,t,e)=>{const[i]=n.rangeOfAddress("bk#"+Mo(t)+".ck#"+e);return n.nearestTag(i+1,"folio","id")},wr=(n,t,e=0)=>{const{folioid:i,ckid:s,lineoff:o}=((n,t)=>{const e=n.defines.folio,i=n.defines.ck,s=Qn(e.linepos,t+1)-1,o=Qn(i.linepos,t+1)-1;let r="",l="",c=0;return~s&&e.linepos[s+1]>t&&(r=e.fields.id.values[s],l=i.fields.id.values[o],c=t-i.linepos[o]),{folioid:r,ckid:l,lineoff:c}})(n,t);kr(i,(()=>{const n=f(Ao).toFolioPos(s,o,e);Wo.set(n),ao.set(n[0])}))},Ar=async n=>{if(!n)return;const t=Ae();let e={};for(let i=0;i<t.length;i++){const s=t[i];if(s&&s.defines.folio&&(e=await Yi(s,n),e.id)){if(!f(Ao)){const t=new Qi(s);await t.load(e.id),Ao.set(t),e=await Yi(s,n)}f(so)!==s.name&&so.set(s.name);break}}if(e.id){uo.set(e.id);const{pb:n,line:t,ch:i}=e;ao.set(n),Wo.set([n,t,i])}};function Cr(n,t,e){const i=n.slice();return i[16]=t[e],i[18]=e,i}function Or(n){let t,e=(n[3],n[1]),i=Ir(n);return{c(){i.c(),t=P()},m(n,e){i.m(n,e),y(n,t,e)},p(n,s){10&s&&r(e,(n[3],e=n[1]))?(i.d(1),i=Ir(n),i.c(),i.m(t.parentNode,t)):i.p(n,s)},d(n){n&&x(t),i.d(n)}}}function Pr(t){let e;return{c(){e=A("div"),T(e,"class","strip"),T(e,"id","strip"+t[18]),T(e,"style",t[5](t[18],t[16]))},m(n,t){y(n,e,t)},p:n,d(n){n&&x(e)}}}function Ir(n){let t,e,i=ln(n[4]),s=[];for(let t=0;t<i.length;t+=1)s[t]=Pr(Cr(n,i,t));return{c(){t=A("div");for(let n=0;n<s.length;n+=1)s[n].c();T(t,"class","transcript"),T(t,"style",e=qs(n[0]))},m(n,e){y(n,t,e);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(t,null)},p(n,o){if(48&o){let e;for(i=ln(n[4]),e=0;e<i.length;e+=1){const r=Cr(n,i,e);s[e]?s[e].p(r,o):(s[e]=Pr(r),s[e].c(),s[e].m(t,null))}for(;e<s.length;e+=1)s[e].d(1);s.length=i.length}1&o&&e!==(e=qs(n[0]))&&T(t,"style",e)},d(n){n&&x(t),w(s,n)}}}function Tr(t){let e,i=t[2]&&Xo(t[1]),s=i&&Or(t);return{c(){s&&s.c(),e=P()},m(n,t){s&&s.m(n,t),y(n,e,t)},p(n,[t]){6&t&&(i=n[2]&&Xo(n[1])),i?s?s.p(n,t):(s=Or(n),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:n,o:n,d(n){n&&x(e),s&&s.d(n)}}}function _r(n,t,e){let i,s,o,r,l,c;h(n,jo,(n=>e(1,i=n))),h(n,zo,(n=>e(10,s=n))),h(n,Uo,(n=>e(11,o=n))),h(n,uo,(n=>e(12,r=n))),h(n,Ro,(n=>e(2,l=n))),h(n,ao,(n=>e(3,c=n)));let{frame:a={},totalpages:u}=t,{foliopage:d=[]}=t,{ptk:p}=t;const g=new Array(Bo()),m=[];q((()=>{k()}));const $=()=>{Ho.set(!1),ao.set("1");let n=f(Do);n>0&&(n--,Do.set(n)),0==n&&Zo()},v=()=>{const n=br(p),t=r,e=i,l=s;let c="";for(let n=0;n<l.length;n++)l[n].vid==e&&(c=l[n].performer);if("on"==o&&n.length>1){const e=t.match(/(\d+)$/)[1];if(parseInt(e)==n.length)$();else{const n=t.replace(e,parseInt(e)+1);kr(n,(function(){const n=s;if(n){const t=n.filter((n=>n.performer==c)),e=t.length?t[0].vid:n[0].vid;rr(e)}}))}}else $()},k=()=>{m.forEach((n=>clearTimeout(n))),m.length=0};return n.$$set=n=>{"frame"in n&&e(0,a=n.frame),"totalpages"in n&&e(6,u=n.totalpages),"foliopage"in n&&e(7,d=n.foliopage),"ptk"in n&&e(8,p=n.ptk)},[a,i,l,c,g,(n,t)=>{0==n&&k();let e=Bo(),s=f(qo);const o=a.width/e;let r=[];r.push("position:absolute"),r.push("left:"+Math.floor((e-n-1)*o)+"px"),r.push("top:0px"),r.push("width:"+Math.floor(o)+"px"),r.push("height:0px");const{timestamp:l}=Xo(i);if(!l)return r.join(";");const c=(parseInt(f(ao))-1)*e;l[c]||0!=n||v();let h=(null==Eo?void 0:Eo.currentTime)-l[c]/100;if(Math.abs(h)>3&&(h=.02),0==n){const n=1e3*((l[c+e]/100||l[l.length-1]/100)-l[c]/100-h);m.push(setTimeout((()=>{parseInt(f(ao))<u?(Ho.set(!0),ao.set((parseInt(f(ao))+1).toString()),setTimeout((()=>{Ho.set(!1)}),500)):v()}),n))}let p=1e3*(l[c+n]/100-l[c]/100-h);0==n&&p<30&&(p=30);const g=function(){if(this.folio!=f(ao))return;const t=document.getElementById("strip"+this.idx);if(!t)return;const e=f(Ao).countFolioChar(d[n]||"");t.style.height=Math.floor(e*(a.height/s))+"px"}.bind({idx:n,folio:f(ao)});m.push(setTimeout(g,p));let $=l[c+n+1]/100-l[c+n]/100;return 0==$&&n+1<e&&($=l[c+n+2]/100-l[c+n]/100),r.push("transition:height "+$+"s  linear"),r.join(";")},u,d,p]}class Sr extends $n{constructor(n){super(),mn(this,n,_r,Tr,r,{frame:0,totalpages:6,foliopage:7,ptk:8})}}function Nr(n,t,e){const i=n.slice();return i[9]=t[e],i}function Er(n){let t,e,i,s=n[2](n[9].text)+"";return{c(){t=A("span"),e=C(s),T(t,"class","punc"),T(t,"style",i=n[3](n[9].line,n[9].ch,n[9].text))},m(n,i){y(n,t,i),b(t,e)},p(n,o){2&o&&s!==(s=n[2](n[9].text)+"")&&S(e,s),2&o&&i!==(i=n[3](n[9].line,n[9].ch,n[9].text))&&T(t,"style",i)},d(n){n&&x(t)}}}function zr(t){let e,i,s=ln(t[1]),o=[];for(let n=0;n<s.length;n+=1)o[n]=Er(Nr(t,s,n));return{c(){e=A("div");for(let n=0;n<o.length;n+=1)o[n].c();T(e,"class","puncs"),T(e,"style",i=qs(t[0]))},m(n,t){y(n,e,t);for(let n=0;n<o.length;n+=1)o[n]&&o[n].m(e,null)},p(n,[t]){if(14&t){let i;for(s=ln(n[1]),i=0;i<s.length;i+=1){const r=Nr(n,s,i);o[i]?o[i].p(r,t):(o[i]=Er(r),o[i].c(),o[i].m(e,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=s.length}1&t&&i!==(i=qs(n[0]))&&T(e,"style",i)},i:n,o:n,d(n){n&&x(e),w(o,n)}}}function Lr(n,t,e){let i;h(n,qo,(n=>e(4,i=n)));let{frame:s={}}=t,{puncs:o=[]}=t;const r=Bo(),l=i,c=s.width/r,a=s.height/l;return n.$$set=n=>{"frame"in n&&e(0,s=n.frame),"puncs"in n&&e(1,o=n.puncs)},[s,o,n=>In(n[0])?n:"n"==n[0]?n.slice(1):n,(n,t,e)=>{let i=.9*a,s=.2*a,o=.1*-c,l="";"？"==e||"！"==e?(i/=1.5,s+=.4*a):"﹁"==e||"﹃"==e?(o+=.3*-c,s+=.4*a):"﹄"==e||"﹂"==e?(o+=.6*-c,s+=.4*a):In(e[0])||("n"==e[0]?(o-=.5*c,l="background:var(--n)",e=e.slice(1),s+=a):s+=a,i/=1.5);return"left:"+Math.floor(o+c*(r-n)-.25*c)+"px; top:"+Math.floor(s+a*(t-1)-.2*a)+"px;font-size:"+i+"px;"+l}]}class Mr extends $n{constructor(n){super(),mn(this,n,Lr,zr,r,{frame:0,puncs:1})}}function jr(t){let e;return{c(){e=A("span"),T(e,"class","punc"),T(e,"style",t[0]())},m(n,t){y(n,e,t)},p:n,i:n,o:n,d(n){n&&x(e)}}}function Fr(n,t,e){let{mark:i=[],frame:s,pb:o=""}=t,{folioChars:r=17,folioLines:l=5}=t;const c=s.width/l,a=s.height/r;return n.$$set=n=>{"mark"in n&&e(1,i=n.mark),"frame"in n&&e(2,s=n.frame),"pb"in n&&e(3,o=n.pb),"folioChars"in n&&e(4,r=n.folioChars),"folioLines"in n&&e(5,l=n.folioLines)},[()=>{const[n,t,e]=i;return o!=n?"":"left:"+Math.floor(c*(l-t-1))+"px; top:"+ +Math.floor(s.top+a*e)+"px;width:"+c+"px;height:"+a+"px;background:var(--pinmark);border-radius:5px;pointer-events:none"},i,s,o,r,l]}class Br extends $n{constructor(n){super(),mn(this,n,Fr,jr,r,{mark:1,frame:2,pb:3,folioChars:4,folioLines:5})}}function qr(n,t,e){const i=n.slice();return i[49]=t[e],i[51]=e,i}function Rr(n){let t,e=ln(n[2]),i=[];for(let t=0;t<e.length;t+=1)i[t]=Hr(qr(n,e,t));return{c(){t=A("div");for(let n=0;n<i.length;n+=1)i[n].c();T(t,"class","swipe-indicator swipe-indicator-inside svelte-17g4ceu")},m(n,e){y(n,t,e);for(let n=0;n<i.length;n+=1)i[n]&&i[n].m(t,null)},p(n,s){if(38&s[0]){let o;for(e=ln(n[2]),o=0;o<e.length;o+=1){const r=qr(n,e,o);i[o]?i[o].p(r,s):(i[o]=Hr(r),i[o].c(),i[o].m(t,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},d(n){n&&x(t),w(i,n)}}}function Hr(n){let t,e,i,s;function o(){return n[23](n[51])}return{c(){t=A("span"),T(t,"aria-hidden","true"),T(t,"class",e="dot "+(n[1]==n[51]?"is-active":"")+" svelte-17g4ceu")},m(n,e){y(n,t,e),i||(s=I(t,"click",o),i=!0)},p(i,s){n=i,2&s[0]&&e!==(e="dot "+(n[1]==n[51]?"is-active":"")+" svelte-17g4ceu")&&T(t,"class",e)},d(n){n&&x(t),i=!1,s()}}}function Ur(n){let t,e,i,o,r,l,c,a,u,d;const f=n[21].default,h=p(f,n,n[20],null);let g=n[0]&&Rr(n);return{c(){t=A("div"),e=A("div"),i=A("div"),o=A("div"),h&&h.c(),r=O(),l=A("div"),c=O(),g&&g.c(),T(o,"class","swipeable-slot-wrapper svelte-17g4ceu"),T(i,"class","swipeable-total_elements svelte-17g4ceu"),T(e,"class","swipe-item-wrapper svelte-17g4ceu"),T(l,"aria-hidden","true"),T(l,"class","swipe-handler svelte-17g4ceu"),T(t,"class","swipe-panel svelte-17g4ceu")},m(s,f){y(s,t,f),b(t,e),b(e,i),b(i,o),h&&h.m(o,null),n[22](e),b(t,r),b(t,l),b(t,c),g&&g.m(t,null),a=!0,u||(d=[I(l,"touchstart",n[4]),I(l,"mousedown",n[4])],u=!0)},p(n,e){h&&h.p&&(!a||1048576&e[0])&&$(h,f,n,n[20],a?m(f,n[20],e,null):v(n[20]),null),n[0]?g?g.p(n,e):(g=Rr(n),g.c(),g.m(t,null)):g&&(g.d(1),g=null)},i(n){a||(on(h,n),a=!0)},o(n){rn(h,n),a=!1},d(e){e&&x(t),h&&h.d(e),n[22](null),g&&g.d(),u=!1,s(d)}}}function Wr(n,t,e){let i,s,o,r,l,c,a,u,{$$slots:d={},$$scope:f}=t,{transitionDuration:h=200}=t,{showIndicators:p=!1}=t,{autoplay:g=!1}=t,{delay:m=1e3}=t,{defaultIndex:$=0}=t,{active_item:v=0}=t,{is_vertical:k=!1}=t,{allow_infinite_swipe:b=!1}=t,y=0,x=0,w=0,A=0,C=0,O=0,P=k?"pageY":"pageX",I=!1,T=R(),_=0;function S(){let{offsetWidth:n,offsetHeight:t}=r.querySelector(".swipeable-total_elements");w=k?t:n,N({init:!0,elems:[...s],availableSpace:w,has_infinite_loop:b}),C=0,A=w*(x-1),$&&D($)}function N({elems:n=[],availableSpace:t=0,pos_axis:e=0,has_infinite_loop:i=!1,distance:s=0,moving:o=!1,init:r=!1,end:l=!1,reset:c=!1}){n.forEach(((n,a)=>{let u=i?a-1:a;r&&(n.style.transform=z(t*u)),o&&(n.style.cssText=L(t*u-s)),l&&(n.style.cssText=L(t*u-e,!0)),c&&(n.style.cssText=L(t*u-e))}))}function E(n){let t={add:"addEventListener",remove:"removeEventListener"};"undefined"!=typeof window&&(window[t[n]]("mousemove",H),window[t[n]]("mouseup",W),window[t[n]]("touchmove",H,{passive:!1}),window[t[n]]("touchend",W,{passive:!1}))}function z(n){return k?`translate3d(0, ${n}px, 0)`:`translate3d(${n}px, 0, 0)`}function L(n,t=!1){let e=z(n);return`\n-webkit-transition-duration: ${t?h:"0"}ms;\ntransition-duration: ${t?h:"0"}ms;\n-webkit-transform: ${e};\n-ms-transform: ${e};`}B((()=>{o=r.querySelector(".swipeable-slot-wrapper"),s=o.querySelectorAll(".swipeable-item"),e(18,x=s.length),b&&(o.prepend(s[x-1].cloneNode(!0)),o.append(s[0].cloneNode(!0)),s=o.querySelectorAll(".swipeable-item")),S(),"undefined"!=typeof window&&window.addEventListener("resize",S)})),q((()=>{"undefined"!=typeof window&&window.removeEventListener("resize",S)}));let M,j,F=!1;function H(n){if(F){_++,n.stopImmediatePropagation(),n.stopPropagation();let t=n.touches?n.touches[0][P]:n[P],e=l-t+O;if(!b&&(0==O&&l<t||O==A&&l>t))return;n.preventDefault(),N({moving:!0,elems:[...s],availableSpace:w,distance:e,has_infinite_loop:b}),C=e,a=t}}function W(n){n&&n.cancelable&&n.preventDefault(),n&&n.stopImmediatePropagation(),n&&n.stopPropagation();let t=l<a;F=!1;let i=w,o=Math.round(w/50)>Math.abs(l-a);C=c||o?Math.round(C/i)*i:t?Math.floor(C/i)*i:Math.ceil(C/i)*i,l=null,a=null,O=C,e(1,y=C/i),e(7,v=y),e(6,$=v),N({end:!0,elems:[...s],availableSpace:i,pos_axis:O,has_infinite_loop:b}),b&&(-1===v&&(O=i*(x-1)),v===x&&(O=0),e(1,y=O/i),e(7,v=y),e(6,$=v),setTimeout((()=>{N({reset:!0,elems:[...s],availableSpace:i,pos_axis:O,has_infinite_loop:b})}),h)),E("remove");let r,u,d=t?"right":"left";(null==n?void 0:n.changedTouches)?(r=n.changedTouches[0].pageX,u=n.changedTouches[0].pageY):(r=null==n?void 0:n.clientX,u=null==n?void 0:n.clientY),Math.abs(M-r)<3&&Math.abs(j-u)<3&&_<3?T("click",{x:r,y:u}):setTimeout((()=>{T("change",{active_item:v,swipe_direction:d,active_element:s[v]})}),h)}function D(n){C=w*n,e(1,y=n),W()}function K(){D(u),u=u<x-1+b?++u:0}function J(n){D(b?n:Math.max(0,Math.min(n,i.length-1)))}return n.$$set=n=>{"transitionDuration"in n&&e(8,h=n.transitionDuration),"showIndicators"in n&&e(0,p=n.showIndicators),"autoplay"in n&&e(9,g=n.autoplay),"delay"in n&&e(10,m=n.delay),"defaultIndex"in n&&e(6,$=n.defaultIndex),"active_item"in n&&e(7,v=n.active_item),"is_vertical"in n&&e(11,k=n.is_vertical),"allow_infinite_swipe"in n&&e(12,b=n.allow_infinite_swipe),"$$scope"in n&&e(20,f=n.$$scope)},n.$$.update=()=>{262144&n.$$.dirty[0]&&e(2,i=Array(x)),526016&n.$$.dirty[0]&&(g&&!I&&(u=$||v,e(19,I=setInterval(K,m))),!g&&I&&(clearInterval(I),e(19,I=!1)))},[p,y,i,r,function(n){T("start"),_=0,n.stopImmediatePropagation(),n.stopPropagation(),F=!0,c=!1,setTimeout((function(){c=!0}),250),l=n.touches?n.touches[0][P]:n[P],n.touches?(M=n.touches[0].pageX,j=n.touches[0].pageY):(M=n.clientX,j=n.clientY),E("add")},D,$,v,h,g,m,k,b,S,function(){J(x-1)},J,function(){J(y-1)},function(){J(y+1)},x,I,f,d,function(n){U[n?"unshift":"push"]((()=>{r=n,e(3,r)}))},n=>{D(n)}]}class Dr extends $n{get update(){return this.$$.ctx[13]}get goLast(){return this.$$.ctx[14]}get goTo(){return this.$$.ctx[15]}get prevItem(){return this.$$.ctx[16]}get nextItem(){return this.$$.ctx[17]}constructor(n){super(),mn(this,n,Wr,Ur,r,{transitionDuration:8,showIndicators:0,autoplay:9,delay:10,defaultIndex:6,active_item:7,is_vertical:11,allow_infinite_swipe:12,update:13,goLast:14,goTo:15,prevItem:16,nextItem:17},null,[-1,-1])}}function Kr(n){let t,e,i,s,o;const r=n[6].default,l=p(r,n,n[5],null);return{c(){t=A("div"),e=A("div"),l&&l.c(),T(e,"class","swipeable-item-inner"),T(t,"class",i="swipeable-item "+n[1]+" "+(n[0]?"is-active":"")+" svelte-13ik1fy"),T(t,"style",n[2]),Y((()=>n[8].call(t)))},m(i,r){y(i,t,r),b(t,e),l&&l.m(e,null),n[7](e),s=function(n,t){"static"===getComputedStyle(n).position&&(n.style.position="relative");const e=A("iframe");e.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1;const i=z();let s;return i?(e.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",s=I(window,"message",(n=>{n.source===e.contentWindow&&t()}))):(e.src="about:blank",e.onload=()=>{s=I(e.contentWindow,"resize",t),t()}),b(n,e),()=>{(i||s&&e.contentWindow)&&s(),x(e)}}(t,n[8].bind(t)),o=!0},p(n,[e]){l&&l.p&&(!o||32&e)&&$(l,r,n,n[5],o?m(r,n[5],e,null):v(n[5]),null),(!o||3&e&&i!==(i="swipeable-item "+n[1]+" "+(n[0]?"is-active":"")+" svelte-13ik1fy"))&&T(t,"class",i),(!o||4&e)&&T(t,"style",n[2])},i(n){o||(on(l,n),o=!0)},o(n){rn(l,n),o=!1},d(e){e&&x(t),l&&l.d(e),n[7](null),s()}}}function Jr(n,t,e){let{$$slots:i={},$$scope:s}=t,{active:o=!1}=t,{classes:r=""}=t,{style:l=""}=t,c=null,a=0;return n.$$set=n=>{"active"in n&&e(0,o=n.active),"classes"in n&&e(1,r=n.classes),"style"in n&&e(2,l=n.style),"$$scope"in n&&e(5,s=n.$$scope)},[o,r,l,c,a,s,i,function(n){U[n?"unshift":"push"]((()=>{c=n,e(3,c)}))},function(){a=this.clientHeight,e(4,a)}]}class Yr extends $n{constructor(n){super(),mn(this,n,Jr,Kr,r,{active:0,classes:1,style:2})}}function Qr(){const n=document.location.protocol,t=document.location.hostname;return"http:"==n&&("127.0.0.1"==t||"localhost"==t)}const Vr=async(n,t)=>{if(!navigator.onLine&&!Qr())return!0;const e=n.replace(/\?.+/,""),i=e+"?"+(new Date).toISOString(),s=~i.indexOf(".mp3")?"audio/mpeg":"application/octet-stream",o=await fetch(i,{method:"HEAD",mode:"no-cors",redirect:"follow",credentials:"omit",origin:origin,headers:{Accept:s}}),r=await caches.open(t),l=await r.match(e),c=o.headers.get("Content-Length");return l&&c==l.headers.get("Content-Length")},Gr=async(n,t,e)=>{const i=t.replace(/\?.+/,""),s=~t.indexOf(".mp3")?"audio/mpeg":"application/octet-stream",o="https://nissaya.cn",r=await caches.open(n),l=await r.match(i);if(!navigator.onLine&&!Qr())return l||r.match("/offline.html");if(l&&"OK"==l.statusText&&(t.endsWith(".zip")||t.endsWith(".mp3")||t.endsWith(".ptk")))return l;const c=(await fetch(t,{method:"HEAD",mode:"no-cors",redirect:"follow",credentials:"omit",origin:o,headers:{Accept:s}})).headers.get("Content-Length");if(l&&c==l.headers.get("Content-Length"))return l;e&&e("requesting");let a=await fetch(t,{method:"GET",mode:"no-cors",redirect:"follow",credentials:"omit",origin:o,headers:{Accept:s}});if(e&&e("responsed"),!(a.status>=400)){if(a.body){const n=a.body.getReader(),t=+a.headers.get("Content-Length");let o=0,l=[];for(;;){const{done:i,value:s}=await n.read();if(i)break;l.push(s),o+=s.length,e&&e(Math.floor(100*o/t)+"% / "+((u=t)<1024?[u,"B"]:u<1048576?[parseFloat((u/1024).toFixed(2)),"KB"]:[parseFloat((u/1048576).toFixed(2)),"MB"]))}let c=new Uint8Array(o),d=0;for(let n of l)c.set(n,d),d+=n.length;const f={status:a.status,statusText:a.statusText,headers:{"X-Shaka-From-Cache":!0,"Content-Type":s,"Content-Length":t}},h=new Response(c,f);return r.put(i,h.clone()),e&&e("cached"),h}return r.put(i,a.clone()),e&&e("cached"),a;var u}e&&e(a.statusText)},Xr=async n=>await(async(n,t,e=".ptk")=>{const i=await caches.open(t),s=(await i.keys()).filter((n=>n.url.endsWith(e))).map((t=>t.url.match(n))).filter((n=>!!n)).map((n=>n[1]));return nt(s)})(/([a-z_\-]+)\.ptk/,n);function Zr(t){let e,i;return{c(){e=A("div"),i=C(t[0]),T(e,"class","downloading bodytext")},m(n,t){y(n,e,t),b(e,i)},p(n,[t]){1&t&&S(i,n[0])},i:n,o:n,d(n){n&&x(e)}}}function nl(n,t,e){let{msg:i=""}=t;return n.$$set=n=>{"msg"in n&&e(0,i=n.msg)},[i]}class tl extends $n{constructor(n){super(),mn(this,n,nl,Zr,r,{msg:0})}}function el(n){let t,e;return t=new tl({props:{msg:n[20]}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};1048576&e[0]&&(i.msg=n[20]),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function il(n){let e,i,s,o,r,l;const c=[n[25],{defaultIndex:n[8]}];let a={$$slots:{default:[ll]},$$scope:{ctx:n}};for(let n=0;n<c.length;n+=1)a=t(a,c[n]);return i=new Dr({props:a}),n[36](i),i.$on("click",n[29]),i.$on("start",n[26]),i.$on("change",n[27]),{c(){e=A("div"),fn(i.$$.fragment),T(e,"aria-hidden","true"),T(e,"class","swipe-holder svelte-u4lgbo"),T(e,"style",s="opacity:"+("folio"!==n[18]?"0;":"1")+";width:"+cr(n[19],1,n[7]))},m(t,s){y(t,e,s),hn(i,e,null),o=!0,r||(l=I(e,"wheel",n[28]),r=!0)},p(n,t){const r=33554688&t[0]?cn(c,[33554432&t[0]&&an(n[25]),256&t[0]&&{defaultIndex:n[8]}]):{};1048576&t[1]&&(r.$$scope={dirty:t,ctx:n}),i.$set(r),(!o||786560&t[0]&&s!==(s="opacity:"+("folio"!==n[18]?"0;":"1")+";width:"+cr(n[19],1,n[7])))&&T(e,"style",s)},i(n){o||(on(i.$$.fragment,n),o=!0)},o(n){rn(i.$$.fragment,n),o=!1},d(t){t&&x(e),n[36](null),pn(i),r=!1,l()}}}function sl(t){let e,i;return{c(){e=A("img"),u(e.src,i=vl)||T(e,"src",i),T(e,"alt","no"),T(e,"class","leftimage swipe svelte-u4lgbo")},m(n,t){y(n,e,t)},p:n,d(n){n&&x(e)}}}function ol(t){let e,i;return{c(){e=A("img"),u(e.src,i=vl)||T(e,"src",i),T(e,"alt","no"),T(e,"class","middleimage swipe svelte-u4lgbo")},m(n,t){y(n,e,t)},p:n,d(n){n&&x(e)}}}function rl(t){let e,i;return{c(){e=A("img"),u(e.src,i=vl)||T(e,"src",i),T(e,"alt","no"),T(e,"class","rightimage swipe svelte-u4lgbo")},m(n,t){y(n,e,t)},p:n,d(n){n&&x(e)}}}function ll(n){let t,e,i,s,o,r;return t=new Yr({props:{$$slots:{default:[sl]},$$scope:{ctx:n}}}),i=new Yr({props:{$$slots:{default:[ol]},$$scope:{ctx:n}}}),o=new Yr({props:{$$slots:{default:[rl]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment),e=O(),fn(i.$$.fragment),s=O(),fn(o.$$.fragment)},m(n,l){hn(t,n,l),y(n,e,l),hn(i,n,l),y(n,s,l),hn(o,n,l),r=!0},p(n,e){const s={};1048576&e[1]&&(s.$$scope={dirty:e,ctx:n}),t.$set(s);const r={};1048576&e[1]&&(r.$$scope={dirty:e,ctx:n}),i.$set(r);const l={};1048576&e[1]&&(l.$$scope={dirty:e,ctx:n}),o.$set(l)},i(n){r||(on(t.$$.fragment,n),on(i.$$.fragment,n),on(o.$$.fragment,n),r=!0)},o(n){rn(t.$$.fragment,n),rn(i.$$.fragment,n),rn(o.$$.fragment,n),r=!1},d(n){n&&(x(e),x(s)),pn(t,n),pn(i,n),pn(o,n)}}}function cl(n){let t,e=n[10],i=al(n);return{c(){i.c(),t=P()},m(n,e){i.m(n,e),y(n,t,e)},p(n,s){1024&s[0]&&r(e,e=n[10])?(i.d(1),i=al(n),i.c(),i.m(t.parentNode,t)):i.p(n,s)},d(n){n&&x(t),i.d(n)}}}function al(n){var t;let e,i,s,o,r=dr[(null===(t=n[14][n[13]])||void 0===t?void 0:t[n[2]])||0]+"";return{c(){e=A("span"),i=C(r),T(e,"aria-hidden","true"),T(e,"class","favoritebtn"),L(e,"blinkfavorbtn",!!n[10])},m(t,r){y(t,e,r),b(e,i),s||(o=I(e,"click",n[30]),s=!0)},p(n,t){var s;24580&t[0]&&r!==(r=dr[(null===(s=n[14][n[13]])||void 0===s?void 0:s[n[2]])||0]+"")&&S(i,r),1024&t[0]&&L(e,"blinkfavorbtn",!!n[10])},d(n){n&&x(e),s=!1,o()}}}function ul(n){let t,e,i,s,o=n[21]?"◼":"♫";return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","playbtn")},m(o,r){y(o,t,r),b(t,e),i||(s=I(t,"click",n[31]),i=!0)},p(n,t){2097152&t[0]&&o!==(o=n[21]?"◼":"♫")&&S(e,o)},d(n){n&&x(t),i=!1,s()}}}function dl(n){let t,e,i=(n[23]>0?n[23]:"")+"";return{c(){t=A("span"),e=C(i),T(t,"class","remainrollback")},m(n,i){y(n,t,i),b(t,e)},p(n,t){8388608&t[0]&&i!==(i=(n[23]>0?n[23]:"")+"")&&S(e,i)},d(n){n&&x(t)}}}function fl(n){let t,e;return t=new Br({props:{mark:n[15],pb:n[2],folioChars:n[17],folioLines:Bo(),frame:n[11]}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};32768&e[0]&&(i.mark=n[15]),4&e[0]&&(i.pb=n[2]),131072&e[0]&&(i.folioChars=n[17]),2048&e[0]&&(i.frame=n[11]),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function hl(n){let t,e,i=n[5]&&!n[6]&&!n[16]&&"folio"==n[18]&&fl(n);return{c(){i&&i.c(),t=P()},m(n,s){i&&i.m(n,s),y(n,t,s),e=!0},p(n,e){!n[5]||n[6]||n[16]||"folio"!=n[18]?i&&(en(),rn(i,1,1,(()=>{i=null})),sn()):i?(i.p(n,e),327776&e[0]&&on(i,1)):(i=fl(n),i.c(),on(i,1),i.m(t.parentNode,t))},i(n){e||(on(i),e=!0)},o(n){rn(i),e=!1},d(n){n&&x(t),i&&i.d(n)}}}function pl(n){let t,e,i,s="on"==n[24]&&"folio"==n[18]&&gl(n);return e=new Sr({props:{frame:n[11],totalpages:n[0],ptk:n[1],foliopage:n[3]}}),{c(){s&&s.c(),t=O(),fn(e.$$.fragment)},m(n,o){s&&s.m(n,o),y(n,t,o),hn(e,n,o),i=!0},p(n,i){"on"==n[24]&&"folio"==n[18]?s?(s.p(n,i),17039360&i[0]&&on(s,1)):(s=gl(n),s.c(),on(s,1),s.m(t.parentNode,t)):s&&(en(),rn(s,1,1,(()=>{s=null})),sn());const o={};2048&i[0]&&(o.frame=n[11]),1&i[0]&&(o.totalpages=n[0]),2&i[0]&&(o.ptk=n[1]),8&i[0]&&(o.foliopage=n[3]),e.$set(o)},i(n){i||(on(s),on(e.$$.fragment,n),i=!0)},o(n){rn(s),rn(e.$$.fragment,n),i=!1},d(n){n&&x(t),s&&s.d(n),pn(e,n)}}}function gl(n){let t,e;return t=new Mr({props:{frame:n[11],puncs:n[4]}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};2048&e[0]&&(i.frame=n[11]),16&e[0]&&(i.puncs=n[4]),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function ml(n){let t,e,i=!n[6]&&pl(n);return{c(){i&&i.c(),t=P()},m(n,s){i&&i.m(n,s),y(n,t,s),e=!0},p(n,e){n[6]?i&&(en(),rn(i,1,1,(()=>{i=null})),sn()):i?(i.p(n,e),64&e[0]&&on(i,1)):(i=pl(n),i.c(),on(i,1),i.m(t.parentNode,t))},i(n){e||(on(i),e=!0)},o(n){rn(i),e=!1},d(n){n&&x(t),i&&i.d(n)}}}function $l(t){let e,i,s,o,l,c,a,u,d,f,h,p,g=!t[19]&&t[12].filter(kl).length,m=t[9]+1+"",$=t[15]+t[2],v=t[4];const k=[il,el],w=[];function I(n,t){return n[5]?0:1}e=I(t),i=w[e]=k[e](t);let _=!t[19]&&t[0]-t[8]>1&&cl(t),N=g&&ul(t),E=t[22]&&dl(t),z=hl(t),L=ml(t);return{c(){i.c(),s=O(),_&&_.c(),o=O(),N&&N.c(),l=O(),c=A("span"),a=C(m),u=O(),E&&E.c(),d=O(),z.c(),f=O(),L.c(),h=P(),T(c,"class","pagenumber")},m(n,t){w[e].m(n,t),y(n,s,t),_&&_.m(n,t),y(n,o,t),N&&N.m(n,t),y(n,l,t),y(n,c,t),b(c,a),y(n,u,t),E&&E.m(n,t),y(n,d,t),z.m(n,t),y(n,f,t),L.m(n,t),y(n,h,t),p=!0},p(t,c){let u=e;e=I(t),e===u?w[e].p(t,c):(en(),rn(w[u],1,1,(()=>{w[u]=null})),sn(),i=w[e],i?i.p(t,c):(i=w[e]=k[e](t),i.c()),on(i,1),i.m(s.parentNode,s)),!t[19]&&t[0]-t[8]>1?_?_.p(t,c):(_=cl(t),_.c(),_.m(o.parentNode,o)):_&&(_.d(1),_=null),528384&c[0]&&(g=!t[19]&&t[12].filter(kl).length),g?N?N.p(t,c):(N=ul(t),N.c(),N.m(l.parentNode,l)):N&&(N.d(1),N=null),(!p||512&c[0])&&m!==(m=t[9]+1+"")&&S(a,m),t[22]?E?E.p(t,c):(E=dl(t),E.c(),E.m(d.parentNode,d)):E&&(E.d(1),E=null),32772&c[0]&&r($,$=t[15]+t[2])?(en(),rn(z,1,1,n),sn(),z=hl(t),z.c(),on(z,1),z.m(f.parentNode,f)):z.p(t,c),16&c[0]&&r(v,v=t[4])?(en(),rn(L,1,1,n),sn(),L=ml(t),L.c(),on(L,1),L.m(h.parentNode,h)):L.p(t,c)},i(n){p||(on(i),on(z),on(L),p=!0)},o(n){rn(i),rn(z),rn(L),p=!1},d(n){n&&(x(s),x(o),x(l),x(c),x(u),x(d),x(f),x(h)),w[e].d(n),_&&_.d(n),N&&N.d(n),E&&E.d(n),z.d(n),L.d(n)}}}const vl="frames/blank.png",kl=n=>n.incache;function bl(n,t,e){let i,s,o,r,l,c,a,u,d,p,g,m,$,v,k,b,y,x,w;h(n,ao,(n=>e(2,s=n))),h(n,zo,(n=>e(12,o=n))),h(n,uo,(n=>e(13,r=n))),h(n,mo,(n=>e(39,l=n))),h(n,go,(n=>e(14,c=n))),h(n,so,(n=>e(35,a=n))),h(n,Wo,(n=>e(15,u=n))),h(n,Yo,(n=>e(16,d=n))),h(n,qo,(n=>e(17,p=n))),h(n,wo,(n=>e(18,g=n))),h(n,io,(n=>e(40,m=n))),h(n,ko,(n=>e(41,$=n))),h(n,bo,(n=>e(19,v=n))),h(n,ho,(n=>e(20,k=n))),h(n,jo,(n=>e(21,b=n))),h(n,Ro,(n=>e(22,y=n))),h(n,Do,(n=>e(23,x=n))),h(n,$o,(n=>e(24,w=n)));let A,C,{onMainmenu:O=()=>{}}=t,{src:P}=t,I=[],T=[],_=!1,{totalpages:S=0}=t,{onTapText:N=function(){}}=t,E=1,z=0,L=0,M={};let j=1;const F=(n,t,e)=>{if(!C)return;e>=S?e=0:e<0&&(e=S-1),isNaN(e)&&(e=0);const i=(n=>{const t=["leftimage","middleimage","rightimage"][n];return document.getElementsByClassName(t)})(n);for(let n=0;n<i.length;n++){const s=new Blob([t.files[e].content]);i[n].src=URL.createObjectURL(s)}C.update()},B=n=>{if(!C)return;const t=m;let i=n-1;i<0&&(i=S-1);let s=n+1;s>=S&&(s=0),F((E+1)%3,t,i),F(E,t,n),F((E+2)%3,t,s),C.update(),e(9,z=n);const o=document.getElementsByClassName("middleimage")[0],r=o.clientHeight||M.height,l=o.clientWidth||M.width||.45*r;e(11,M={left:0,top:0,width:l,height:r})},q=()=>{e(6,_=!0),e(3,I=f(Ao).folioPageText(s)),e(3,I=I.join("\n").replace(/【[^】]+】/,"").split("\n")),setTimeout((()=>{const n=Bo();e(6,_=!1),e(4,T=((n,t=5,e="「」『』。，；：、！？")=>{const i=[];for(let o=0;o<n.length;o++){let r=0,l=0,c=0,[a,u]=Wn(n[o]);const d=!!u.filter((n=>"gatha"==n.name)).length;if(o>=t)break;d&&(a=a.replace(/[？；，。．]/g,"　"));const f=En(a);for(let n=0;n<f.length;n++){for(;l<u.length&&c>u[l].choff;)"ck"==u[l].name?i.push({line:o,ch:r,text:xt(parseInt(u[l].attrs.id),"①")}):"n"==u[l].name&&i.push({line:o,ch:r,text:"n"+parseInt(u[l].attrs.id)}),l++;if(c+=f[n].length,~e.indexOf(f[n])){let t=(s=f[n],Sn[s]||s);i.push({line:o,ch:r,text:t})}(Pn(f[n])||"　"==f[n])&&r++}}var s;return i})(I,n))}),200)},R=(n=!1)=>{ur()&&!n||(Yo.set(!1),Jo.set(0))},H=()=>{var n;L&&(clearTimeout(L),e(10,L=0)),W=!0;const t=s,i=null===(n=c[r])||void 0===n?void 0:n[t];if(i){const n=Object.assign({},c);for(let n in c[r]){c[r][n]==i&&parseInt(t)!==parseInt(n)&&delete c[r][n]}go.set(Object.assign({},n))}};let W=!0;return n.$$set=n=>{"onMainmenu"in n&&e(32,O=n.onMainmenu),"src"in n&&e(33,P=n.src),"totalpages"in n&&e(0,S=n.totalpages),"onTapText"in n&&e(34,N=n.onTapText)},n.$$.update=()=>{16&n.$$.dirty[1]&&e(1,i=Ki(a)),2&n.$$.dirty[0]|4&n.$$.dirty[1]&&i&&(async()=>{e(5,A=!1),lo.set(!0);let n="folio/";const t=new Qi(i);await t.load(r),Ao.set(t);const o=ir(u);At()!==o&&wt(o);const l=await Gr(Qs,n+P,(t=>{ho.set(n+P+" "+t)}));ho.set("");const c=await l.arrayBuffer(),a=new Wi(c);io.set(a),e(0,S=a.files.length),e(9,z=parseInt(s)-1),z>=S&&e(9,z=0),e(5,A=!0),setTimeout((()=>{fo.set(S),lo.set(!1),B(z),q(),to(r,zo,"on"==$)}),10)})(),4&n.$$.dirty[0]&&(async n=>{S&&C&&(q(),B(parseInt(n)-1))})(s)},[S,i,s,I,T,A,_,C,E,z,L,M,o,r,c,u,d,p,g,v,k,b,y,x,w,{autoplay:!1,delay:0,showIndicators:!1,transitionDuration:250,allow_infinite_swipe:!0},n=>{e(6,_=!0)},n=>{if(!A)return;const{active_item:t}=n.detail;e(8,E=t);let i=z;const s=m;j!=E?((j+3-E)%3==1?(i++,i>=S&&(i=0),F((j+1)%3,s,i+1)):(i--,i<0&&(i=S-1),F((j+2)%3,s,i-1)),j=E,e(9,z=i),ao.set((z+1).toString()),C.update(),q(),R(),H()):e(6,_=!1)},n=>{if("folio"!==g)return;if(!A)return;if(n.ctrlKey)return;e(6,_=!0);let t=parseInt(s);n.deltaY>0?(t++,t>S&&(t=1),ao.set(t)):(t--,t<1&&(t=S),ao.set(t)),R(!0),n.preventDefault()},n=>{if(d&&!ur())return void R(!0);e(6,_=!1);const{x:t,y:i}=n.detail,[o,r]=((n,t)=>{const{left:e,top:i,width:s,height:o}=M;return n-=e,t-=i,[Bo()-Math.floor(n/s*Bo())-1,Math.floor(t/o*p)]})(t,i);if(o>=Bo()!=o<0)return void N("");const l=u,c=[s,o,r];if(JSON.stringify(l)==JSON.stringify(c))return po.set(!0),navigator.clipboard.writeText(fr()),void N("");po.set(!1),Wo.set(c);const a=sr();wt(a),localStorage.setItem(Rs+"homeurl",a);const h=f(Ao);let{choff:g,linetext:m}=h.fromFolioPos(s,o,r);m=m.replace(/([。！？：、．；，「『（ ])/g,"　");const $=m.slice(0,g)+mr+m.slice(g).replace(/　.+/,"");let[v]=Wn($);for(;"　"==v.charAt(0);)v=v.slice(1);for(;"　"==v.charAt(v.length-1);)v=v.slice(0,v.length-1);N(v)},()=>{if("ylz-prjn"!==a&&"ylz-tg"!==a&&"ylz-vny"!==a&&"ylz-svk"!==a)return;clearTimeout(L),e(10,L=setTimeout((()=>{H()}),5e3));const n=Object.assign({},c);n[r]||(n[r]={});if(n[r][s])if(W)delete n[r][s],clearTimeout(L),e(10,L=0);else{let t=n[r][s]+1;t>=dr.length&&(t=1),n[r][s]=t,W=!1}else W=!1,n[r][s]=1;go.set(Object.assign({},n))},()=>{if(f(jo))rr("");else{var n;if(o.length<2)return;const t=Math.floor(Math.random()*(o.length-1))+1,e=l[r]||(null===(n=o[t||1])||void 0===n?void 0:n.aid);rr(e)}},O,P,N,a,function(n){U[n?"unshift":"push"]((()=>{C=n,e(7,C)}))}]}class yl extends $n{constructor(n){super(),mn(this,n,bl,$l,r,{onMainmenu:32,src:33,totalpages:0,onTapText:34},null,[-1,-1])}}window.matchMedia("(orientation: portrait)").addEventListener("change",(function(n){bo.set(!n.matches)})),window.addEventListener("deviceorientation",(()=>{bo.set(screen.availWidth>screen.availHeight)}),!0),bo.set(screen.availWidth>screen.availHeight);const xl=()=>{const n=document.documentElement,t=window.innerHeight*f(Po);n.style.setProperty("--doc-height",`${t}px`)};window.addEventListener("resize",xl);const wl=(n,t)=>{const e=void 0===t?f(_o):t;return parseInt(e)?_t(n,e):n};function Al(n,t,e){const i=n.slice();return i[17]=t[e][0],i[18]=t[e][1],i[20]=e,i}function Cl(t){let e,i=wl("點要查的字詞。")+"";return{c(){e=C(i)},m(n,t){y(n,e,t)},p:n,d(n){n&&x(e)}}}function Ol(n){let t,e,i,s=ln(n[0]),o=[];for(let t=0;t<s.length;t+=1)o[t]=zl(Al(n,s,t));let r=n[5]&&Ll(n);return{c(){t=A("span");for(let n=0;n<o.length;n+=1)o[n].c();e=O(),r&&r.c(),i=P(),T(t,"class","header svelte-q5fwfc")},m(n,s){y(n,t,s);for(let n=0;n<o.length;n+=1)o[n]&&o[n].m(t,null);y(n,e,s),r&&r.m(n,s),y(n,i,s)},p(n,e){if(8159&e){let i;for(s=ln(n[0]),i=0;i<s.length;i+=1){const r=Al(n,s,i);o[i]?o[i].p(r,e):(o[i]=zl(r),o[i].c(),o[i].m(t,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=s.length}n[5]?r?r.p(n,e):(r=Ll(n),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},d(n){n&&(x(t),x(e),x(i)),w(o,n),r&&r.d(n)}}}function Pl(n){let t,e,i,s,o,r,l,c,a,u=(n[3]||n[4])&&Il(n),d=n[2]&&Sl(n);return{c(){u&&u.c(),t=O(),d&&d.c(),e=O(),i=A("a"),s=C("谷哥"),r=O(),l=A("a"),c=C("百度"),T(i,"target","_new"),T(i,"href",o=n[9](n[18])),T(l,"target","_new"),T(l,"href",a=n[10](n[18]))},m(n,o){u&&u.m(n,o),y(n,t,o),d&&d.m(n,o),y(n,e,o),y(n,i,o),b(i,s),y(n,r,o),y(n,l,o),b(l,c)},p(n,s){n[3]||n[4]?u?u.p(n,s):(u=Il(n),u.c(),u.m(t.parentNode,t)):u&&(u.d(1),u=null),n[2]?d?d.p(n,s):(d=Sl(n),d.c(),d.m(e.parentNode,e)):d&&(d.d(1),d=null),1&s&&o!==(o=n[9](n[18]))&&T(i,"href",o),1&s&&a!==(a=n[10](n[18]))&&T(l,"href",a)},d(n){n&&(x(t),x(e),x(i),x(r),x(l)),u&&u.d(n),d&&d.d(n)}}}function Il(n){let t;function e(n,t){return"oneline"==n[6]?_l:Tl}let i=e(n),s=i(n);return{c(){s.c(),t=P()},m(n,e){s.m(n,e),y(n,t,e)},p(n,o){i===(i=e(n))&&s?s.p(n,o):(s.d(1),s=i(n),s&&(s.c(),s.m(t.parentNode,t)))},d(n){n&&x(t),s.d(n)}}}function Tl(t){let e,i,s;return{c(){e=A("button"),e.textContent="一行"},m(n,o){y(n,e,o),i||(s=I(e,"click",t[12]),i=!0)},p:n,d(n){n&&x(e),i=!1,s()}}}function _l(n){let t,e,i;return{c(){t=A("a"),e=C("一行"),T(t,"target","_new"),T(t,"href",i=n[8](n[18]))},m(n,i){y(n,t,i),b(t,e)},p(n,e){1&e&&i!==(i=n[8](n[18]))&&T(t,"href",i)},d(n){n&&x(t)}}}function Sl(n){let t;function e(n,t){return"wikipedia"==n[6]?El:Nl}let i=e(n),s=i(n);return{c(){s.c(),t=P()},m(n,e){s.m(n,e),y(n,t,e)},p(n,o){i===(i=e(n))&&s?s.p(n,o):(s.d(1),s=i(n),s&&(s.c(),s.m(t.parentNode,t)))},d(n){n&&x(t),s.d(n)}}}function Nl(t){let e,i,s;return{c(){e=A("button"),e.textContent="維基"},m(n,o){y(n,e,o),i||(s=I(e,"click",t[11]),i=!0)},p:n,d(n){n&&x(e),i=!1,s()}}}function El(n){let t,e,i;return{c(){t=A("a"),e=C("維基"),T(t,"target","_new"),T(t,"href",i=n[7](n[18]))},m(n,i){y(n,t,i),b(t,e)},p(n,e){1&e&&i!==(i=n[7](n[18]))&&T(t,"href",i)},d(n){n&&x(t)}}}function zl(n){let t,e,i,s,o,r,l,c,a,u=n[18]+"",d=n[20]==n[1]&&Pl(n);return l=_(n[14][0]),{c(){t=A("span"),e=A("label"),i=A("input"),s=C(u),o=O(),d&&d.c(),r=O(),T(i,"type","radio"),T(i,"name","dict"),i.__value=n[20],N(i,i.__value),L(t,"dictgroup",n[20]==n[1]),l.p(i)},m(l,u){y(l,t,u),b(t,e),b(e,i),i.checked=i.__value===n[1],b(e,s),b(t,o),d&&d.m(t,null),b(t,r),c||(a=I(i,"change",n[13]),c=!0)},p(n,e){3&e&&(i.checked=i.__value===n[1]),1&e&&u!==(u=n[18]+"")&&S(s,u),n[20]==n[1]?d?d.p(n,e):(d=Pl(n),d.c(),d.m(t,r)):d&&(d.d(1),d=null),2&e&&L(t,"dictgroup",n[20]==n[1])},d(n){n&&x(t),d&&d.d(),l.r(),c=!1,a()}}}function Ll(n){let t,e;return{c(){t=A("iframe"),E(t,"border","none"),T(t,"class","iframe svelte-q5fwfc"),T(t,"title","wiki"),u(t.src,e=n[5])||T(t,"src",e)},m(n,e){y(n,t,e)},p(n,i){32&i&&!u(t.src,e=n[5])&&T(t,"src",e)},d(n){n&&x(t)}}}function Ml(t){let e;function i(n,t){return n[0].length?Ol:Cl}let s=i(t),o=s(t);return{c(){e=A("div"),o.c(),T(e,"class","dictpopup bodytext svelte-q5fwfc")},m(n,t){y(n,e,t),o.m(e,null)},p(n,[t]){s===(s=i(n))&&o?o.p(n,t):(o.d(1),o=s(n),o&&(o.c(),o.m(e,null)))},i:n,o:n,d(n){n&&x(e),o.d()}}}function jl(n,t,e){let i;h(n,so,(n=>e(15,i=n)));let s,o,r,{entries:l=[]}=t,c=0,a="",u="";const d=n=>"https://zh.wikipedia.org/w/index.php?action=render&title="+encodeURIComponent(n),f=n=>"https://buddhaspace.org/dict/index.php?keyword="+encodeURIComponent(n),p=()=>{l[c]||e(1,c=0);const n=l[c][1];e(6,u="wikipedia"),e(5,a=d(n))},g=()=>{l[c]||e(1,c=0);const n=l[c][1];e(6,u="oneline"),e(5,a=f(n))};return n.$$set=n=>{"entries"in n&&e(0,l=n.entries)},n.$$.update=()=>{3&n.$$.dirty&&(n=>{if(n>=l.length&&(n=0),!l[n])return;const t=l[n][2],c=Ki(i).columns.entries.dict[t];e(2,s=1&c),e(3,o=2&c),e(4,r=4&c),o||r?g():s&&p()})(c)},[l,c,s,o,r,a,u,d,f,n=>"https://www.google.com/search?q="+encodeURIComponent(n),n=>"https://www.baidu.com/s?wd="+encodeURIComponent(n),p,g,function(){c=this.__value,e(1,c)},[[]]]}class Fl extends $n{constructor(n){super(),mn(this,n,jl,Ml,r,{entries:0})}}function Bl(n,t,e){const i=n.slice();return i[7]=t[e][0],i[8]=t[e][1],i}function ql(n){let t,e,i;function s(){return n[4](n[7])}return{c(){t=A("span"),t.textContent=`${dr[n[8]]}`,T(t,"aria-hidden","true")},m(n,o){y(n,t,o),e||(i=I(t,"click",s),e=!0)},p(t,e){n=t},d(n){n&&x(t),e=!1,i()}}}function Rl(t){let e,i=ln(t[0]),s=[];for(let n=0;n<i.length;n+=1)s[n]=ql(Bl(t,i,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=P()},m(n,t){for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,t);y(n,e,t)},p(n,[t]){if(3&t){let o;for(i=ln(n[0]),o=0;o<i.length;o+=1){const r=Bl(n,i,o);s[o]?s[o].p(r,t):(s[o]=ql(r),s[o].c(),s[o].m(e.parentNode,e))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:n,o:n,d(n){n&&x(e),w(s,n)}}}function Hl(n,t,e){let i;h(n,go,(n=>e(5,i=n)));let{folioid:s}=t,{closePopup:o}=t,r=[];const l=i[s];for(let n in l)l[n]&&r.push([parseInt(n),l[n]]);const c=n=>{kr(s,(()=>{ao.set(n)})),o()};return n.$$set=n=>{"folioid"in n&&e(2,s=n.folioid),"closePopup"in n&&e(3,o=n.closePopup)},[r,c,s,o,n=>c(n)]}class Ul extends $n{constructor(n){super(),mn(this,n,Hl,Rl,r,{folioid:2,closePopup:3})}}const Wl={FAWANG:{title:"法王講堂",www:"http://fawang.com.tw/main1_0.htm"},FAYUN:{title:"法雲寺",www:"https://dcm.org.tw/"},YAP:{title:"作者",www:"https://nissaya.cn/"},HAIYIN:{title:"金門海印寺",www:"https://kinmen.travel/zh-tw/travel/attraction/401"}},Dl=n=>(Wl[f(To)]||{})[n]||"";function Kl(n){let t,e,i=wl("公眾版本")+"";return{c(){t=C(i),e=C("※※")},m(n,i){y(n,t,i),y(n,e,i)},d(n){n&&(x(t),x(e))}}}function Jl(t){let e,i,s,o,r,l=Dl("title",t[0])+"",c=!t[0]&&Kl();return{c(){e=A("div"),i=C("※"),s=A("a"),o=C(l),r=C("※\n"),c&&c.c(),T(s,"target","_new"),T(s,"href",Dl("www")),T(e,"class","endmarker")},m(n,t){y(n,e,t),b(e,i),b(e,s),b(s,o),b(e,r),c&&c.m(e,null)},p(n,[t]){1&t&&l!==(l=Dl("title",n[0])+"")&&S(o,l),n[0]?c&&(c.d(1),c=null):c||(c=Kl(),c.c(),c.m(e,null))},i:n,o:n,d(n){n&&x(e),c&&c.d()}}}function Yl(n,t,e){let i;return h(n,To,(n=>e(0,i=n))),[i]}class Ql extends $n{constructor(n){super(),mn(this,n,Yl,Jl,r,{})}}function Vl(n,t,e){const i=n.slice();return i[32]=t[e][0],i[33]=t[e][1],i[34]=t[e][2],i}function Gl(n,t,e){const i=n.slice();return i[37]=t[e],i}function Xl(t){let e,i,s,o,r,l,c,a="ylz-vny"==t[1]&&nc();return{c(){e=A("div"),i=A("span"),s=C("安裝 "),o=C(t[2]),r=O(),a&&a.c(),T(i,"aria-hidden","true"),T(i,"class","clickable hyperlink"),T(e,"class","bodytext")},m(n,u){y(n,e,u),b(e,i),b(i,s),b(i,o),b(e,r),a&&a.m(e,null),l||(c=I(i,"click",t[25]),l=!0)},p(n,t){4&t[0]&&S(o,n[2]),"ylz-vny"==n[1]?a||(a=nc(),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:n,o:n,d(n){n&&x(e),a&&a.d(),l=!1,c()}}}function Zl(n){let t,e,i,s=n[4]&&tc(n),o=ln(n[3]),r=[];for(let t=0;t<o.length;t+=1)r[t]=rc(Vl(n,o,t));const l=n=>rn(r[n],1,1,(()=>{r[n]=null}));return{c(){s&&s.c(),t=O();for(let n=0;n<r.length;n+=1)r[n].c();e=P()},m(n,o){s&&s.m(n,o),y(n,t,o);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(n,o);y(n,e,o),i=!0},p(n,i){if(n[4]?s?s.p(n,i):(s=tc(n),s.c(),s.m(t.parentNode,t)):s&&(s.d(1),s=null),64507&i[0]){let t;for(o=ln(n[3]),t=0;t<o.length;t+=1){const s=Vl(n,o,t);r[t]?(r[t].p(s,i),on(r[t],1)):(r[t]=rc(s),r[t].c(),on(r[t],1),r[t].m(e.parentNode,e))}for(en(),t=o.length;t<r.length;t+=1)l(t);sn()}},i(n){if(!i){for(let n=0;n<o.length;n+=1)on(r[n]);i=!0}},o(n){r=r.filter(Boolean);for(let n=0;n<r.length;n+=1)rn(r[n]);i=!1},d(n){n&&(x(t),x(e)),s&&s.d(n),w(r,n)}}}function nc(n){let t,e,i=wl("包含聲聞戒律，在家居士閱讀應有充份理由。")+"";return{c(){t=A("br"),e=C(i)},m(n,i){y(n,t,i),y(n,e,i)},d(n){n&&(x(t),x(e))}}}function tc(n){let t,e,i,s,o;return{c(){t=C(n[4]),e=O(),i=A("span"),i.textContent="Cancel",T(i,"aria-hidden","true")},m(r,l){y(r,t,l),y(r,e,l),y(r,i,l),s||(o=I(i,"click",n[10]()),s=!0)},p(n,e){16&e[0]&&S(t,n[4])},d(n){n&&(x(t),x(e),x(i)),s=!1,o()}}}function ec(n){let t,e,i;return{c(){t=A("span"),t.textContent="Download All",T(t,"aria-hidden","true")},m(s,r){y(s,t,r),e||(i=I(t,"click",(function(){o(n[11](n[33]))&&n[11](n[33]).apply(this,arguments)})),e=!0)},p(t,e){n=t},d(n){n&&x(t),e=!1,i()}}}function ic(n){let t,e,i,s,o,r,l,c=n[13](n[37])+"";function a(){return n[24](n[37])}return s=new Ul({props:{folioid:n[14](n[37]),closePopup:n[0]}}),{c(){t=A("span"),e=C(c),i=O(),fn(s.$$.fragment),T(t,"aria-hidden","true"),T(t,"class","parallelfolio"),L(t,"dimmed",!n[7][n[14](n[37])]),L(t,"selecteditem",n[8]==n[14](n[37]))},m(n,c){y(n,t,c),b(t,e),y(n,i,c),hn(s,n,c),o=!0,r||(l=I(t,"click",a),r=!0)},p(i,r){n=i,(!o||8&r[0])&&c!==(c=n[13](n[37])+"")&&S(e,c),(!o||16520&r[0])&&L(t,"dimmed",!n[7][n[14](n[37])]),(!o||16648&r[0])&&L(t,"selecteditem",n[8]==n[14](n[37]));const l={};8&r[0]&&(l.folioid=n[14](n[37])),1&r[0]&&(l.closePopup=n[0]),s.$set(l)},i(n){o||(on(s.$$.fragment,n),o=!0)},o(n){rn(s.$$.fragment,n),o=!1},d(n){n&&(x(t),x(i)),pn(s,n),r=!1,l()}}}function sc(n){let t,e,i=n[7][n[14](n[37])]||n[6],s=i&&ic(n);return{c(){s&&s.c(),t=P()},m(n,i){s&&s.m(n,i),y(n,t,i),e=!0},p(n,e){200&e[0]&&(i=n[7][n[14](n[37])]||n[6]),i?s?(s.p(n,e),200&e[0]&&on(s,1)):(s=ic(n),s.c(),on(s,1),s.m(t.parentNode,t)):s&&(en(),rn(s,1,1,(()=>{s=null})),sn())},i(n){e||(on(s),e=!0)},o(n){rn(s),e=!1},d(n){n&&x(t),s&&s.d(n)}}}function oc(n){let t,e,i,s,o,r,l,c,a,u,d=n[13](n[32])+"",f="YAP"==n[9]&&!n[4]&&n[15](n[8],n[33])&&gr(Ki(n[1]),n[33]).length>1;function h(){return n[23](n[32])}let p=f&&ec(n);o=new Ul({props:{folioid:n[33],closePopup:n[0]}});let g=ln(n[34]),m=[];for(let t=0;t<g.length;t+=1)m[t]=sc(Gl(n,g,t));const $=n=>rn(m[n],1,1,(()=>{m[n]=null}));return{c(){t=A("span"),e=C(d),i=O(),p&&p.c(),s=O(),fn(o.$$.fragment),r=O();for(let n=0;n<m.length;n+=1)m[n].c();l=P(),T(t,"aria-hidden","true"),L(t,"dimmed",!n[7][n[33]]),L(t,"selecteditem",n[15](n[8],n[33]))},m(n,d){y(n,t,d),b(t,e),y(n,i,d),p&&p.m(n,d),y(n,s,d),hn(o,n,d),y(n,r,d);for(let t=0;t<m.length;t+=1)m[t]&&m[t].m(n,d);y(n,l,d),c=!0,a||(u=I(t,"click",h),a=!0)},p(i,r){n=i,(!c||8&r[0])&&d!==(d=n[13](n[32])+"")&&S(e,d),(!c||136&r[0])&&L(t,"dimmed",!n[7][n[33]]),(!c||33032&r[0])&&L(t,"selecteditem",n[15](n[8],n[33])),794&r[0]&&(f="YAP"==n[9]&&!n[4]&&n[15](n[8],n[33])&&gr(Ki(n[1]),n[33]).length>1),f?p?p.p(n,r):(p=ec(n),p.c(),p.m(s.parentNode,s)):p&&(p.d(1),p=null);const a={};if(8&r[0]&&(a.folioid=n[33]),1&r[0]&&(a.closePopup=n[0]),o.$set(a),29129&r[0]){let t;for(g=ln(n[34]),t=0;t<g.length;t+=1){const e=Gl(n,g,t);m[t]?(m[t].p(e,r),on(m[t],1)):(m[t]=sc(e),m[t].c(),on(m[t],1),m[t].m(l.parentNode,l))}for(en(),t=g.length;t<m.length;t+=1)$(t);sn()}},i(n){if(!c){on(o.$$.fragment,n);for(let n=0;n<g.length;n+=1)on(m[n]);c=!0}},o(n){rn(o.$$.fragment,n),m=m.filter(Boolean);for(let n=0;n<m.length;n+=1)rn(m[n]);c=!1},d(n){n&&(x(t),x(i),x(s),x(r),x(l)),p&&p.d(n),pn(o,n),w(m,n),a=!1,u()}}}function rc(t){let e,i,s,o=t[5],l=oc(t);return{c(){e=A("div"),l.c(),i=O(),T(e,"class","book")},m(n,t){y(n,e,t),l.m(e,null),b(e,i),s=!0},p(t,s){32&s[0]&&r(o,o=t[5])?(en(),rn(l,1,1,n),sn(),l=oc(t),l.c(),on(l,1),l.m(e,i)):l.p(t,s)},i(n){s||(on(l),s=!0)},o(n){rn(l),s=!1},d(n){n&&x(e),l.d(n)}}}function lc(n){let t,e,i,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,w,P,_,N=wl("懺儀",n[5])+"",E=wl("聲聞",n[5])+"";const z=[Zl,Xl],M=[];function j(n,t){return n[3].length?0:1}return g=j(n),m=M[g]=z[g](n),k=new Ql({}),{c(){t=A("div"),e=A("span"),e.textContent="唯名",i=O(),o=A("span"),o.textContent="唯心",r=O(),l=A("span"),c=C(N),a=O(),u=A("span"),d=C(E),f=O(),h=A("span"),h.textContent="戒律",p=O(),m.c(),$=O(),v=A("div"),fn(k.$$.fragment),T(e,"aria-hidden","true"),T(e,"class","clickable"),L(e,"selected","ylz-prjn"==n[1]),T(o,"aria-hidden","true"),T(o,"class","clickable"),L(o,"selected","ylz-tg"==n[1]),T(l,"aria-hidden","true"),T(l,"class","clickable"),L(l,"selected","ylz-rite"==n[1]),T(u,"aria-hidden","true"),T(u,"class","clickable"),L(u,"selected","ylz-svk"==n[1]),T(h,"aria-hidden","true"),T(h,"class","clickable"),L(h,"selected","ylz-vny"==n[1]),T(t,"class","tabs"),T(v,"class","bodytext")},m(s,m){y(s,t,m),b(t,e),b(t,i),b(t,o),b(t,r),b(t,l),b(l,c),b(t,a),b(t,u),b(u,d),b(t,f),b(t,h),y(s,p,m),M[g].m(s,m),y(s,$,m),y(s,v,m),hn(k,v,null),w=!0,P||(_=[I(e,"click",n[18]),I(o,"click",n[19]),I(l,"click",n[20]),I(u,"click",n[21]),I(h,"click",n[22])],P=!0)},p(n,t){(!w||2&t[0])&&L(e,"selected","ylz-prjn"==n[1]),(!w||2&t[0])&&L(o,"selected","ylz-tg"==n[1]),(!w||32&t[0])&&N!==(N=wl("懺儀",n[5])+"")&&S(c,N),(!w||2&t[0])&&L(l,"selected","ylz-rite"==n[1]),(!w||32&t[0])&&E!==(E=wl("聲聞",n[5])+"")&&S(d,E),(!w||2&t[0])&&L(u,"selected","ylz-svk"==n[1]),(!w||2&t[0])&&L(h,"selected","ylz-vny"==n[1]);let i=g;g=j(n),g===i?M[g].p(n,t):(en(),rn(M[i],1,1,(()=>{M[i]=null})),sn(),m=M[g],m?m.p(n,t):(m=M[g]=z[g](n),m.c()),on(m,1),m.m($.parentNode,$))},i(n){w||(on(m),on(k.$$.fragment,n),w=!0)},o(n){rn(m),rn(k.$$.fragment,n),w=!1},d(n){n&&(x(t),x(p),x($),x(v)),M[g].d(n),pn(k),P=!1,s(_)}}}function cc(n,t,e){let i,s,o,r,l;h(n,_o,(n=>e(5,i=n))),h(n,eo,(n=>e(6,s=n))),h(n,oo,(n=>e(7,o=n))),h(n,uo,(n=>e(8,r=n))),h(n,To,(n=>e(9,l=n)));let{thetab:c}=t,{closePopup:a=function(){}}=t,u="",d=[],f="";const p=async n=>{const t=await Gr(Qs,n+".ptk",(t=>{e(2,u=n+".ptk "+t)})),i=await t.arrayBuffer(),s=await Di(n,new Uint8Array(i));return Fs(s),s};let g=(()=>{const n=r;let t="ylz-prjn";const e=Ae();for(let i=0;i<e.length;i++){const s=e[i].defines.folio;s&&(~s.fields.id.values.indexOf(n)&&(t=e[i].name))}return t})();const m=async n=>{if(!~(await(async()=>{const n=await caches.open(Qs);return(await n.keys()).filter((n=>~n.url.indexOf(".ptk"))).map((n=>n.url.match(/([a-z\-_]+)\.ptk/)[1]))})()).indexOf(n))return void e(3,d=[]);const t=await p(n),i=t.defines.folio,s=[];for(let n=0;n<i.linepos.length;n++){const e=i.fields.id.values[n],o=e.match(/(\d+)$/),r=e.indexOf("_");~r&&e.slice(0,r),~r||o&&"1"!=o[1]||s.push([n,e,or(t,e)])}e(3,d=s)},$=n=>{const t=Ki(g).defines.folio.fields.id.values[n];so.set(g),(o[t]||s)&&(Zo(),kr(t,(function(){e(17,c="toc"),ao.set("1")})),a())};let v=!1;const k=async n=>{if(v)return;v=!0,e(2,u="try to download "+n+".ptk");const t=await p(n);return v=!1,e(2,u=""),m(n),t};return n.$$set=n=>{"thetab"in n&&e(17,c=n.thetab),"closePopup"in n&&e(0,a=n.closePopup)},n.$$.update=()=>{2&n.$$.dirty[0]&&m(g)},[a,g,u,d,f,i,s,o,r,l,()=>{},async function(n){const t=gr(Ki(g),n);for(let n of t){const t=n+".zip";console.log("downloading",t),await Gr(Qs,"folio/"+t,(n=>{e(4,f=t+" "+n),console.log(n)}))}e(4,f="")},$,n=>{const t=Ki(g).defines.folio;return wl(t._innertext.get(n),i)},n=>Ki(g).defines.folio.fields.id.values[n],(n,t)=>n.replace(/\d+$/,"")==t.replace(/\d+$/,""),k,c,()=>e(1,g="ylz-prjn"),()=>e(1,g="ylz-tg"),()=>e(1,g="ylz-rite"),()=>e(1,g="ylz-svk"),()=>e(1,g="ylz-vny"),n=>$(n),n=>$(n),()=>k(g)]}class ac extends $n{constructor(n){super(),mn(this,n,cc,lc,r,{thetab:17,closePopup:0},null,[-1,-1])}}function uc(n){const t=function(n){const t=function(n){const t=n.parentNode;return function(e){const{left:i,width:s}=t.getBoundingClientRect(),o="touches"in e?e.touches[0].clientX:e.clientX,r=Math.min(Math.max((o-i)/s,0),1)||0;n.dispatchEvent(new CustomEvent("drag",{detail:r}))}}(n);return function(e){e.preventDefault(),n.dispatchEvent(new CustomEvent("dragstart"));const i="touches"in e?"touchmove":"mousemove",s="touches"in e?"touchend":"mouseup";function o(e){e.stopPropagation(),document.removeEventListener(i,t),document.removeEventListener(s,o),n.dispatchEvent(new CustomEvent("dragend"))}document.addEventListener(i,t),document.addEventListener(s,o)}}(n);return n.addEventListener("touchstart",t),n.addEventListener("mousedown",t),{destroy(){n.removeEventListener("touchstart",t),n.removeEventListener("mousedown",t)}}}function fc(t){let e,i,r,l,c,a;const u=t[4].default,d=p(u,t,t[3],null);return{c(){e=A("div"),i=A("div"),d&&d.c(),T(i,"class","thumb-content svelte-8w8x88"),L(i,"active",t[1]),T(e,"class","thumb svelte-8w8x88"),T(e,"style",r=`left: ${100*t[0]}%;`)},m(s,r){var u;y(s,e,r),b(e,i),d&&d.m(i,null),l=!0,c||(a=[(u=uc.call(null,e),u&&o(u.destroy)?u.destroy:n),I(e,"dragstart",t[5]),I(e,"drag",t[6]),I(e,"dragend",t[7])],c=!0)},p(n,[t]){d&&d.p&&(!l||8&t)&&$(d,u,n,n[3],l?m(u,n[3],t,null):v(n[3]),null),(!l||2&t)&&L(i,"active",n[1]),(!l||1&t&&r!==(r=`left: ${100*n[0]}%;`))&&T(e,"style",r)},i(n){l||(on(d,n),l=!0)},o(n){rn(d,n),l=!1},d(n){n&&x(e),d&&d.d(n),c=!1,s(a)}}}function hc(n,t,e){let{$$slots:i={},$$scope:s}=t;const o=R();let r,{pos:l}=t;return n.$$set=n=>{"pos"in n&&e(0,l=n.pos),"$$scope"in n&&e(3,s=n.$$scope)},[l,r,o,s,i,()=>(e(1,r=!0),o("active",!0)),({detail:n})=>e(0,l=n),()=>(e(1,r=!1),o("active",!1))]}class pc extends $n{constructor(n){super(),mn(this,n,hc,fc,r,{pos:0})}}const gc=n=>({}),mc=n=>({}),$c=n=>({}),vc=n=>({});function kc(t){let e;const i=t[11].default,s=p(i,t,t[14],null),o=s||function(){let t;return{c(){t=A("div"),T(t,"class","thumb svelte-giohkn")},m(n,e){y(n,t,e)},p:n,d(n){n&&x(t)}}}();return{c(){o&&o.c()},m(n,t){o&&o.m(n,t),e=!0},p(n,t){s&&s.p&&(!e||16384&t)&&$(s,i,n,n[14],e?m(i,n[14],t,null):v(n[14]),null)},i(n){e||(on(o,n),e=!0)},o(n){rn(o,n),e=!1},d(n){o&&o.d(n)}}}function bc(n){let t;const e=n[11].left,i=p(e,n,n[14],vc),s=i||kc(n);return{c(){s&&s.c()},m(n,e){s&&s.m(n,e),t=!0},p(n,o){i?i.p&&(!t||16384&o)&&$(i,e,n,n[14],t?m(e,n[14],o,$c):v(n[14]),vc):s&&s.p&&(!t||16384&o)&&s.p(n,t?o:-1)},i(n){t||(on(s,n),t=!0)},o(n){rn(s,n),t=!1},d(n){s&&s.d(n)}}}function yc(n){let t,e,i,s,o,r,l,c,a,u,d,f,h,g;function k(t){n[12](t)}let w={$$slots:{default:[bc]},$$scope:{ctx:n}};void 0!==n[2][0]&&(w.pos=n[2][0]),a=new pc({props:w}),U.push((()=>dn(a,"pos",k))),a.$on("active",n[13]);const C=n[11].caption,P=p(C,n,n[14],mc);return{c(){t=A("div"),e=A("input"),o=O(),r=A("div"),l=A("div"),c=O(),fn(a.$$.fragment),d=O(),P&&P.c(),T(e,"type","number"),e.value=i=n[0][0],T(e,"name",s=n[1][0]),T(e,"class","svelte-giohkn"),T(l,"class","progress svelte-giohkn"),T(l,"style",n[4]),T(r,"aria-hidden","true"),T(r,"class","track svelte-giohkn")},m(i,s){y(i,t,s),b(t,e),b(t,o),b(t,r),b(r,l),b(r,c),hn(a,r,null),b(r,d),P&&P.m(r,null),f=!0,h||(g=I(r,"click",n[5]),h=!0)},p(n,[t]){(!f||1&t&&i!==(i=n[0][0])&&e.value!==i)&&(e.value=i),(!f||2&t&&s!==(s=n[1][0]))&&T(e,"name",s),(!f||16&t)&&T(l,"style",n[4]);const o={};16384&t&&(o.$$scope={dirty:t,ctx:n}),!u&&4&t&&(u=!0,o.pos=n[2][0],Q((()=>u=!1))),a.$set(o),P&&P.p&&(!f||16384&t)&&$(P,C,n,n[14],f?m(C,n[14],t,gc):v(n[14]),mc)},i(n){f||(on(a.$$.fragment,n),on(P,n),f=!0)},o(n){rn(a.$$.fragment,n),rn(P,n),f=!1},d(n){n&&x(t),pn(a),P&&P.d(n),h=!1,g()}}}function xc(n,t,e){let i,{$$slots:s={},$$scope:o}=t;const r=R();let{name:l=[]}=t,{range:c=!1}=t,{min:a=0}=t,{max:u=100}=t,{step:d=1}=t,{value:f=[a,u]}=t,h=[0,0],p=!1,{order:g=!1}=t;function m(n){console.log("setvalue",n),n&&2===n.length&&Array.isArray(n)||(n=[a,u]);const t=a%d,i=u-a;e(0,f=n.map((n=>a+n*i)).map((n=>Math.round((n-t)/d)*d+t))),r("input",f)}function $(n){n&&2===n.length&&Array.isArray(n)||(n=[a,u]),e(2,h=n.map((n=>Math.min(Math.max(n,a),u))).map((n=>(n-a)/(u-a))))}return n.$$set=n=>{"name"in n&&e(1,l=n.name),"range"in n&&e(6,c=n.range),"min"in n&&e(7,a=n.min),"max"in n&&e(8,u=n.max),"step"in n&&e(9,d=n.step),"value"in n&&e(0,f=n.value),"order"in n&&e(10,g=n.order),"$$scope"in n&&e(14,o=n.$$scope)},n.$$.update=()=>{1100&n.$$.dirty&&c&&g&&p&&e(2,h=function(n){return[Math.min(...n),Math.max(...n)]}(h)),12&n.$$.dirty&&p&&m(h),9&n.$$.dirty&&(p||$(f)),68&n.$$.dirty&&e(4,i=`\n    left: ${c?100*Math.min(h[0],h[1]):0}%;\n    right: ${100-100*Math.max(h[0],c?h[1]:h[0])||100}%;\n  `)},[f,l,h,p,i,function(n){"progress"==n.target.classList[0]?($([(f[0]||a)-d,f[1]]),m(h)):"track"==n.target.classList[0]&&($([(f[0]||a)+d,f[1]]),m(h))},c,a,u,d,g,s,function(t){n.$$.not_equal(h[0],t)&&(h[0]=t,e(2,h),e(6,c),e(10,g),e(3,p))},({detail:n})=>e(3,p=n),o]}class wc extends $n{constructor(n){super(),mn(this,n,xc,yc,r,{name:1,range:6,min:7,max:8,step:9,value:0,order:10})}}function Ac(n,t,e){const i=n.slice();return i[9]=t[e],i}function Cc(n){let t,e,i,s,o,r=ln(n[3]),l=[];for(let t=0;t<r.length;t+=1)l[t]=Ic(Ac(n,r,t));return{c(){t=A("span"),e=A("span"),i=A("span"),s=C(n[1]),o=O();for(let n=0;n<l.length;n+=1)l[n].c();T(i,"class","legend"),T(i,"id",`label-${n[5]}`),T(e,"role","radiogroup"),T(e,"class","group-container svelte-jwpg1d"),T(e,"aria-labelledby",`label-${n[5]}`),T(e,"id",`group-${n[5]}`),T(t,"class","s s--multi svelte-jwpg1d")},m(n,r){y(n,t,r),b(t,e),b(e,i),b(i,s),b(e,o);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(e,null)},p(n,t){if(2&t&&S(s,n[1]),41&t){let i;for(r=ln(n[3]),i=0;i<r.length;i+=1){const s=Ac(n,r,i);l[i]?l[i].p(s,t):(l[i]=Ic(s),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=r.length}},d(n){n&&x(t),w(l,n)}}}function Oc(n){let t,e,i,s,o,r,l;return{c(){t=A("span"),e=A("span"),i=C(n[1]),s=O(),o=A("button"),T(e,"id",`switch-${n[5]}`),T(o,"role","switch"),T(o,"aria-checked",n[4]),T(o,"aria-labelledby",`switch-${n[5]}`),T(o,"class","svelte-jwpg1d"),T(t,"class","s s--slider svelte-jwpg1d")},m(c,a){y(c,t,a),b(t,e),b(e,i),b(t,s),b(t,o),r||(l=I(o,"click",n[6]),r=!0)},p(n,t){2&t&&S(i,n[1]),16&t&&T(o,"aria-checked",n[4])},d(n){n&&x(t),r=!1,l()}}}function Pc(n){let t,e,i,s,o,r,l,c,a,u;return{c(){t=A("div"),e=A("span"),i=C(n[1]),s=O(),o=A("button"),r=A("span"),r.textContent="on",l=O(),c=A("span"),c.textContent="off",T(e,"id",`switch-${n[5]}`),T(e,"class","svelte-jwpg1d"),T(r,"class","svelte-jwpg1d"),T(c,"class","svelte-jwpg1d"),T(o,"role","switch"),T(o,"aria-checked",n[4]),T(o,"aria-labelledby",`switch-${n[5]}`),T(o,"class","svelte-jwpg1d"),T(t,"class","s s--inner svelte-jwpg1d")},m(d,f){y(d,t,f),b(t,e),b(e,i),b(t,s),b(t,o),b(o,r),b(o,l),b(o,c),a||(u=I(o,"click",n[6]),a=!0)},p(n,t){2&t&&S(i,n[1]),16&t&&T(o,"aria-checked",n[4])},d(n){n&&x(t),a=!1,u()}}}function Ic(n){let t,e,i,s,o,r,l,c,a,u,d,f=!1,h=n[9]+"";return a=_(n[8][0]),{c(){t=A("input"),s=O(),o=A("label"),r=C(h),l=O(),T(t,"type","radio"),T(t,"id",e=`${n[9]}-${n[5]}`),t.__value=i=n[9],N(t,t.__value),T(t,"class","svelte-jwpg1d"),T(o,"for",c=`${n[9]}-${n[5]}`),T(o,"class","svelte-jwpg1d"),a.p(t)},m(e,i){y(e,t,i),t.checked=t.__value===n[0],y(e,s,i),y(e,o,i),b(o,r),b(o,l),u||(d=I(t,"change",n[7]),u=!0)},p(n,s){8&s&&e!==(e=`${n[9]}-${n[5]}`)&&T(t,"id",e),8&s&&i!==(i=n[9])&&(t.__value=i,N(t,t.__value),f=!0),(f||9&s)&&(t.checked=t.__value===n[0]),8&s&&h!==(h=n[9]+"")&&S(r,h),8&s&&c!==(c=`${n[9]}-${n[5]}`)&&T(o,"for",c)},d(n){n&&(x(t),x(s),x(o)),a.r(),u=!1,d()}}}function Tc(t){let e;function i(n,t){return"inner"==n[2]?Pc:"slider"==n[2]?Oc:Cc}let s=i(t),o=s(t);return{c(){o.c(),e=P()},m(n,t){o.m(n,t),y(n,e,t)},p(n,[t]){s===(s=i(n))&&o?o.p(n,t):(o.d(1),o=s(n),o&&(o.c(),o.m(e.parentNode,e)))},i:n,o:n,d(n){n&&x(e),o.d(n)}}}function _c(n,t,e){let{label:i}=t,{design:s="inner label"}=t,{options:o=[]}=t,{value:r="on"}=t,l="on"==r;const c=Math.floor(100*Math.random());return n.$$set=n=>{"label"in n&&e(1,i=n.label),"design"in n&&e(2,s=n.design),"options"in n&&e(3,o=n.options),"value"in n&&e(0,r=n.value)},[r,i,s,o,l,c,function(n){const t=n.target.getAttribute("aria-checked");e(4,l="true"!==t),e(0,r=!0===l?"on":"off")},function(){r=this.__value,e(0,r)},[[]]]}class Sc extends $n{constructor(n){super(),mn(this,n,_c,Tc,r,{label:1,design:2,options:3,value:0})}}function Nc(n,t,e){const i=n.slice();return i[38]=t[e],i[40]=e,i}function Ec(n){let t,e,i;return{c(){t=A("span"),T(t,"aria-hidden","true")},m(s,r){y(s,t,r),t.innerHTML='<svg style="margin-bottom:-0.2em" height="4vh" width="4vh" viewBox="0 0 461.001 461.001"><g><path style="fill:#F61C0D;" d="M365.257,67.393H95.744C42.866,67.393,0,110.259,0,163.137v134.728c0,52.878,42.866,95.744,95.744,95.744h269.513c52.878,0,95.744-42.866,95.744-95.744V163.137C461.001,110.259,418.135,67.393,365.257,67.393z M300.506,237.056l-126.06,60.123c-3.359,1.602-7.239-0.847-7.239-4.568V168.607c0-3.774,3.982-6.22,7.348-4.514l126.06,63.881C304.363,229.873,304.298,235.248,300.506,237.056z"/></g></svg>',e||(i=I(t,"click",(function(){o(n[18](n[38].youtube))&&n[18](n[38].youtube).apply(this,arguments)})),e=!0)},p(t,e){n=t},d(n){n&&x(t),e=!1,i()}}}function zc(n){let t,e,i,s,o,r,l,c,a,u=wl(n[38].performer)+" ";function d(){return n[23](n[38])}let f=n[5]==n[38].aid&&Mc(n),h=n[0]==n[38].vid&&n[0]&&jc(n);return{c(){t=A("span"),e=C(u),i=A("span"),s=O(),f&&f.c(),o=O(),h&&h.c(),r=O(),l=A("br"),T(t,"class","uncache"),T(i,"aria-hidden","true"),T(i,"class","clickable")},m(n,u){y(n,t,u),b(t,e),y(n,i,u),i.innerHTML='<svg width="32px" height="32px" viewBox="0 0 24 24" fill="none"><path d="M12 16L12 8" stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M9 13L11.913 15.913V15.913C11.961 15.961 12.039 15.961 12.087 15.913V15.913L15 13" stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M3 15L3 16L3 19C3 20.1046 3.89543 21 5 21L19 21C20.1046 21 21 20.1046 21 19L21 16L21 15" stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',y(n,s,u),f&&f.m(n,u),y(n,o,u),h&&h.m(n,u),y(n,r,u),y(n,l,u),c||(a=I(i,"click",d),c=!0)},p(t,i){n=t,512&i[0]&&u!==(u=wl(n[38].performer)+" ")&&S(e,u),n[5]==n[38].aid?f?f.p(n,i):(f=Mc(n),f.c(),f.m(o.parentNode,o)):f&&(f.d(1),f=null),n[0]==n[38].vid&&n[0]?h?h.p(n,i):(h=jc(n),h.c(),h.m(r.parentNode,r)):h&&(h.d(1),h=null)},d(n){n&&(x(t),x(i),x(s),x(o),x(r),x(l)),f&&f.d(n),h&&h.d(n),c=!1,a()}}}function Lc(n){let t,e,i,s,o,r,l,c=wl(n[38].performer)+"",a=n[40]&&n[38].aid==n[0]?"♫":"";function u(){return n[22](n[38])}return{c(){t=A("span"),e=C(c),i=C(a),s=O(),o=A("br"),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",n[38].aid==n[0])},m(n,c){y(n,t,c),b(t,e),b(t,i),y(n,s,c),y(n,o,c),r||(l=I(t,"click",u),r=!0)},p(s,o){n=s,512&o[0]&&c!==(c=wl(n[38].performer)+"")&&S(e,c),513&o[0]&&a!==(a=n[40]&&n[38].aid==n[0]?"♫":"")&&S(i,a),513&o[0]&&L(t,"selected",n[38].aid==n[0])},d(n){n&&(x(t),x(s),x(o)),r=!1,l()}}}function Mc(n){let t;return{c(){t=C(n[6])},m(n,e){y(n,t,e)},p(n,e){64&e[0]&&S(t,n[6])},d(n){n&&x(t)}}}function jc(n){let t,e=n[12](n[13](n[0]))+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){1&i[0]&&e!==(e=n[12](n[13](n[0]))+"")&&S(t,e)},d(n){n&&x(t)}}}function Fc(n){let t,e,i=n[40]&&!n[10]&&n[38].youtube&&Ec(n);function s(n,t){return n[38].incache||!n[38].aid?Lc:n[11]?zc:void 0}let o=s(n),r=o&&o(n);return{c(){i&&i.c(),t=O(),r&&r.c(),e=P()},m(n,s){i&&i.m(n,s),y(n,t,s),r&&r.m(n,s),y(n,e,s)},p(n,l){n[40]&&!n[10]&&n[38].youtube?i?i.p(n,l):(i=Ec(n),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null),o===(o=s(n))&&r?r.p(n,l):(r&&r.d(1),r=o&&o(n),r&&(r.c(),r.m(e.parentNode,e)))},d(n){n&&(x(t),x(e)),i&&i.d(n),r&&r.d(n)}}}function Bc(n){let t,e,i=n[1][0]/100+wl(" 播放速度")+"";return{c(){t=A("span"),e=C(i),T(t,"slot","caption"),E(t,"float","right")},m(n,i){y(n,t,i),b(t,e)},p(n,t){2&t[0]&&i!==(i=n[1][0]/100+wl(" 播放速度")+"")&&S(e,i)},d(n){n&&x(t)}}}function qc(t){let e,i,s;return{c(){e=A("span"),e.textContent=`${wl("恢復正常速度")}`,T(e,"aria-hidden","true"),T(e,"class","clickable")},m(n,o){y(n,e,o),i||(s=I(e,"click",t[20]),i=!0)},p:n,d(n){n&&x(e),i=!1,s()}}}function Rc(n){let t,e=n[17](n[2][0]*n[13](n[0]))+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){5&i[0]&&e!==(e=n[17](n[2][0]*n[13](n[0]))+"")&&S(t,e)},d(n){n&&x(t)}}}function Hc(n){let t,e,i;function s(t){n[26](t)}let o={label:wl("自動播放下一卷"),design:"slider"};return void 0!==n[8]&&(o.value=n[8]),t=new Sc({props:o}),U.push((()=>dn(t,"value",s))),{c(){fn(t.$$.fragment)},m(n,e){hn(t,n,e),i=!0},p(n,i){const s={};!e&&256&i[0]&&(e=!0,s.value=n[8],Q((()=>e=!1))),t.$set(s)},i(n){i||(on(t.$$.fragment,n),i=!0)},o(n){rn(t.$$.fragment,n),i=!1},d(n){pn(t,n)}}}function Uc(n){let t,e,i,s,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,P,I,_,N,E,z,L,M,j=wl("重播次數")+"",F=(n[2][0]>0?n[2][0]:wl("無限"))+"",B=n[7]&&br(n[7]).length>1,q=wl(n[14](n[4]))+"",R=wl(n[14](n[3]))+"",H=ln(n[9]),W=[];for(let t=0;t<H.length;t+=1)W[t]=Fc(Nc(n,H,t));function D(t){n[24](t)}let K={max:300,min:30,$$slots:{caption:[Bc]},$$scope:{ctx:n}};void 0!==n[1]&&(K.value=n[1]),o=new wc({props:K}),U.push((()=>dn(o,"value",D))),o.$on("input",kt(n[19],300));let J=100!==n[1][0]&&qc(n),Y=n[2][0]>0&&Rc(n);function V(t){n[25](t)}let G={min:"0",max:"10"};void 0!==n[2]&&(G.value=n[2]),m=new wc({props:G}),U.push((()=>dn(m,"value",V))),m.$on("input",n[16]);let X=B&&Hc(n);return L=new Ql({}),{c(){t=A("div");for(let n=0;n<W.length;n+=1)W[n].c();e=O(),i=A("br"),s=O(),fn(o.$$.fragment),l=O(),c=A("br"),a=O(),J&&J.c(),u=O(),d=C(j),f=C("："),h=C(F),p=O(),Y&&Y.c(),g=O(),fn(m.$$.fragment),v=O(),X&&X.c(),k=O(),P=A("hr"),I=O(),_=A("div"),N=O(),E=A("div"),z=O(),fn(L.$$.fragment),T(_,"class","subtitle"),T(E,"class","subtitle"),T(t,"class","bodytext")},m(n,r){y(n,t,r);for(let n=0;n<W.length;n+=1)W[n]&&W[n].m(t,null);b(t,e),b(t,i),b(t,s),hn(o,t,null),b(t,l),b(t,c),b(t,a),J&&J.m(t,null),b(t,u),b(t,d),b(t,f),b(t,h),b(t,p),Y&&Y.m(t,null),b(t,g),hn(m,t,null),b(t,v),X&&X.m(t,null),b(t,k),b(t,P),b(t,I),b(t,_),_.innerHTML=q,b(t,N),b(t,E),E.innerHTML=R,b(t,z),hn(L,t,null),M=!0},p(n,i){if(310881&i[0]){let s;for(H=ln(n[9]),s=0;s<H.length;s+=1){const o=Nc(n,H,s);W[s]?W[s].p(o,i):(W[s]=Fc(o),W[s].c(),W[s].m(t,e))}for(;s<W.length;s+=1)W[s].d(1);W.length=H.length}const s={};2&i[0]|1024&i[1]&&(s.$$scope={dirty:i,ctx:n}),!r&&2&i[0]&&(r=!0,s.value=n[1],Q((()=>r=!1))),o.$set(s),100!==n[1][0]?J?J.p(n,i):(J=qc(n),J.c(),J.m(t,u)):J&&(J.d(1),J=null),(!M||4&i[0])&&F!==(F=(n[2][0]>0?n[2][0]:wl("無限"))+"")&&S(h,F),n[2][0]>0?Y?Y.p(n,i):(Y=Rc(n),Y.c(),Y.m(t,g)):Y&&(Y.d(1),Y=null);const l={};!$&&4&i[0]&&($=!0,l.value=n[2],Q((()=>$=!1))),m.$set(l),128&i[0]&&(B=n[7]&&br(n[7]).length>1),B?X?(X.p(n,i),128&i[0]&&on(X,1)):(X=Hc(n),X.c(),on(X,1),X.m(t,k)):X&&(en(),rn(X,1,1,(()=>{X=null})),sn()),(!M||16&i[0])&&q!==(q=wl(n[14](n[4]))+"")&&(_.innerHTML=q),(!M||8&i[0])&&R!==(R=wl(n[14](n[3]))+"")&&(E.innerHTML=R)},i(n){M||(on(o.$$.fragment,n),on(m.$$.fragment,n),on(X),on(L.$$.fragment,n),M=!0)},o(n){rn(o.$$.fragment,n),rn(m.$$.fragment,n),rn(X),rn(L.$$.fragment,n),M=!1},d(n){n&&x(t),w(W,n),pn(o),J&&J.d(),Y&&Y.d(),pn(m),X&&X.d(),pn(L)}}}function Wc(n,t,e){let i,s,o,r,l,c,a,u,d,p,g;h(n,Uo,(n=>e(8,s=n))),h(n,jo,(n=>e(0,o=n))),h(n,ko,(n=>e(33,r=n))),h(n,uo,(n=>e(34,l=n))),h(n,Do,(n=>e(35,c=n))),h(n,No,(n=>e(36,a=n))),h(n,so,(n=>e(21,u=n))),h(n,zo,(n=>e(9,d=n))),h(n,Ro,(n=>e(10,p=n))),h(n,eo,(n=>e(11,g=n)));let m,$=[a||100,0],v=[c,0],k=[],b=[],y="",x="",w=0;q((()=>{clearInterval(m)}));let A=[];B((()=>{m=setInterval((()=>{if(!o)return;const n=Eo.currentTime;for(;n>=A[w]&&w<A.length;)e(3,y=k[w]||y||""),e(4,x=b[w]||x||""),w++;w>=A.length&&(w=0)}),500)}));let C="",O="";const P=async n=>{var t;e(5,C=n),await Gr(Qs,Zs+n+".mp3",(n=>{e(6,O=n)})),await(t=1e3,new Promise((n=>{setTimeout((()=>n()),t)})));const i=await to(l,zo,"on"==r);zo.set(i),e(5,C=""),e(6,O="")};return n.$$.update=()=>{2097152&n.$$.dirty[0]&&e(7,i=Ki(u)),1&n.$$.dirty[0]&&(async n=>{var t;if(e(4,x=e(3,y="")),b=[],k=[],!n)return;if(A=(null===(t=Xo(n,"timestamp_sanskrit"))||void 0===t?void 0:t.timestamp)||[],!(null==A?void 0:A.length))return;const s=Ki("dc_sanskrit");b=await s.fetchAddress("bk#"+l),k=await i.fetchAddress("bk#"+l),w=0})(o)},[o,$,v,y,x,C,O,i,s,d,p,g,n=>{if(!n)return"";const t=Math.floor(n/60);return`${t}:${n-60*t}`},n=>{var t;const e=null===(t=Xo(n))||void 0===t?void 0:t.timestamp;return e?e[e.length-1]-e[0]:0},n=>Wn(n)[0].replace(/[【《〔](.+?)[】》〕]/g,"<span class=bracket>$1 </span>"),P,()=>{const n=v[0];n&&f(Do)==v[0]||0==n&&-1==f(Do)||(0==n?Do.set(-1):Do.set(n))},n=>!n||"on"==s&&br(i).length>1?"":new Date(Date.now()+1e3*n).toLocaleTimeString()+"停止",n=>{Zo(),window.open("https://youtube.com/watch?v="+n,"_blank")},n=>{const t=n.detail[0];Eo.playbackRate=t/100,No.set(t)},()=>{e(1,$=[100,0]),Eo.playbackRate=1,No.set(100)},u,n=>!C&&rr(n.aid,!0),n=>!C&&P(n.aid),function(n){$=n,e(1,$)},function(n){v=n,e(2,v)},function(n){s=n,Uo.set(s)}]}class Dc extends $n{constructor(n){super(),mn(this,n,Wc,Uc,r,{},null,[-1,-1])}}function Kc(t){let e,i,s,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,w,C,P,I,_,S,N,E,z,L,M,j,F,B,q,R,H,U,W,D,K,J,Y,Q,V,G,X,Z,nn,tn,en,sn,ln,cn,an,un,dn,gn,mn,$n,vn,kn,bn,yn,xn;return yn=new Ql({}),{c(){e=A("div"),i=A("div"),i.textContent=`${wl("捐獻記錄。祈願諸護持者以此功德，獲得無量世出世間的利益。")}`,s=O(),o=A("div"),o.textContent="2023年",r=O(),l=A("table"),c=A("tr"),c.innerHTML="<td>陳碧吟</td><td>1.12</td><td>美元 1,000</td>",a=O(),u=A("tr"),d=A("td"),d.textContent="甯耀南",f=A("td"),f.textContent="5.21",h=A("td"),h.textContent=`${wl("台幣")}  10,000`,p=O(),g=A("tr"),m=A("td"),m.textContent=`${wl("葉雅柏")}`,$=A("td"),$.textContent="8.19",v=A("td"),v.textContent=`${wl("泰銖")}40,000`,k=O(),w=A("tr"),C=A("td"),C.textContent="李玉媚 ",P=A("td"),P.textContent="8.19 ",I=A("td"),I.textContent=`${wl("馬幣")} 5,000`,_=O(),S=A("tr"),N=A("td"),N.textContent="林嘉雯",E=A("td"),E.textContent="8.27 ",z=A("td"),z.textContent=`${wl("台幣")} 1,000`,L=O(),M=A("tr"),j=A("td"),j.textContent="法王講堂",F=A("td"),F.textContent="9.9 ",B=A("td"),B.textContent=`${wl("台幣")} 50,000`,q=O(),R=A("tr"),H=A("td"),H.textContent="施郁芳",U=A("td"),U.textContent="9.13",W=A("td"),W.textContent=`${wl("台幣")} 5,000`,D=O(),K=A("tr"),J=A("td"),J.textContent="天台精舍",Y=A("td"),Y.textContent="12.30",Q=A("td"),Q.textContent=`${wl("人民幣")} 5,000`,V=O(),G=A("br"),X=A("div"),X.textContent="2024年",Z=O(),nn=A("table"),tn=A("tr"),en=A("td"),en.textContent="金門福慧寺",sn=A("td"),sn.textContent="3.15",ln=A("td"),ln.textContent=`${wl("台幣")} 6,000`,cn=O(),an=A("br"),un=A("div"),un.textContent="2025年",dn=O(),gn=A("table"),mn=A("tr"),$n=A("td"),$n.textContent=`${wl("紅坊老黃")} `,vn=A("td"),vn.textContent="3.5",kn=A("td"),kn.textContent=`${wl("人民幣")} 2,000`,bn=O(),fn(yn.$$.fragment),T(m,"class","deceased")},m(n,t){y(n,e,t),b(e,i),b(e,s),b(e,o),b(e,r),b(e,l),b(l,c),b(l,a),b(l,u),b(u,d),b(u,f),b(u,h),b(l,p),b(l,g),b(g,m),b(g,$),b(g,v),b(l,k),b(l,w),b(w,C),b(w,P),b(w,I),b(l,_),b(l,S),b(S,N),b(S,E),b(S,z),b(l,L),b(l,M),b(M,j),b(M,F),b(M,B),b(l,q),b(l,R),b(R,H),b(R,U),b(R,W),b(l,D),b(l,K),b(K,J),b(K,Y),b(K,Q),b(e,V),b(e,G),b(e,X),b(e,Z),b(e,nn),b(nn,tn),b(tn,en),b(tn,sn),b(tn,ln),b(e,cn),b(e,an),b(e,un),b(e,dn),b(e,gn),b(gn,mn),b(mn,$n),b(mn,vn),b(mn,kn),b(e,bn),hn(yn,e,null),xn=!0},p:n,i(n){xn||(on(yn.$$.fragment,n),xn=!0)},o(n){rn(yn.$$.fragment,n),xn=!1},d(n){n&&x(e),pn(yn)}}}class Jc extends $n{constructor(n){super(),mn(this,n,null,Kc,r,{})}}function Yc(t){let e,i,s,o,r,l,c,a,u,d,f,h,p,g,m=wl("圖版裁切：釋通泉　張淑楨")+"",$=wl("分句標記：䆁常明　謝宇恆")+"",v=wl("時間戳記：林煴如　永航（韓語）")+"",k=wl("系統測試：")+"";return{c(){e=C(m),i=O(),s=A("hr"),o=O(),r=C($),l=O(),c=A("hr"),a=O(),u=C(v),d=O(),f=A("hr"),h=O(),p=C(k),g=C("桜井悟志(サトシ．サクライ)")},m(n,t){y(n,e,t),y(n,i,t),y(n,s,t),y(n,o,t),y(n,r,t),y(n,l,t),y(n,c,t),y(n,a,t),y(n,u,t),y(n,d,t),y(n,f,t),y(n,h,t),y(n,p,t),y(n,g,t)},p:n,i:n,o:n,d(n){n&&(x(e),x(i),x(s),x(o),x(r),x(l),x(c),x(a),x(u),x(d),x(f),x(h),x(p),x(g))}}}class Qc extends $n{constructor(n){super(),mn(this,n,null,Yc,r,{})}}function Vc(t){let e,i,s,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,w,O,P,I,_,S,N,E,z,L,M,j,F,B,q,R,H,U,W,D,K,J,Y,Q,V,G,X,Z,nn,tn,en,sn,ln,cn,an,un,dn,gn,mn,$n,vn,kn,bn,yn,xn,wn,An,Cn,On,Pn,In,Tn,_n,Sn,Nn;return Sn=new Ql({}),{c(){e=A("div"),i=A("a"),i.textContent="補版計劃",s=C("\n佛法是中華文明的三大組成部份(儒釋道)中唯一的非原生文明，佛經的翻譯和編修是大規模的文化交流工程，其在文明史的地位，不亞於阿拉伯的百年翻譯運動。\n"),o=A("br"),r=C("因此，以佛法為依托的文化符號，能夠將中華文明以較小的阻力，散播至儒家文化圈以外。\n"),l=A("br"),c=C("漢傳佛教徒素有勇於嘗試新科技的傳統，公元868年（唐咸通九年），在雕版印刷術萌芽之初，印行了金剛經（敦煌唐刻本），比歐洲早五百年。\n"),a=A("br"),u=C("日本於一百年前編修的大正藏，是近代較為齊全、廣為流通的版本。由於大正藏，以及收錄大量中國祖師著作的，卍續藏之成就，日本人可以自豪地宣稱，漢傳佛教的研究重心，已由中土轉移到東瀛。\n\n"),d=A("br"),f=C("生為炎黃子孫、身為三寶弟子，感謝日本為保存漢文佛經投入的努力，但以佛法流傳的角度而言，這是歷史的異常及脫軌(Abberation)，理由是：\n"),h=A("br"),p=C("一）大正藏係由學者主導，而自二千五百年前，佛陀入滅不久後的王舍城七葉窟結集以來，古今中外歷代翻譯編修佛經皆由僧團主持。\n"),g=A("br"),m=A("a"),m.textContent="大蔵出版株式会社",$=C("以編製校勘產生的法律保障，不許他人販售該版佛經，這違反佛經自古以來自由公開的天然屬性。\n"),v=A("br"),k=C("而CBETA的大正藏授權來自於日本，換言之，任何在其上的加工與加值，都受相關著作權法的"),w=A("a"),w.textContent="制約",O=C("。\n"),P=A("br"),I=C("二）佛經不能只是學者的研究材料，也不該是燙金精印、絲綢包裹但卻束之高閣的文物，必須是任何人都容易親近的結緣品。\n"),_=A("br"),S=C("我們無法容忍一家日本書商限制佛經流通方式，我們必須捍衛佛經「三根普被」的自由。\n"),N=A("br"),E=A("br"),z=C("如今我們擁有幾項前人難以想像的技術條件，正是打破這個尷尬局面的大好機會。\n"),L=A("br"),M=C("一）大正藏考察了多個佛經版本，將經文的差異製成校勘，節省了學者蒐集資料的時間，這是大正藏的核心價值。因為在紙本時代，不可能人人坐擁所有版本的佛經，校勘在某個意義上起到，同時參照多個版本的作用。\n"),j=A("br"),F=C("但校勘畢竟是二手資料，保真度遠不如原始文物，如今所有經文掃圖檔（公有財產）得以納入行動載具，只要建立了圖檔之間的對照關係，從任何一段經文可輕易地調閱所有版本的原始圖檔，校勘之重要性大減。\n"),B=A("br"),q=C("二）古代佛經主要是印度文明和中華文明（以及兩者幅射區域）的結晶，但受限於彼此高昂的交流成本（當年取經本身就是九死一生的冒險），其編製體例不可能有事先商議好的規範，這就造成各種版本和語系的佛經很難彼此參照驗證，也讓魚目混珠的現象難以杜絕與防犯。\n"),R=A("br"),H=C("三）將所有版本和譯本的佛經整合，統一參照系統的工作，我們稱之為「經同軌」，不止是經文目錄層級的對照（目錄提供某標題的各種版本和譯本的收錄情況及所在位置），而是更進一步做到每個句子的精準對應。\n"),U=A("br"),W=C("舉例來說，給定任何一句經文，電腦將有能力告知對應的原文以及各種譯文，反之亦然。即所謂的「平行語料庫」，這也是自然語言處理（如機器翻譯）的基礎材料。\n"),D=A("br"),K=C("四）「經同軌」，即佛經句子層級的對應，提供了比辭典更有效的學習材料，也可以化解辭典無法處理的語境(context)和多義(ambiguity) 關係。\n"),J=A("br"),Y=C("閱讀古文難點不在查字典本身，而是查到之後，義項(senses)太多，挑選困難，一個句子只要有幾個生字，每個生字又有幾個可能的解釋，產生歧義的現象將呈指數上升。\n"),Q=A("br"),V=C("五）近年來電腦越來越快，即使是手機也能以不到一秒以查找整部大藏經。於是瓶頸是使用者輸入文字的速度，以前是人等電腦，如今則是反過來。\n"),G=A("br"),X=C("因此，軟件的重點應該盡量掌握讀者所在的語境，做一些背景工作。舉例而言，讀者卡停在某個頁面，背景程式就開始搜羅彙整該頁的相關訊息，\n"),Z=A("br"),nn=C("即：這一頁有哪些艱澀名詞？哪些法師講過這段經文？哪些其他經文可以幫助閱讀理解這頁經文？\n"),tn=A("br"),en=C("六）古代藏經雕刻耗費的人力物力極為驚人，從譯經、編輯團隊，到媒材的準備，抄寫刻字工，印刷及發行流通，是非常龐大的生產鏈。\n"),sn=A("br"),ln=A("br"),cn=C("成功的藏經，至少有兩個必要條件，一是政權的同意，二是足夠的經費。皇帝未必真心信佛，和尚也未必服膺統治，但佛經想要存活，卷首少不了歌功頌德。\n"),an=A("br"),un=C("贊助刻經的，婦女是主力，後宮妃女的捐獻記錄，在藏經中保留很多。\n"),dn=A("br"),gn=C("台灣第一部大正藏，是孫張清揚（孫立人將軍夫人）變賣首飾，從日本運來的。\n"),mn=A("br"),$n=C("如今我們做手機版，也應該比照古人的辦法，將緇素二眾的護持事蹟編入藏經，我們這一代也作出了無愧先人、讓後人感念的貢獻。\n"),vn=A("br"),kn=A("br"),bn=C("因此，我們決心以已成為人類公共財產的中土大藏經為基礎材料，從頭做起，初步計劃是：\n"),yn=A("br"),xn=C("一）以山東圖書館公布之十七萬拍「高清永樂北藏彩圖」為基礎，裁切成適合手機閱讀的50萬折（每拍三折）。每折5行，每行17字，共85個字。\n"),wn=A("br"),An=C("二）以CBETA校對過的大正藏文字檔為工作底本，按永樂北藏的版式逐句重排，這樣就完全擺脫大正藏的製版權。加工成品採用最寬鬆的授權方式(CC0)，還佛經以最大的自由。\n"),Cn=A("br"),On=C("三）使用者點擊的圖檔任何一處、立即由軟體換算為對應的文字，可搜尋、查字典、連結原文、誦讀、顯示相關的開示錄影等。\n"),Pn=A("br"),In=C("四）取得諸山長老的祝福，我們的目標是只要會按手機，都可以悠遊法海。\n"),Tn=A("br"),_n=C("五）由於沒有版權的限制，可以將此成果與置入商品平板電腦，贈與經濟欠發達地區的僧人，以做為國際文化交流的拌手禮。\n"),fn(Sn.$$.fragment),T(i,"target","_new"),T(i,"href","https://docs.google.com/document/d/16m-DGbSTMpM67WSWHaojbRRWtUi2FfovgkdeWhFitKk/edit?usp=sharing"),T(m,"href","https://www.daizoshuppan.jp/"),T(m,"target","_new"),T(w,"href","https://www.cbeta.org/copyright.php"),T(w,"target","_new")},m(n,t){y(n,e,t),b(e,i),b(e,s),b(e,o),b(e,r),b(e,l),b(e,c),b(e,a),b(e,u),b(e,d),b(e,f),b(e,h),b(e,p),b(e,g),b(e,m),b(e,$),b(e,v),b(e,k),b(e,w),b(e,O),b(e,P),b(e,I),b(e,_),b(e,S),b(e,N),b(e,E),b(e,z),b(e,L),b(e,M),b(e,j),b(e,F),b(e,B),b(e,q),b(e,R),b(e,H),b(e,U),b(e,W),b(e,D),b(e,K),b(e,J),b(e,Y),b(e,Q),b(e,V),b(e,G),b(e,X),b(e,Z),b(e,nn),b(e,tn),b(e,en),b(e,sn),b(e,ln),b(e,cn),b(e,an),b(e,un),b(e,dn),b(e,gn),b(e,mn),b(e,$n),b(e,vn),b(e,kn),b(e,bn),b(e,yn),b(e,xn),b(e,wn),b(e,An),b(e,Cn),b(e,On),b(e,Pn),b(e,In),b(e,Tn),b(e,_n),hn(Sn,e,null),Nn=!0},p:n,i(n){Nn||(on(Sn.$$.fragment,n),Nn=!0)},o(n){rn(Sn.$$.fragment,n),Nn=!1},d(n){n&&x(e),pn(Sn)}}}class Gc extends $n{constructor(n){super(),mn(this,n,null,Vc,r,{})}}function Xc(n,t,e){const i=n.slice();return i[2]=t[e],i}function Zc(n){let t,e,i=n[2]+"";return{c(){t=A("div"),e=C(i)},m(n,i){y(n,t,i),b(t,e)},p(n,t){1&t&&i!==(i=n[2]+"")&&S(e,i)},d(n){n&&x(t)}}}function na(t){let e,i=ln(t[0]),s=[];for(let n=0;n<i.length;n+=1)s[n]=Zc(Xc(t,i,n));return{c(){e=A("div");for(let n=0;n<s.length;n+=1)s[n].c()},m(n,t){y(n,e,t);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,null)},p(n,[t]){if(1&t){let o;for(i=ln(n[0]),o=0;o<i.length;o+=1){const r=Xc(n,i,o);s[o]?s[o].p(r,t):(s[o]=Zc(r),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:n,o:n,d(n){n&&x(e),w(s,n)}}}function ta(n,t,e){let i,s;return h(n,_o,(n=>e(1,s=n))),n.$$.update=()=>{2&n.$$.dirty&&e(0,i=wl("永樂藏：只是產品名稱，不是文獻學意義的藏經版本。\n圖版：以山東圖書館藏永樂北藏為主，整卷缺漏或嚴重錯版（如增壹阿含卷23）改用同館永樂南藏，缺漏幾頁以乾隆大藏經補之。\n文字：以CBETA為底本，只有字數不一致的情況才會修改，不保證與圖版一致。\n不是永樂北藏、也不是大正藏的電子版，只是為了方便搜尋，不適合學術引用。\n標點：使用CBETA bookcase_v074_20221027 版經文的標點。\n聲音：為節約帶寬降為48~96kpbs，需要原始音質，請打開「顯示油管影片連結」。\n唯名：性空唯名系經典。\n唯心：真常唯心系經典。\n經號：四部阿含使用大正藏經號。外連巴利藏使用緬甸版編號。\n文件結構：\n書號：英文字，agmm （中阿含經）\n卷號：英文字加卷數，如agmm1。每卷對應一個圖版壓縮檔。\n項號：對應到目次的一個項目。\n段號：一段經文。也是雜阿含的一經。\n文字檔的一行為一句經文、搜尋結果的最小顯示單元。\n\n無量壽經句子對齊未完成。",s).split(/\r?\n/))},[i,s]}class ea extends $n{constructor(n){super(),mn(this,n,ta,na,r,{})}}function ia(t){let e,i,s,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,b,w,P,I,_,S,N,E,z,L,M,j,F,B,q,R,H,U,W,D,K,J,Y,Q,V,G,X,Z,nn,tn,en,sn,ln,cn,an,un,dn=wl("基於以下公開素材：")+"",gn=wl("永樂北藏、南藏圖檔(山東省圖書館)")+"",mn=wl("經文及新式標點(CBETA)")+"",$n=wl("金剛經集註(朱棣)")+"",vn=wl("梵漢佛經對勘叢書(黃寶生，中國社會科學出版社)")+"",kn=wl("四部阿含相似經文對照表")+"",bn=wl("一行佛學詞典之詞條")+"",yn=wl("油管公開誦經影片")+"",xn=wl("進行以下加工：")+"",wn=wl("按手機比例裁圖及修圖")+"",An=wl("文字與圖片逐頁逐行對齊")+"",Cn=wl("原文及各種譯本逐句對齊")+"",On=wl("誦經與圖片同步時間軸")+"",Pn=wl("成品數據庫分享方式")+"";return an=new Ql({}),{c(){e=C(dn),i=O(),s=A("br"),o=C(gn),r=O(),l=A("br"),c=C(mn),a=O(),u=A("br"),d=C($n),f=O(),h=A("br"),p=C("梵文原典 "),g=A("a"),g.textContent="Digital Sanskrit Buddhist Canon",m=O(),$=A("br"),v=C(vn),k=O(),b=A("br"),w=C(kn),P=A("a"),P.textContent="SuttaCentral",I=O(),_=A("br"),S=C(bn),N=O(),E=A("br"),z=C(yn),L=O(),M=A("hr"),j=O(),F=C(xn),B=O(),q=A("br"),R=C(wn),H=O(),U=A("br"),W=C(An),D=O(),K=A("br"),J=C(Cn),Y=O(),Q=A("br"),V=C(On),G=O(),X=A("hr"),Z=O(),nn=A("br"),tn=C(Pn),en=O(),sn=A("br"),ln=A("a"),ln.textContent=`${wl("CC0 1.0 通用公共領域貢獻")}`,cn=O(),fn(an.$$.fragment),T(g,"target","_new"),T(g,"href","https://www.dsbcproject.org/"),T(P,"target","_new"),T(P,"href","https://suttacentral.net/"),T(ln,"target","_new"),T(ln,"href","https://creativecommons.org/publicdomain/zero/1.0/deed.zh")},m(n,t){y(n,e,t),y(n,i,t),y(n,s,t),y(n,o,t),y(n,r,t),y(n,l,t),y(n,c,t),y(n,a,t),y(n,u,t),y(n,d,t),y(n,f,t),y(n,h,t),y(n,p,t),y(n,g,t),y(n,m,t),y(n,$,t),y(n,v,t),y(n,k,t),y(n,b,t),y(n,w,t),y(n,P,t),y(n,I,t),y(n,_,t),y(n,S,t),y(n,N,t),y(n,E,t),y(n,z,t),y(n,L,t),y(n,M,t),y(n,j,t),y(n,F,t),y(n,B,t),y(n,q,t),y(n,R,t),y(n,H,t),y(n,U,t),y(n,W,t),y(n,D,t),y(n,K,t),y(n,J,t),y(n,Y,t),y(n,Q,t),y(n,V,t),y(n,G,t),y(n,X,t),y(n,Z,t),y(n,nn,t),y(n,tn,t),y(n,en,t),y(n,sn,t),y(n,ln,t),y(n,cn,t),hn(an,n,t),un=!0},p:n,i(n){un||(on(an.$$.fragment,n),un=!0)},o(n){rn(an.$$.fragment,n),un=!1},d(n){n&&(x(e),x(i),x(s),x(o),x(r),x(l),x(c),x(a),x(u),x(d),x(f),x(h),x(p),x(g),x(m),x($),x(v),x(k),x(b),x(w),x(P),x(I),x(_),x(S),x(N),x(E),x(z),x(L),x(M),x(j),x(F),x(B),x(q),x(R),x(H),x(U),x(W),x(D),x(K),x(J),x(Y),x(Q),x(V),x(G),x(X),x(Z),x(nn),x(tn),x(en),x(sn),x(ln),x(cn)),pn(an,n)}}}class sa extends $n{constructor(n){super(),mn(this,n,null,ia,r,{})}}function oa(n,t,e){const i=n.slice();return i[8]=t[e][0],i[9]=t[e][1],i[11]=e,i}function ra(n){let t,e,i,s,o=wl("更新",n[2])+n[8]+"";function r(){return n[5](n[11])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable hyperlink needupdate")},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(t,i){n=t,5&i&&o!==(o=wl("更新",n[2])+n[8]+"")&&S(e,o)},d(n){n&&x(t),i=!1,s()}}}function la(n){let t,e="hasupdate"==n[9]&&ra(n);return{c(){e&&e.c(),t=P()},m(n,i){e&&e.m(n,i),y(n,t,i)},p(n,i){"hasupdate"==n[9]?e?e.p(n,i):(e=ra(n),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(n){n&&x(t),e&&e.d(n)}}}function ca(n){let t,e=wl("數據庫是最新版",n[2])+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){4&i&&e!==(e=wl("數據庫是最新版",n[2])+"")&&S(t,e)},d(n){n&&x(t)}}}function aa(t){let e,i,s,o,r=ln(t[0]),l=[];for(let n=0;n<r.length;n+=1)l[n]=la(oa(t,r,n));let c=!t[3]&&ca(t);return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=O(),i=C(t[1]),s=O(),c&&c.c(),o=P()},m(n,t){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(n,t);y(n,e,t),y(n,i,t),y(n,s,t),c&&c.m(n,t),y(n,o,t)},p(n,[t]){if(21&t){let i;for(r=ln(n[0]),i=0;i<r.length;i+=1){const s=oa(n,r,i);l[i]?l[i].p(s,t):(l[i]=la(s),l[i].c(),l[i].m(e.parentNode,e))}for(;i<l.length;i+=1)l[i].d(1);l.length=r.length}2&t&&S(i,n[1]),n[3]?c&&(c.d(1),c=null):c?c.p(n,t):(c=ca(n),c.c(),c.m(o.parentNode,o))},i:n,o:n,d(n){n&&(x(e),x(i),x(s),x(o)),w(l,n),c&&c.d(n)}}}function ua(n,t,e){let i,s;h(n,_o,(n=>e(2,i=n))),h(n,So,(n=>e(3,s=n)));let o=[],r=0;B((async()=>{e(0,o=Vo.map((n=>[n,"checking"]))),r=Vo.length;for(let n=0;n<Vo.length;n++){const t=await Vr(Vo[n]+".ptk",Qs);e(0,o[n][1]=t?"":"hasupdate",o),t&&r--}So.set(r>0),e(0,o)}));let l=!1,c="";const a=async n=>{const t=o[n][0];if(l)return;l=!0;const i=await Gr(Qs,t+".ptk?"+(new Date).toISOString(),(n=>{e(1,c=n)}));we(t);const s=await i.arrayBuffer(),a=await Di(t,new Uint8Array(s));Fs(a),l=!1,e(0,o[n][1]="",o),e(0,o),e(1,c=""),r--,So.set(r>0)};return[o,c,i,s,a,n=>a(n)]}class da extends $n{constructor(n){super(),mn(this,n,ua,aa,r,{})}}function fa(t){let e,i,s,o,r=t[4](t[1],t[0])+"";return{c(){e=A("span"),i=A("span"),T(e,"class","statebutton"),T(e,"title",t[3]),T(e,"aria-hidden",!0),L(e,"disabled",t[2]),L(e,"unselected",-1==t[0])},m(n,l){y(n,e,l),b(e,i),i.innerHTML=r,s||(o=I(e,"click",t[5]),s=!0)},p(n,[t]){3&t&&r!==(r=n[4](n[1],n[0])+"")&&(i.innerHTML=r),8&t&&T(e,"title",n[3]),4&t&&L(e,"disabled",n[2]),1&t&&L(e,"unselected",-1==n[0])},i:n,o:n,d(n){n&&x(e),s=!1,o()}}}function ha(n,t,e){let{onclick:i=null}=t,{disabled:s=!1}=t,{title:o=""}=t,{states:r={}}=t,{storeid:l=null}=t,{styles:c=null}=t,{caption:a=""}=t,u=a,{unselectable:d=!1}=t;const h=Object.keys(r);let{selectedIndex:p=l&&h.indexOf(f(l).toString())||-1}=t;-1!=p||d||(p=0,l&&f(l).toString()!==h[p]&&l.set(h[p]));const g=()=>{e(1,a=l?r[f(l)]:-1==p?u:r[p])};return B((()=>g())),n.$$set=n=>{"onclick"in n&&e(6,i=n.onclick),"disabled"in n&&e(2,s=n.disabled),"title"in n&&e(3,o=n.title),"states"in n&&e(7,r=n.states),"storeid"in n&&e(8,l=n.storeid),"styles"in n&&e(9,c=n.styles),"caption"in n&&e(1,a=n.caption),"unselectable"in n&&e(10,d=n.unselectable),"selectedIndex"in n&&e(0,p=n.selectedIndex)},n.$$.update=()=>{1&n.$$.dirty&&g()},[p,a,s,o,(n,t)=>c?n.replace(/\$(\w+)/g,((n,t)=>"string"==typeof c[t]?c[t]:"function"==typeof c?c(t):f(c[t])||"auto")):n,n=>{s||(e(0,p++,p),p>=h.length&&e(0,p=d?-1==p?0:-1:0),l&&l.set(h[p]),i&&i(p))},i,r,l,c,d]}class pa extends $n{constructor(n){super(),mn(this,n,ha,fa,r,{onclick:6,disabled:2,title:3,states:7,storeid:8,styles:9,caption:1,unselectable:10,selectedIndex:0})}}function ga(n){let t,e,i;return{c(){t=A("span"),t.textContent=`${wl("項目")}`,T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",6==n[0])},m(s,o){y(s,t,o),e||(i=I(t,"click",n[13]),e=!0)},p(n,e){1&e&&L(t,"selected",6==n[0])},d(n){n&&x(t),e=!1,i()}}}function ma(n){let t,e,i,o,r,l,c,a,u,d,f,h=n[4]&&Dl("title"),p=h&&ga(n);return{c(){t=A("span"),t.textContent="芳名",e=O(),i=A("span"),i.textContent="伙伴",o=O(),r=A("span"),r.textContent="素材",l=O(),c=A("span"),c.textContent=`${wl("關於")}`,a=O(),p&&p.c(),u=P(),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",2==n[0]),T(i,"aria-hidden","true"),T(i,"class","clickable"),L(i,"selected",3==n[0]),T(r,"aria-hidden","true"),T(r,"class","clickable"),L(r,"selected",4==n[0]),T(c,"aria-hidden","true"),T(c,"class","clickable"),L(c,"selected",5==n[0])},m(s,h){y(s,t,h),y(s,e,h),y(s,i,h),y(s,o,h),y(s,r,h),y(s,l,h),y(s,c,h),y(s,a,h),p&&p.m(s,h),y(s,u,h),d||(f=[I(t,"click",n[10]),I(i,"click",n[11]),I(r,"click",n[12]),I(c,"click",n[14])],d=!0)},p(n,e){1&e&&L(t,"selected",2==n[0]),1&e&&L(i,"selected",3==n[0]),1&e&&L(r,"selected",4==n[0]),1&e&&L(c,"selected",5==n[0]),16&e&&(h=n[4]&&Dl("title")),h?p?p.p(n,e):(p=ga(n),p.c(),p.m(u.parentNode,u)):p&&(p.d(1),p=null)},d(n){n&&(x(t),x(e),x(i),x(o),x(r),x(l),x(c),x(a),x(u)),p&&p.d(n),d=!1,s(f)}}}function $a(t){let e,i,s,o,l,c,a,u,d,f,h,p,g,m,$,v,k,w,P,I,_,N,E=wl("永樂藏",t[5])+"",z=t[5],L=wl("看不到圖版最底下的行才需要調整",t[5])+"",M=t[5];o=new da({});let j=Aa(t);function F(n){t[19](n)}let B={max:250,min:80,$$slots:{caption:[Ca]},$$scope:{ctx:t}};function q(n){t[20](n)}void 0!==t[3]&&(B.value=t[3]),d=new wc({props:B}),U.push((()=>dn(d,"value",F))),d.$on("input",kt(t[16],300));let R={max:100,min:1,$$slots:{caption:[Oa]},$$scope:{ctx:t}};void 0!==t[2]&&(R.value=t[2]),$=new wc({props:R}),U.push((()=>dn($,"value",q))),$.$on("input",kt(t[15],300));let H=Pa(t);return _=new Ql({}),{c(){e=A("span"),i=C(E),s=O(),fn(o.$$.fragment),l=O(),j.c(),c=O(),a=A("hr"),u=O(),fn(d.$$.fragment),h=O(),p=A("br"),g=C(L),m=O(),fn($.$$.fragment),k=O(),w=A("br"),P=O(),H.c(),I=O(),fn(_.$$.fragment),T(e,"class","logotitle")},m(n,t){y(n,e,t),b(e,i),y(n,s,t),hn(o,n,t),y(n,l,t),j.m(n,t),y(n,c,t),y(n,a,t),y(n,u,t),hn(d,n,t),y(n,h,t),y(n,p,t),y(n,g,t),y(n,m,t),hn($,n,t),y(n,k,t),y(n,w,t),y(n,P,t),H.m(n,t),y(n,I,t),hn(_,n,t),N=!0},p(t,e){(!N||32&e)&&E!==(E=wl("永樂藏",t[5])+"")&&S(i,E),32&e&&r(z,z=t[5])?(en(),rn(j,1,1,n),sn(),j=Aa(t),j.c(),on(j,1),j.m(c.parentNode,c)):j.p(t,e);const s={};536870952&e&&(s.$$scope={dirty:e,ctx:t}),!f&&8&e&&(f=!0,s.value=t[3],Q((()=>f=!1))),d.$set(s),(!N||32&e)&&L!==(L=wl("看不到圖版最底下的行才需要調整",t[5])+"")&&S(g,L);const o={};536870916&e&&(o.$$scope={dirty:e,ctx:t}),!v&&4&e&&(v=!0,o.value=t[2],Q((()=>v=!1))),$.$set(o),32&e&&r(M,M=t[5])?(en(),rn(H,1,1,n),sn(),H=Pa(t),H.c(),on(H,1),H.m(I.parentNode,I)):H.p(t,e)},i(n){N||(on(o.$$.fragment,n),on(j),on(d.$$.fragment,n),on($.$$.fragment,n),on(H),on(_.$$.fragment,n),N=!0)},o(n){rn(o.$$.fragment,n),rn(j),rn(d.$$.fragment,n),rn($.$$.fragment,n),rn(H),rn(_.$$.fragment,n),N=!1},d(n){n&&(x(e),x(s),x(l),x(c),x(a),x(u),x(h),x(p),x(g),x(m),x(k),x(w),x(P),x(I)),pn(o,n),j.d(n),pn(d,n),pn($,n),H.d(n),pn(_,n)}}}function va(t){let e,i;return e=new Gc({}),{c(){fn(e.$$.fragment)},m(n,t){hn(e,n,t),i=!0},p:n,i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){pn(e,n)}}}function ka(t){let e,i;return e=new ea({}),{c(){fn(e.$$.fragment)},m(n,t){hn(e,n,t),i=!0},p:n,i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){pn(e,n)}}}function ba(t){let e,i;return e=new sa({}),{c(){fn(e.$$.fragment)},m(n,t){hn(e,n,t),i=!0},p:n,i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){pn(e,n)}}}function ya(t){let e,i;return e=new Qc({}),{c(){fn(e.$$.fragment)},m(n,t){hn(e,n,t),i=!0},p:n,i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){pn(e,n)}}}function xa(t){let e,i;return e=new Jc({}),{c(){fn(e.$$.fragment)},m(n,t){hn(e,n,t),i=!0},p:n,i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){pn(e,n)}}}function wa(t){return{c:n,m:n,p:n,i:n,o:n,d:n}}function Aa(n){let t,e,i,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,b,w,P,_,E,z,L,M,j,F,B=wl("漢字顯示")+"",q=(Dl("title",n[4])||(n[4]?wl("查無此碼"):""))+"",R=wl("VIP碼 ")+"",H=wl("點焦點文字（紅色背景）分享")+"";return o=new pa({props:{states:{0:"原貌",1:wl("简體（「乾後發」等不變）"),2:"简体"},storeid:_o}}),{c(){t=A("br"),e=C(B),i=C("："),fn(o.$$.fragment),r=O(),l=A("br"),c=C("版本 "),a=C(Vs),u=C(q),d=O(),f=A("br"),h=C(R),p=A("input"),g=O(),m=A("br"),$=C("微信 Sukhanika\n"),v=A("br"),k=A("a"),k.textContent="dharmacloudpublishing[at]gmail",b=O(),w=A("br"),P=C("LINE官號"),_=A("a"),_.textContent="@dharmacloud",E=O(),z=A("br"),L=C(H),T(p,"placeholder",wl("沒有也可正常使用")),T(p,"size","12"),T(p,"type","text"),T(k,"href","mailto:dharmacloudpublishing@gmail.com"),T(_,"href","https://lin.ee/1tmTKXi"),T(_,"target","_new")},m(s,x){y(s,t,x),y(s,e,x),y(s,i,x),hn(o,s,x),y(s,r,x),y(s,l,x),y(s,c,x),y(s,a,x),y(s,u,x),y(s,d,x),y(s,f,x),y(s,h,x),y(s,p,x),N(p,n[1]),y(s,g,x),y(s,m,x),y(s,$,x),y(s,v,x),y(s,k,x),y(s,b,x),y(s,w,x),y(s,P,x),y(s,_,x),y(s,E,x),y(s,z,x),y(s,L,x),M=!0,j||(F=[I(p,"keyup",n[17]),I(p,"input",n[18])],j=!0)},p(n,t){(!M||16&t)&&q!==(q=(Dl("title",n[4])||(n[4]?wl("查無此碼"):""))+"")&&S(u,q),2&t&&p.value!==n[1]&&N(p,n[1])},i(n){M||(on(o.$$.fragment,n),M=!0)},o(n){rn(o.$$.fragment,n),M=!1},d(n){n&&(x(t),x(e),x(i),x(r),x(l),x(c),x(a),x(u),x(d),x(f),x(h),x(p),x(g),x(m),x($),x(v),x(k),x(b),x(w),x(P),x(_),x(E),x(z),x(L)),pn(o,n),j=!1,s(F)}}}function Ca(n){let t,e,i,s,o=n[3][0]+"",r=wl("字體大小",n[5])+"";return{c(){t=A("span"),e=C(o),i=C("% "),s=C(r),T(t,"slot","caption"),E(t,"float","right")},m(n,o){y(n,t,o),b(t,e),b(t,i),b(t,s)},p(n,t){8&t&&o!==(o=n[3][0]+"")&&S(e,o),32&t&&r!==(r=wl("字體大小",n[5])+"")&&S(s,r)},d(n){n&&x(t)}}}function Oa(n){let t,e,i,s=n[2][0]+"";return{c(){t=A("span"),e=C(s),i=C("% 全屏高度"),T(t,"slot","caption"),E(t,"float","right")},m(n,s){y(n,t,s),b(t,e),b(t,i)},p(n,t){4&t&&s!==(s=n[2][0]+"")&&S(e,s)},d(n){n&&x(t)}}}function Pa(n){let t,e,i,s,o,r,l,c,a,u,d,f;function h(t){n[21](t)}let p={label:wl("顯示標點符號"),design:"slider"};function g(t){n[22](t)}void 0!==n[6]&&(p.value=n[6]),t=new Sc({props:p}),U.push((()=>dn(t,"value",h)));let m={label:wl("靜置時顯示施主"),design:"slider"};function $(t){n[23](t)}void 0!==n[7]&&(m.value=n[7]),s=new Sc({props:m}),U.push((()=>dn(s,"value",g)));let v={label:wl("顯示油管影片連結"),design:"slider"};function k(t){n[24](t)}void 0!==n[8]&&(v.value=n[8]),l=new Sc({props:v}),U.push((()=>dn(l,"value",$)));let b={label:wl("啟動時顯示歡迎畫面"),design:"slider"};return void 0!==n[9]&&(b.value=n[9]),u=new Sc({props:b}),U.push((()=>dn(u,"value",k))),{c(){fn(t.$$.fragment),i=O(),fn(s.$$.fragment),r=O(),fn(l.$$.fragment),a=O(),fn(u.$$.fragment)},m(n,e){hn(t,n,e),y(n,i,e),hn(s,n,e),y(n,r,e),hn(l,n,e),y(n,a,e),hn(u,n,e),f=!0},p(n,i){const r={};!e&&64&i&&(e=!0,r.value=n[6],Q((()=>e=!1))),t.$set(r);const a={};!o&&128&i&&(o=!0,a.value=n[7],Q((()=>o=!1))),s.$set(a);const f={};!c&&256&i&&(c=!0,f.value=n[8],Q((()=>c=!1))),l.$set(f);const h={};!d&&512&i&&(d=!0,h.value=n[9],Q((()=>d=!1))),u.$set(h)},i(n){f||(on(t.$$.fragment,n),on(s.$$.fragment,n),on(l.$$.fragment,n),on(u.$$.fragment,n),f=!0)},o(n){rn(t.$$.fragment,n),rn(s.$$.fragment,n),rn(l.$$.fragment,n),rn(u.$$.fragment,n),f=!1},d(n){n&&(x(i),x(r),x(a)),pn(t,n),pn(s,n),pn(l,n),pn(u,n)}}}function Ia(n){let t,e,i,s,o,l,c=n[5],a=ma(n);const u=[wa,xa,ya,ba,ka,va,$a],d=[];function f(n,t){return 1==n[0]?0:2==n[0]?1:3==n[0]?2:4==n[0]?3:5==n[0]?4:6==n[0]?5:6}return s=f(n),o=d[s]=u[s](n),{c(){t=A("div"),a.c(),e=O(),i=A("div"),o.c(),T(t,"class","tabs"),T(i,"class","bodytext")},m(n,o){y(n,t,o),a.m(t,null),y(n,e,o),y(n,i,o),d[s].m(i,null),l=!0},p(n,[e]){32&e&&r(c,c=n[5])?(a.d(1),a=ma(n),a.c(),a.m(t,null)):a.p(n,e);let l=s;s=f(n),s===l?d[s].p(n,e):(en(),rn(d[l],1,1,(()=>{d[l]=null})),sn(),o=d[s],o?o.p(n,e):(o=d[s]=u[s](n),o.c()),on(o,1),o.m(i,null))},i(n){l||(on(o),l=!0)},o(n){rn(o),l=!1},d(n){n&&(x(t),x(e),x(i)),a.d(n),d[s].d()}}}function Ta(n,t,e){let i,s,o,r,l,c,a,u;h(n,Io,(n=>e(26,i=n))),h(n,Po,(n=>e(27,s=n))),h(n,To,(n=>e(4,o=n))),h(n,_o,(n=>e(5,r=n))),h(n,$o,(n=>e(6,l=n))),h(n,vo,(n=>e(7,c=n))),h(n,ko,(n=>e(8,a=n))),h(n,Ko,(n=>e(9,u=n)));let d=0,f=o,p=[Math.floor(10*(100*s-90)),0],g=[i,0];let m=0;return[d,f,p,g,o,r,l,c,a,u,()=>e(0,d=2==d?0:2),()=>e(0,d=3==d?0:3),()=>e(0,d=4==d?0:4),()=>e(0,d=6==d?0:6),()=>e(0,d=5==d?0:5),n=>{const t=n.detail[0]||100;Po.set((t/10+90)/100),xl()},n=>{const t=n.detail[0]||100;Io.set(t)},n=>{const t=n.target,e=t.selectionStart,i=t.selectionEnd;t.value=t.value.toUpperCase().replace(/[^a-zA-Z\d]/g,""),t.setSelectionRange(e,i),clearTimeout(m),m=setTimeout((()=>{To.set(t.value)}),1e3)},function(){f=this.value,e(1,f)},function(n){g=n,e(3,g)},function(n){p=n,e(2,p)},function(n){l=n,$o.set(l)},function(n){c=n,vo.set(c)},function(n){a=n,ko.set(a)},function(n){u=n,Ko.set(u)}]}class _a extends $n{constructor(n){super(),mn(this,n,Ta,Ia,r,{})}}function Sa(n){let t,e=(n[3][n[2]+1]||"empty")+"";return{c(){t=A("span"),T(t,"class","arrow svelte-5h9ge")},m(n,i){y(n,t,i),t.innerHTML=e},p(n,i){4&i&&e!==(e=(n[3][n[2]+1]||"empty")+"")&&(t.innerHTML=e)},d(n){n&&x(t)}}}function Na(n){let t,e,i,o,r,l,c,a,u=1==n[1]&&n[2]&&Sa(n);const d=n[12].default,f=p(d,n,n[11],null);return{c(){u&&u.c(),t=O(),e=A("div"),i=A("span"),o=C(n[0]),r=O(),f&&f.c(),T(i,"aria-hidden","true"),T(e,"name","swipeview"),E(e,"height","100%")},m(s,d){u&&u.m(s,d),y(s,t,d),y(s,e,d),b(e,i),b(i,o),b(e,r),f&&f.m(e,null),l=!0,c||(a=[I(i,"click",n[8]),I(e,"touchstart",n[4],{passive:!0}),I(e,"touchmove",n[5],{passive:!0}),I(e,"touchend",n[6],{passive:!0}),I(e,"wheel",n[13])],c=!0)},p(n,[e]){1==n[1]&&n[2]?u?u.p(n,e):(u=Sa(n),u.c(),u.m(t.parentNode,t)):u&&(u.d(1),u=null),(!l||1&e)&&S(o,n[0]),f&&f.p&&(!l||2048&e)&&$(f,d,n,n[11],l?m(d,n[11],e,null):v(n[11]),null)},i(n){l||(on(f,n),l=!0)},o(n){rn(f,n),l=!1},d(n){n&&(x(t),x(e)),u&&u.d(n),f&&f.d(n),c=!1,s(a)}}}function Ea(n,t,e){let{$$slots:i={},$$scope:s}=t,{onSwipe:o}=t,{caption:r=""}=t,{reverse:l=!1}=t;const c=['<svg width="150px" height="150px" viewBox="0 0 1024 1024" fill="#cfcfcf" color="#000000" ><path d="M768 903.232l-50.432 56.768L256 512l461.568-448 50.432 56.768L364.928 512z" ></path></svg>',,'<svg width="150px" height="150px" viewBox="0 0 1024 1024" fill="#cfcfcf" color="#000000"><path d="M256 120.768L306.432 64 768 512l-461.568 448L256 903.232 659.072 512z"></path></svg>'];let a=-1,u=0,d=0,f=0,h=0,p=0;const g=(n,t)=>{if(!n.altKey)return;n.deltaY>0?o&&o(1):o&&o(-1),n.preventDefault()};return n.$$set=n=>{"onSwipe"in n&&e(9,o=n.onSwipe),"caption"in n&&e(0,r=n.caption),"reverse"in n&&e(10,l=n.reverse),"$$scope"in n&&e(11,s=n.$$scope)},[r,a,p,c,n=>{e(2,p=0),1==n.touches.length&&(f=n.touches[0].pageX,h=n.touches[0].pageY,u=f,d=h,e(1,a=1))},n=>{-1!=a&&a>-1&&(u=n.touches[0].pageX,d=n.touches[0].pageY,e(2,p=(()=>{const n=u-f,t=d-h;let e=0;return n>window.innerWidth/10&&Math.abs(t)<Math.abs(n)/2?e=1:n<-window.innerWidth/10&&Math.abs(t)<Math.abs(n)/2&&(e=-1),l?-e:e})()))},n=>{-1!==a&&0!==p&&o&&o(p),e(1,a=-1),e(2,p=0)},g,()=>{o&&o(1)},o,l,s,i,n=>g(n)]}class za extends $n{constructor(n){super(),mn(this,n,Ea,Na,r,{onSwipe:9,caption:0,reverse:10})}}const La=n=>({active:18&n,caption:16&n,idx:16&n,id:16&n}),Ma=n=>({active:n[4].idx==n[1],caption:n[4].caption+"]",idx:n[4].idx,id:n[4].id});function ja(n,t,e){const i=n.slice();return i[16]=t[e],i}const Fa=n=>({active:10&n,caption:8&n,idx:8&n,id:8&n}),Ba=n=>({active:n[16].idx==n[1],caption:n[16].caption+" ",idx:n[16].idx,id:n[16].id}),qa=n=>({active:3&n,caption:1&n,id:1&n}),Ra=n=>({active:n[0][0].idx==n[1],caption:"["+n[0][0].caption,idx:"0",id:n[0][0].id});function Ha(n){let t;const e=n[10].default,i=p(e,n,n[11],Ra);return{c(){i&&i.c()},m(n,e){i&&i.m(n,e),t=!0},p(n,s){i&&i.p&&(!t||2051&s)&&$(i,e,n,n[11],t?m(e,n[11],s,qa):v(n[11]),Ra)},i(n){t||(on(i,n),t=!0)},o(n){rn(i,n),t=!1},d(n){i&&i.d(n)}}}function Ua(n){let t;const e=n[10].default,i=p(e,n,n[11],Ba);return{c(){i&&i.c()},m(n,e){i&&i.m(n,e),t=!0},p(n,s){i&&i.p&&(!t||2058&s)&&$(i,e,n,n[11],t?m(e,n[11],s,Fa):v(n[11]),Ba)},i(n){t||(on(i,n),t=!0)},o(n){rn(i,n),t=!1},d(n){i&&i.d(n)}}}function Wa(n){let t;const e=n[10].default,i=p(e,n,n[11],Ma);return{c(){i&&i.c()},m(n,e){i&&i.m(n,e),t=!0},p(n,s){i&&i.p&&(!t||2066&s)&&$(i,e,n,n[11],t?m(e,n[11],s,La):v(n[11]),Ma)},i(n){t||(on(i,n),t=!0)},o(n){rn(i,n),t=!1},d(n){i&&i.d(n)}}}function Da(n){let t,e,i,s,o=n[0].length&&Ha(n),r=ln(n[3]),l=[];for(let t=0;t<r.length;t+=1)l[t]=Ua(ja(n,r,t));const c=n=>rn(l[n],1,1,(()=>{l[n]=null}));let a=n[4]&&Wa(n);return{c(){o&&o.c(),t=O();for(let n=0;n<l.length;n+=1)l[n].c();e=O(),a&&a.c(),i=P()},m(n,r){o&&o.m(n,r),y(n,t,r);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(n,r);y(n,e,r),a&&a.m(n,r),y(n,i,r),s=!0},p(n,s){if(n[0].length?o?(o.p(n,s),1&s&&on(o,1)):(o=Ha(n),o.c(),on(o,1),o.m(t.parentNode,t)):o&&(en(),rn(o,1,1,(()=>{o=null})),sn()),2058&s){let t;for(r=ln(n[3]),t=0;t<r.length;t+=1){const i=ja(n,r,t);l[t]?(l[t].p(i,s),on(l[t],1)):(l[t]=Ua(i),l[t].c(),on(l[t],1),l[t].m(e.parentNode,e))}for(en(),t=r.length;t<l.length;t+=1)c(t);sn()}n[4]?a?(a.p(n,s),16&s&&on(a,1)):(a=Wa(n),a.c(),on(a,1),a.m(i.parentNode,i)):a&&(en(),rn(a,1,1,(()=>{a=null})),sn())},i(n){if(!s){on(o);for(let n=0;n<r.length;n+=1)on(l[n]);on(a),s=!0}},o(n){rn(o),l=l.filter(Boolean);for(let n=0;n<l.length;n+=1)rn(l[n]);rn(a),s=!1},d(n){n&&(x(t),x(e),x(i)),o&&o.d(n),w(l,n),a&&a.d(n)}}}function Ka(n){let t,e;return t=new za({props:{onSwipe:n[5],caption:n[2]?"→"+n[2]:"",$$slots:{default:[Da]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,[e]){const i={};4&e&&(i.caption=n[2]?"→"+n[2]:""),2075&e&&(i.$$scope={dirty:e,ctx:n}),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function Ja(n,t,e){let{$$slots:i={},$$scope:s}=t,{pages:o=[]}=t,{count:r=0}=t,{now:l=0}=t,{previtems:c=1}=t,{nextitems:a=3}=t,{onselect:u}=t,{caption:d=""}=t,f=l-c,h=l+a+1;const p=[];let g=null;const m=()=>{e(1,l=parseInt(l)),l>=o.length&&e(1,l=0),f=l-c,h=l+a+1,f<2&&(f=1),h>=o.length&&(h=o.length-1),e(3,p.length=0,p);for(let n=f;n<h;n++)p.push(o[n]);h+=10,h<o.length-2&&p.push(o[h]),h+=30,h<o.length-2&&p.push(o[h]),o.length>1?e(4,g=o[o.length-1]):e(4,g=null)};return n.$$set=n=>{"pages"in n&&e(0,o=n.pages),"count"in n&&e(6,r=n.count),"now"in n&&e(1,l=n.now),"previtems"in n&&e(7,c=n.previtems),"nextitems"in n&&e(8,a=n.nextitems),"onselect"in n&&e(9,u=n.onselect),"caption"in n&&e(2,d=n.caption),"$$scope"in n&&e(11,s=n.$$scope)},n.$$.update=()=>{3&n.$$.dirty&&m(),65&n.$$.dirty&&(()=>{if(r&&o.length!==r){e(0,o.length=0,o);for(let n=0;n<r;n++)o.push({caption:n+1,id:n+1,idx:n});m()}})()},[o,l,d,p,g,n=>{e(1,l+=n),l<0&&e(1,l=0),l>=o.length-1&&e(1,l=o.length-1),u&&u(l)},r,c,a,u,i,s]}class Ya extends $n{constructor(n){super(),mn(this,n,Ja,Ka,r,{pages:0,count:6,now:1,previtems:7,nextitems:8,onselect:9,caption:2})}}function Qa(n){let t,e,i,s,o=wl(n[2])+"";function r(){return n[6](n[10])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",n[9])},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(i,s){n=i,4&s&&o!==(o=wl(n[2])+"")&&S(e,o),512&s&&L(t,"selected",n[9])},d(n){n&&x(t),i=!1,s()}}}function Va(n){let t,e;return t=new Ya({props:{caption:n[2],count:n[1],nextitems:5,previtems:4,now:n[0],onselect:n[3],$$slots:{default:[Qa,({active:n,caption:t,idx:e})=>({9:n,2:t,10:e}),({active:n,caption:t,idx:e})=>(n?512:0)|(t?4:0)|(e?1024:0)]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,[e]){const i={};4&e&&(i.caption=n[2]),2&e&&(i.count=n[1]),1&e&&(i.now=n[0]),3588&e&&(i.$$scope={dirty:e,ctx:n}),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function Ga(n,t,e){let i,s;h(n,Wo,(n=>e(5,i=n))),h(n,Ao,(n=>e(7,s=n)));let{ptk:o}=t,r=0;const l=n=>{if(!s)return;const t=s.toFolioPos(null==s?void 0:s.fromFolioPos(i).ckid,n);ao.set(t[0]),Wo.set(t),e(0,r=n)};let c=0,a="";return n.$$set=n=>{"ptk"in n&&e(4,o=n.ptk)},n.$$.update=()=>{32&n.$$.dirty&&(()=>{const n=s;if(!n||!n.fromFolioPos)return;const t=n.fromFolioPos(i);if(!t||!t.ckid)return"";e(1,c=t.linecount||0);const r=parseInt(t.ckid).toString()==t.ckid?xt(parseInt(t.ckid),"①"):(t.ckid||"")+".";e(2,a=r+o.caption(t.at))})()},[r,c,a,l,o,i,n=>l(n)]}class Xa extends $n{constructor(n){super(),mn(this,n,Ga,Va,r,{ptk:4})}}function Za(n,t,e){const i=n.slice();return i[13]=t[e],i}function nu(n){var t,e;let i,s,o,r,l,c,a,u,d=wl(n[3](n[13].ptk,null===(e=n[13].heading)||void 0===e||null===(t=e.bk)||void 0===t?void 0:t.at))+"",f=n[5](n[13].ptk)?"←":" ",h=wl(n[6](n[13].linetext))+"";function p(){return n[10](n[13])}return{c(){var t;i=A("div"),s=A("span"),o=C(d),r=O(),l=C(f),c=C(h),T(s,"aria-hidden","true"),T(s,"class","clickable author"),L(i,"selecteditem",(null===(t=n[13].heading)||void 0===t?void 0:t.bkid)==n[2])},m(n,t){y(n,i,t),b(i,s),b(s,o),b(s,r),b(s,l),b(i,c),a||(u=I(s,"click",p),a=!0)},p(t,e){var s,r,a;(n=t,2&e&&d!==(d=wl(n[3](n[13].ptk,null===(r=n[13].heading)||void 0===r||null===(s=r.bk)||void 0===s?void 0:s.at))+"")&&S(o,d),2&e&&f!==(f=n[5](n[13].ptk)?"←":" ")&&S(l,f),2&e&&h!==(h=wl(n[6](n[13].linetext))+"")&&S(c,h),6&e)&&L(i,"selecteditem",(null===(a=n[13].heading)||void 0===a?void 0:a.bkid)==n[2])},d(n){n&&x(i),a=!1,u()}}}function tu(n){var t,e;let i,s,o=!~(null===(e=n[13].heading)||void 0===e||null===(t=e.bkid)||void 0===t?void 0:t.indexOf("_variorum")),r=o&&nu(n);return{c(){r&&r.c(),i=O(),s=A("div"),T(s,"class","hr")},m(n,t){r&&r.m(n,t),y(n,i,t),y(n,s,t)},p(n,t){var e,s;2&t&&(o=!~(null===(s=n[13].heading)||void 0===s||null===(e=s.bkid)||void 0===e?void 0:e.indexOf("_variorum"))),o?r?r.p(n,t):(r=nu(n),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},d(n){n&&(x(i),x(s)),r&&r.d(n)}}}function eu(n){let t,e,i,s,o,r,l,c;e=new Xa({props:{ptk:n[0]}});let a=ln(n[1]),u=[];for(let t=0;t<a.length;t+=1)u[t]=tu(Za(n,a,t));return l=new Ql({}),{c(){t=A("div"),fn(e.$$.fragment),i=O(),s=A("div"),o=O();for(let n=0;n<u.length;n+=1)u[n].c();r=O(),fn(l.$$.fragment),T(s,"class","hr"),T(t,"class","bodytext")},m(n,a){y(n,t,a),hn(e,t,null),b(t,i),b(t,s),b(t,o);for(let n=0;n<u.length;n+=1)u[n]&&u[n].m(t,null);b(t,r),hn(l,t,null),c=!0},p(n,[i]){const s={};if(1&i&&(s.ptk=n[0]),e.$set(s),126&i){let e;for(a=ln(n[1]),e=0;e<a.length;e+=1){const s=Za(n,a,e);u[e]?u[e].p(s,i):(u[e]=tu(s),u[e].c(),u[e].m(t,r))}for(;e<u.length;e+=1)u[e].d(1);u.length=a.length}},i(n){c||(on(e.$$.fragment,n),on(l.$$.fragment,n),c=!0)},o(n){rn(e.$$.fragment,n),rn(l.$$.fragment,n),c=!1},d(n){n&&x(t),pn(e),w(u,n),pn(l)}}}function iu(n,t,e){let i,s,o,r;h(n,ro,(n=>e(8,i=n))),h(n,Wo,(n=>e(9,s=n))),h(n,Ao,(n=>e(11,o=n))),h(n,uo,(n=>e(2,r=n)));let{closePopup:l=function(){}}=t,{ptk:c}=t,a=[];const u=(n,t)=>{const e=n.defines.pb,i=n.defines.folio;if(!e)return;const s=n.nearestTag(t,"pb"),o=n.nearestTag(t,"folio"),r=e.fields.id.values[s],c=i.fields.id.values[o];kr(c,(()=>{so.set(n.name),ao.set((parseInt(r)||1)-1),marktap(r,t)})),l()};return n.$$set=n=>{"closePopup"in n&&e(7,l=n.closePopup),"ptk"in n&&e(0,c=n.ptk)},n.$$.update=()=>{768&n.$$.dirty&&(async(n,t)=>{if(t)return[];const i=null==o?void 0:o.fromFolioPos(n);i&&e(1,a=await Bs(c,i.ptkline,null,{local:!0,remote:!1}))})(s,i)},[c,a,r,(n,t)=>{const e=n.defines.bk,i=e.linepos[t],s=n.defines.folio,o=Qn(s.linepos,i+1)-1;return s.linepos[o]!==i?e._innertext.get(t):~o?s._innertext.get(o):e._innertext.get(t)},u,(n,t)=>n.nearestTag(t+1,"folio")>-1,n=>{const[t]=Wn(n);return t},l,i,s,n=>u(n.ptk,n.line)]}class su extends $n{constructor(n){super(),mn(this,n,iu,eu,r,{closePopup:7,ptk:0})}}function ou(n){let t,e,i,s,o=wl(n[10])+"";function r(){return n[5](n[11])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",n[9])},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(i,s){n=i,1024&s&&o!==(o=wl(n[10])+"")&&S(e,o),512&s&&L(t,"selected",n[9])},d(n){n&&x(t),i=!1,s()}}}function ru(n){let t,e;return t=new Ya({props:{onselect:n[2],pages:n[1],nextitems:2,now:n[0],$$slots:{default:[ou,({active:n,caption:t,idx:e})=>({9:n,10:t,11:e}),({active:n,caption:t,idx:e})=>(n?512:0)|(t?1024:0)|(e?2048:0)]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,[e]){const i={};2&e&&(i.pages=n[1]),1&e&&(i.now=n[0]),7680&e&&(i.$$scope={dirty:e,ctx:n}),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function lu(n,t,e){let i,s,o;h(n,Wo,(n=>e(4,i=n))),h(n,uo,(n=>e(6,s=n))),h(n,Ao,(n=>e(7,o=n)));let{ptk:r}=t,l=0;const c=[],a=n=>{const t=c[n].id,i=r.defines.ck.fields.id.values[t];((n,t,e,i=0)=>{const s=f(Ao);if(0!==i){const s=n.defines.ck,[o,r]=n.rangeOfAddress("bk#"+t),[l,c]=n.rangeOfAddress("bk#"+t+".ck#"+e),a=n.nearestChunk(l+1).at+i,u=s.linepos[a];u<r&&u>=o&&(e=s.fields.id.values[a])}if(-1==s.chunks.indexOf(e)){const t=xr(n,f(uo),e);kr(t,(()=>yr(e)))}else yr(e)})(r,Mo(s),i),e(0,l=n)};return n.$$set=n=>{"ptk"in n&&e(3,r=n.ptk)},n.$$.update=()=>{16&n.$$.dirty&&(()=>{const n=o;if(!n||!n.fromFolioPos)return;const{ckid:t}=n.fromFolioPos(i),a=Mo(s),[u,d]=r.rangeOfAddress("bk#"+a),[f,h]=r.tagInRange("ck",u,d),p=r.defines.ck;let g=0;e(1,c.length=0,c);const m=t;for(let n=f;n<=h;n++){const t=p.fields.id.values[n],i=parseInt(t)?xt(parseInt(t),"①"):t+".";c.push({caption:i+p._innertext.get(n),idx:g,id:n,ckid:t}),t==m&&e(0,l=g),g++}})()},[l,c,a,r,i,n=>a(n)]}class cu extends $n{constructor(n){super(),mn(this,n,lu,ru,r,{ptk:3})}}function au(n,t,e){const i=n.slice();return i[23]=t[e],i[25]=e,i}function uu(n){let t,e,i;function s(t){n[15](t)}let o={max:n[4].length-2,min:0,$$slots:{caption:[du]},$$scope:{ctx:n}};return void 0!==n[3]&&(o.value=n[3]),t=new wc({props:o}),U.push((()=>dn(t,"value",s))),t.$on("input",kt(n[12],100)),{c(){fn(t.$$.fragment)},m(n,e){hn(t,n,e),i=!0},p(n,i){const s={};16&i&&(s.max=n[4].length-2),67108968&i&&(s.$$scope={dirty:i,ctx:n}),!e&&8&i&&(e=!0,s.value=n[3],Q((()=>e=!1))),t.$set(s)},i(n){i||(on(t.$$.fragment,n),i=!0)},o(n){rn(t.$$.fragment,n),i=!1},d(n){pn(t,n)}}}function du(n){let t,e,i,s,o,r=(n[5]+n[3][0]||0)+"";return{c(){t=A("span"),e=C("經"),i=C(r),s=C("/"),o=C(n[6]),T(t,"slot","caption"),E(t,"float","right")},m(n,r){y(n,t,r),b(t,e),b(t,i),b(t,s),b(t,o)},p(n,t){40&t&&r!==(r=(n[5]+n[3][0]||0)+"")&&S(i,r),64&t&&S(o,n[6])},d(n){n&&x(t)}}}function fu(n){let t,e,i,s=n[8](n[23])+"";function o(){return n[16](n[25])}return{c(){t=A("div"),T(t,"aria-hidden","true"),L(t,"activeline",n[7]==n[25])},m(n,r){y(n,t,r),t.innerHTML=s,e||(i=I(t,"click",o),e=!0)},p(e,i){n=e,4&i&&s!==(s=n[8](n[23])+"")&&(t.innerHTML=s),128&i&&L(t,"activeline",n[7]==n[25])},d(n){n&&x(t),e=!1,i()}}}function hu(n){let t,e=ln(n[2]),i=[];for(let t=0;t<e.length;t+=1)i[t]=fu(au(n,e,t));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();t=P()},m(n,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,e);y(n,t,e)},p(n,s){if(902&s){let o;for(e=ln(n[2]),o=0;o<e.length;o+=1){const r=au(n,e,o);i[o]?i[o].p(r,s):(i[o]=fu(r),i[o].c(),i[o].m(t.parentNode,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},d(n){n&&x(t),w(i,n)}}}function pu(n){let t,e,i,o,l,c,a,u,d,f,h,p,g,m,$,v=n[7];c=new cu({props:{ptk:n[0]}});let k=n[4].length&&uu(n),w=hu(n);return p=new Ql({}),{c(){t=A("div"),e=A("span"),e.textContent="↑",i=O(),o=A("span"),o.textContent="▃",l=O(),fn(c.$$.fragment),a=O(),k&&k.c(),u=O(),d=A("hr"),f=O(),w.c(),h=O(),fn(p.$$.fragment),T(e,"aria-hidden","true"),T(e,"class","clickable gotop"),T(o,"aria-hidden","true"),T(o,"class","clickable goactiveline"),T(t,"class","bodytext")},m(s,r){y(s,t,r),b(t,e),b(t,i),b(t,o),b(t,l),hn(c,t,null),b(t,a),k&&k.m(t,null),b(t,u),b(t,d),b(t,f),w.m(t,null),b(t,h),hn(p,t,null),g=!0,m||($=[I(e,"click",n[11]),I(o,"click",n[10])],m=!0)},p(n,[e]){const i={};1&e&&(i.ptk=n[0]),c.$set(i),n[4].length?k?(k.p(n,e),16&e&&on(k,1)):(k=uu(n),k.c(),on(k,1),k.m(t,u)):k&&(en(),rn(k,1,1,(()=>{k=null})),sn()),128&e&&r(v,v=n[7])?(w.d(1),w=hu(n),w.c(),w.m(t,h)):w.p(n,e)},i(n){g||(on(c.$$.fragment,n),on(k),on(p.$$.fragment,n),g=!0)},o(n){rn(c.$$.fragment,n),rn(k),rn(p.$$.fragment,n),g=!1},d(n){n&&x(t),pn(c),k&&k.d(),w.d(n),pn(p),m=!1,s($)}}}function gu(n,t,e){let i,s,o;h(n,ro,(n=>e(13,s=n))),h(n,Wo,(n=>e(14,o=n)));let r,{ptk:l}=t,c=0,a=!1,u=[],d=[],p=[0,0],g=[],m=0,$=0;const v=()=>{g.length?(g.push(u.length-1),e(2,d=u.slice(g[0],g[1]))):e(2,d=u)},k=n=>{const t=f(Ao);if(!t||!t.fromFolioPos)return;const[s,o,l]=t.toFolioPos(r,n);$r(s,r),a=!0,Wo.set([s,o,l]),e(7,i=n-c),wt(sr())};return n.$$set=n=>{"ptk"in n&&e(0,l=n.ptk)},n.$$.update=()=>{24576&n.$$.dirty&&((n,t)=>{if(t)return;const s=f(Ao);if(!s||!s.fromFolioPos)return;let o=0;const{ckid:l,lineoff:h}=s.fromFolioPos(n);if(a&&r==l)a=!1;else{e(4,g.length=0,g),u=[],e(1,c=0),u=s.chunkText(l).split("\n"),e(5,m=0),e(6,$=0);for(let n=0;n<u.length;n++){const t=u[n].match(/\^n(\d+)/);if(t){const i=parseInt(t[1]);0==m&&i&&e(5,m=i),e(6,$=i),n<h&&(o=g.length),g.push(n)}}if(o!==p[0]&&e(3,p[0]=o,p),e(7,i=h-g[o]),v(),r==l){const n=p[0];e(2,d=u.slice(g[n],g[n+1])),e(1,c=g[n]||0)}else e(3,p[0]=0,p),e(1,c=g[0]||0);r=l}})(o,s)},e(7,i=0),[l,c,d,p,g,m,$,i,n=>wl(n.replace(/\^[a-z_]#?[a-z\d]*/g,"")),k,()=>{const n=document.querySelector(".bodytext .activeline");n&&(n.parentElement.parentElement.parentElement.scrollTop=n.offsetTop)},()=>{const n=document.querySelector(".bodytext .activeline");n&&(n.parentElement.parentElement.parentElement.scrollTop=0)},n=>{const t=n.detail[0];e(2,d=u.slice(g[t],g[t+1])),e(1,c=g[t]),e(7,i=0)},s,o,function(n){p=n,e(3,p)},n=>k(c+n)]}class mu extends $n{constructor(n){super(),mn(this,n,gu,pu,r,{ptk:0})}}function $u(n,t,e){const i=n.slice();return i[7]=t[e],i}function vu(n){let t,e,i,s,o=wl(n[2](n[7].linetext))+"";return{c(){t=A("div"),e=C(o),i=O(),s=A("div"),T(s,"class","hr")},m(n,o){y(n,t,o),b(t,e),y(n,i,o),y(n,s,o)},p(n,t){2&t&&o!==(o=wl(n[2](n[7].linetext))+"")&&S(e,o)},d(n){n&&(x(t),x(i),x(s))}}}function ku(n){let t,e,i,s,o,r;e=new Xa({props:{ptk:n[0]}});let l=ln(n[1]),c=[];for(let t=0;t<l.length;t+=1)c[t]=vu($u(n,l,t));return o=new Ql({}),{c(){t=A("div"),fn(e.$$.fragment),i=O();for(let n=0;n<c.length;n+=1)c[n].c();s=O(),fn(o.$$.fragment),T(t,"class","bodytext")},m(n,l){y(n,t,l),hn(e,t,null),b(t,i);for(let n=0;n<c.length;n+=1)c[n]&&c[n].m(t,null);b(t,s),hn(o,t,null),r=!0},p(n,[i]){const o={};if(1&i&&(o.ptk=n[0]),e.$set(o),6&i){let e;for(l=ln(n[1]),e=0;e<l.length;e+=1){const o=$u(n,l,e);c[e]?c[e].p(o,i):(c[e]=vu(o),c[e].c(),c[e].m(t,s))}for(;e<c.length;e+=1)c[e].d(1);c.length=l.length}},i(n){r||(on(e.$$.fragment,n),on(o.$$.fragment,n),r=!0)},o(n){rn(e.$$.fragment,n),rn(o.$$.fragment,n),r=!1},d(n){n&&x(t),pn(e),w(c,n),pn(o)}}}function bu(n,t,e){let i,s,o;h(n,ro,(n=>e(3,i=n))),h(n,Wo,(n=>e(4,s=n))),h(n,Ao,(n=>e(5,o=n)));let{ptk:r}=t,l=[];return n.$$set=n=>{"ptk"in n&&e(0,r=n.ptk)},n.$$.update=()=>{24&n.$$.dirty&&(async(n,t)=>{if(t)return;const i=null==o?void 0:o.fromFolioPos(s);i&&e(1,l=await Bs(r,i.ptkline,null,{remote:!0,local:!1}))})(0,i)},[r,l,n=>{const[t]=Wn(n);return t},i,s]}class yu extends $n{constructor(n){super(),mn(this,n,bu,ku,r,{ptk:0})}}function xu(n){let t,e,i,s,o,r,l,c,a,u=wl(n[0])+"";return e=new Xa({props:{ptk:Ki("dc")}}),r=new Xa({props:{ptk:Ki("dc")}}),c=new Ql({}),{c(){t=A("div"),fn(e.$$.fragment),i=O(),s=new M(!1),o=O(),fn(r.$$.fragment),l=O(),fn(c.$$.fragment),s.a=o,T(t,"class","bodytext")},m(n,d){y(n,t,d),hn(e,t,null),b(t,i),s.m(u,t),b(t,o),hn(r,t,null),b(t,l),hn(c,t,null),a=!0},p(n,[t]){(!a||1&t)&&u!==(u=wl(n[0])+"")&&s.p(u)},i(n){a||(on(e.$$.fragment,n),on(r.$$.fragment,n),on(c.$$.fragment,n),a=!0)},o(n){rn(e.$$.fragment,n),rn(r.$$.fragment,n),rn(c.$$.fragment,n),a=!1},d(n){n&&x(t),pn(e),pn(r),pn(c)}}}function wu(n,t,e){let i;h(n,ro,(n=>e(1,i=n)));let s="";return n.$$.update=()=>{2&n.$$.dirty&&(async(n,t)=>{const i=Ki("dc"),o=i.defines.r;if(!o||t)return;const r=He(n),l=Re(r.action,!0);if(!l)return;const c=l.ck+":"+r.highlightline;let a=o.fields.id.values.indexOf(c);if(~a){const n=o.linepos[a];let t=o.linepos[a+1];for(a++;t==n;)a++,t=o.linepos[a];await i.loadLines([[n,t+1]]);const r=i.slice(n,t+1);r[r.length-1].indexOf("^ck")&&r.pop(),r.length&&(r[0]='<div class="sourcetext">'+r[0].replace(/\^r(\d+):/g,((n,t)=>xt(t)))+"</div>"),e(0,s=r.join("<br/>"))}})(sr(),i)},[s,i]}class Au extends $n{constructor(n){super(),mn(this,n,wu,xu,r,{})}}function Cu(n,t,e){const i=n.slice();return i[6]=t[e],i}function Ou(n){let t,e,i,o,r,l=n[6]+"";function c(){return n[4](n[6])}function a(){return n[5](n[6])}return{c(){t=A("span"),e=C(l),i=A("span"),i.textContent="✕",T(t,"aria-hidden","true"),T(t,"class","clickable"),T(i,"aria-hidden","true"),T(i,"class","delete clickable")},m(n,s){y(n,t,s),b(t,e),y(n,i,s),o||(r=[I(t,"click",c),I(i,"click",a)],o=!0)},p(t,i){n=t,2&i&&l!==(l=n[6]+"")&&S(e,l)},d(n){n&&(x(t),x(i)),o=!1,s(r)}}}function Pu(t){let e,i=ln(t[1]),s=[];for(let n=0;n<i.length;n+=1)s[n]=Ou(Cu(t,i,n));return{c(){e=A("div");for(let n=0;n<s.length;n+=1)s[n].c();T(e,"class","bodytext")},m(n,t){y(n,e,t);for(let n=0;n<s.length;n+=1)s[n]&&s[n].m(e,null)},p(n,[t]){if(3&t){let o;for(i=ln(n[1]),o=0;o<i.length;o+=1){const r=Cu(n,i,o);s[o]?s[o].p(r,t):(s[o]=Ou(r),s[o].c(),s[o].m(e,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:n,o:n,d(n){n&&x(e),w(s,n)}}}function Iu(n,t,e){let i,s,o;h(n,Co,(n=>e(2,s=n))),h(n,Oo,(n=>e(3,o=n)));const r=n=>{Co.set(n)};return n.$$.update=()=>{8&n.$$.dirty&&e(1,i=o.slice(0,o.length)),4&n.$$.dirty&&console.log("tofind",s)},[r,i,s,o,n=>r(n),n=>hr(n)]}class Tu extends $n{get setTofind(){return this.$$.ctx[0]}constructor(n){super(),mn(this,n,Iu,Pu,r,{setTofind:0})}}function _u(t){let e,i,s,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,w,P,I,_,S,N,E,z,L,M,j,F,B,q,R,H,U,W,D,K=wl("點圖片任何一字，將短句帶入候選區，預設前三個字為關鍵字。")+"",J=wl("點紅色背景的字，分享該段經文。")+"",Y=wl("♡書籤。閃爍時再點擊改變顏色，不閃爍時再點取消。")+"",Q=wl("點候選區改變關鍵的長度，同個位置再點一次，貼到輸入區。")+"",V=wl("候選區與輸入區文字相同，再點候選區清除輸入區。")+"",G=wl("搜尋結果：")+"",X=wl("搜尋分頁為開頭為→的行，可以左右滑動翻頁，點擊翻下一頁。")+"",Z=wl("部類名右邊的紅色數字表示關鍵字出現次數，點擊顯示所有摘要行。")+"",nn=wl("點部類名統計標題內關鍵字出現次數，點出現次數顯示該章節內之摘要行。")+"",tn=wl("輸入時會顯示開頭符合、結尾符合或中間符合的推薦詞，點一下帶入候選區。")+"",en=wl("從搜尋結果跳轉到本文，搜尋文字會加入記憶，最多二十組，超過刪去最初的記憶。按旁邊的紅色叉可刪除。")+"";return e=new Tu({}),{c(){fn(e.$$.fragment),i=O(),s=A("hr"),o=O(),r=A("div"),l=C(K),c=O(),a=A("br"),u=C(J),d=O(),f=A("br"),h=C(Y),p=O(),g=A("br"),m=C(Q),$=O(),v=A("br"),k=C(V),w=O(),P=A("br"),I=C(G),_=O(),S=A("br"),N=C(X),E=O(),z=A("br"),L=C(Z),M=O(),j=A("br"),F=C(nn),B=O(),q=A("br"),R=C(tn),H=O(),U=A("br"),W=C(en),T(r,"class","bodytext")},m(n,t){hn(e,n,t),y(n,i,t),y(n,s,t),y(n,o,t),y(n,r,t),b(r,l),b(r,c),b(r,a),b(r,u),b(r,d),b(r,f),b(r,h),b(r,p),b(r,g),b(r,m),b(r,$),b(r,v),b(r,k),b(r,w),b(r,P),b(r,I),b(r,_),b(r,S),b(r,N),b(r,E),b(r,z),b(r,L),b(r,M),b(r,j),b(r,F),b(r,B),b(r,q),b(r,R),b(r,H),b(r,U),b(r,W),D=!0},p:n,i(n){D||(on(e.$$.fragment,n),D=!0)},o(n){rn(e.$$.fragment,n),D=!1},d(n){n&&(x(i),x(s),x(o),x(r)),pn(e,n)}}}class Su extends $n{constructor(n){super(),mn(this,n,null,_u,r,{})}}const Nu=(n,t)=>{const e=t||Fo(),i=e.nearestTag(n+1,"bk","id"),s=e.nearestTag(n+1,"ck","id"),o=e.nearestTag(n+1,"n","id");if(void 0===i||void 0===s||void 0===o)return"";const r="bk#"+i+".ck#"+s+".n"+o,[l]=e.rangeOfAddress(r);return n-l>0?r+":"+(n-l):r},Eu=n=>{const t=Fo();let e="";const[i]=t.rangeOfAddress(n),s=t.nearestChunk(i);return e+=(null==s?void 0:s.caption.replace(/\d+$/g,""))||"",e},zu=n=>{const t=n.match(/ak#([dmsa])n\.ck#([^\.]+)(.*)/);if(!t)return"";let e="";const i=t[2].replace(/[dmsa]/,""),s=t[3].replace(".n","");return"d"==t[1]?e="長部"+i+"經":"m"==t[1]?e="中部"+i+"經":"s"==t[1]?e=i+"相應"+s+"經":"a"==t[1]&&(e="增支"+i+"集"+s+"經"),e};function Lu(n){let t,e,i,s,o;const r=n[5].default,l=p(r,n,n[4],null);return{c(){t=A("span"),l&&l.c(),T(t,"class",e=n[1]+(n[3]?" clicked":"")),T(t,"title",n[2]),T(t,"aria-hidden","true")},m(e,r){y(e,t,r),l&&l.m(t,null),i=!0,s||(o=I(t,"click",n[6]),s=!0)},p(n,[s]){l&&l.p&&(!i||16&s)&&$(l,r,n,n[4],i?m(r,n[4],s,null):v(n[4]),null),(!i||10&s&&e!==(e=n[1]+(n[3]?" clicked":"")))&&T(t,"class",e),(!i||4&s)&&T(t,"title",n[2])},i(n){i||(on(l,n),i=!0)},o(n){rn(l,n),i=!1},d(n){n&&x(t),l&&l.d(n),s=!1,o()}}}function Mu(n,t,e){let{$$slots:i={},$$scope:s}=t,{onclick:o=()=>{}}=t,{className:r="clickable"}=t,{title:l=""}=t,{clicked:c=!1}=t;return n.$$set=n=>{"onclick"in n&&e(0,o=n.onclick),"className"in n&&e(1,r=n.className),"title"in n&&e(2,l=n.title),"clicked"in n&&e(3,c=n.clicked),"$$scope"in n&&e(4,s=n.$$scope)},[o,r,l,c,s,i,()=>o()]}class ju extends $n{constructor(n){super(),mn(this,n,Mu,Lu,r,{onclick:0,className:1,title:2,clicked:3})}}function Fu(n,t,e){const i=n.slice();return i[12]=t[e],i[14]=e,i}const Bu=n=>({tk:2&n}),qu=n=>({tk:n[12]});function Ru(n){let t;const e=n[7].default,i=p(e,n,n[11],qu),s=i||function(n){let t,e=n[12].text+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){2&i&&e!==(e=n[12].text+"")&&S(t,e)},d(n){n&&x(t)}}}(n);return{c(){s&&s.c()},m(n,e){s&&s.m(n,e),t=!0},p(n,o){i?i.p&&(!t||2050&o)&&$(i,e,n,n[11],t?m(e,n[11],o,Bu):v(n[11]),qu):s&&s.p&&(!t||2&o)&&s.p(n,t?o:-1)},i(n){t||(on(s,n),t=!0)},o(n){rn(s,n),t=!1},d(n){s&&s.d(n)}}}function Hu(n){let t,e,i,s,o=n[12][1]&&n[12][0]>10&&Uu(n);e=new ju({props:{className:"abridged",onclick:function(){return n[9](n[14])},$$slots:{default:[Du]},$$scope:{ctx:n}}});let r=!n[12][2]&&Ku(n);return{c(){o&&o.c(),t=P(),fn(e.$$.fragment),r&&r.c(),i=P()},m(n,l){o&&o.m(n,l),y(n,t,l),hn(e,n,l),r&&r.m(n,l),y(n,i,l),s=!0},p(s,l){(n=s)[12][1]&&n[12][0]>10?o?(o.p(n,l),2&l&&on(o,1)):(o=Uu(n),o.c(),on(o,1),o.m(t.parentNode,t)):o&&(en(),rn(o,1,1,(()=>{o=null})),sn());const c={};2050&l&&(c.$$scope={dirty:l,ctx:n}),e.$set(c),n[12][2]?r&&(en(),rn(r,1,1,(()=>{r=null})),sn()):r?(r.p(n,l),2&l&&on(r,1)):(r=Ku(n),r.c(),on(r,1),r.m(i.parentNode,i))},i(n){s||(on(o),on(e.$$.fragment,n),on(r),s=!0)},o(n){rn(o),rn(e.$$.fragment,n),rn(r),s=!1},d(n){n&&(x(t),x(i)),o&&o.d(n),pn(e,n),r&&r.d(n)}}}function Uu(n){let t,e;return t=new ju({props:{onclick:function(){return n[8](n[14])},$$slots:{default:[Wu]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(e,i){n=e;const s={};2048&i&&(s.$$scope={dirty:i,ctx:n}),t.$set(s)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function Wu(n){let t;return{c(){t=C("…")},m(n,e){y(n,t,e)},d(n){n&&x(t)}}}function Du(n){let t,e=n[12][0]+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){2&i&&e!==(e=n[12][0]+"")&&S(t,e)},d(n){n&&x(t)}}}function Ku(n){let t,e;return t=new ju({props:{onclick:function(){return n[10](n[14])},$$slots:{default:[Ju]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(e,i){n=e;const s={};2048&i&&(s.$$scope={dirty:i,ctx:n}),t.$set(s)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function Ju(n){let t;return{c(){t=C("…")},m(n,e){y(n,t,e)},d(n){n&&x(t)}}}function Yu(n){let t,e,i,s,o;const r=[Hu,Ru],l=[];function c(n,e){return 2&e&&(t=null),null==t&&(t=!!Array.isArray(n[12])),t?0:1}return e=c(n,-1),i=l[e]=r[e](n),{c(){i.c(),s=P()},m(n,t){l[e].m(n,t),y(n,s,t),o=!0},p(n,t){let o=e;e=c(n,t),e===o?l[e].p(n,t):(en(),rn(l[o],1,1,(()=>{l[o]=null})),sn(),i=l[e],i?i.p(n,t):(i=l[e]=r[e](n),i.c()),on(i,1),i.m(s.parentNode,s))},i(n){o||(on(i),o=!0)},o(n){rn(i),o=!1},d(n){n&&x(s),l[e].d(n)}}}function Qu(n){let t,e,i=ln(n[1]),s=[];for(let t=0;t<i.length;t+=1)s[t]=Yu(Fu(n,i,t));const o=n=>rn(s[n],1,1,(()=>{s[n]=null}));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();t=P()},m(n,i){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(n,i);y(n,t,i),e=!0},p(n,e){if(2054&e){let r;for(i=ln(n[1]),r=0;r<i.length;r+=1){const o=Fu(n,i,r);s[r]?(s[r].p(o,e),on(s[r],1)):(s[r]=Yu(o),s[r].c(),on(s[r],1),s[r].m(t.parentNode,t))}for(en(),r=i.length;r<s.length;r+=1)o(r);sn()}},i(n){if(!e){for(let n=0;n<i.length;n+=1)on(s[n]);e=!0}},o(n){s=s.filter(Boolean);for(let n=0;n<s.length;n+=1)rn(s[n]);e=!1},d(n){n&&x(t),w(s,n)}}}function Vu(t){let e,i,s=t[0],o=Qu(t);return{c(){o.c(),e=P()},m(n,t){o.m(n,t),y(n,e,t),i=!0},p(t,[i]){1&i&&r(s,s=t[0])?(en(),rn(o,1,1,n),sn(),o=Qu(t),o.c(),on(o,1),o.m(e.parentNode,e)):o.p(t,i)},i(n){i||(on(o),i=!0)},o(n){rn(o),i=!1},d(n){n&&x(e),o.d(n)}}}function Gu(n,t,e){let i,s,{$$slots:o={},$$scope:r}=t,{hits:l=[]}=t;l.length||(l=[0]);let{phraselength:c=[5]}=t,{text:a=""}=t,u=1;const d=(n,t=0)=>{const o=i,[r,l]=s[n],c=l+(-1==t?r:0);let a=c;if(-1==t){for(;a>0&&(o[a].token.type>=Mn.SEARCHABLE||c-a<8);)a--;for(let n=a;n<c;n++)o[n].luminate++}else if(1==t){for(;a<o.length&&(o[a].token.type>=Mn.SEARCHABLE||a-c<8);)a++;for(let n=c;n<a;n++)o[n].luminate++}else for(let n=l;n<l+r;n++)o[n].luminate++;e(0,u++,u)};return n.$$set=n=>{"hits"in n&&e(3,l=n.hits),"phraselength"in n&&e(4,c=n.phraselength),"text"in n&&e(5,a=n.text),"$$scope"in n&&e(11,r=n.$$scope)},n.$$.update=()=>{56&n.$$.dirty&&e(6,[i]=((n="",t={})=>{const e=t.extra||[],i=t.hits||[],s=t.phraselength||[],o=new Kn(n,t.line||0);let r=0;const l=Fn(o.plain).map(((n,t)=>(r++,new ve(n,t,o,r)))),c=[];let a=0,u=0;for(let n=0;n<o.tags.length;n++){const t=o.tags[n],e=t.width?t.width:1;for(let i=t.choff;i<t.choff+e;i++)c[i]||(c[i]=[]),c[i].push(n)}for(let n=0;n<l.length;n++){const t=l[n];if(t.tags=c[t.token.choff]||[],e.length&&u<e.length&&t.choff==e[u].choff&&(t.extra=e[u],u++),i&&i.length&&a<i.length&&(t.postingoffset>=i[a]&&t.postingoffset<i[a]+s[a]&&t.token.type>=Mn.SEARCHABLE&&(t.highlight=!0),i[a]+s[a]<=t.postingoffset&&a++,t.highlight)){t.luminate++;let e=n+1;for(;e<l.length&&(l[e].token.type>=Mn.SEARCHABLE||e-n<8);)e++,e<l.length&&l[e].luminate++;for(e=n-1;e>0&&(l[e].token.type>=Mn.SEARCHABLE||n-e<8);)e--,e>=0&&l[e].luminate++}const o=Tn(t.text);if(t.hide||t.tags.length&&o){t.hide=!0;const e=ke(l,o,n+1);e&&(e.hide=!0)}}return[l,o]})(a,{hits:l,phraselength:c}),i),65&n.$$.dirty&&e(1,s=((n,t=10)=>{const e=[];let i=[];const s=(t=!1)=>{if(i.length>8)e.push([i.length,i[0],t]);else for(let t=0;t<i.length;t++)e.push(n[i[t]]);i=[]};if(n.length<t)return n;for(let t=0;t<n.length;t++){const o=n[t];o.luminate?(s(),e.push(o)):i.push(t)}return s(!0),e})(i,20))},[u,s,d,l,c,a,i,o,n=>d(n,1),n=>d(n),n=>d(n,-1),r]}class Xu extends $n{constructor(n){super(),mn(this,n,Gu,Vu,r,{hits:3,phraselength:4,text:5})}}function Zu(n){let t,e=n[6].text+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){64&i&&e!==(e=n[6].text+"")&&S(t,e)},d(n){n&&x(t)}}}function nd(n){let t,e,i,s,o=n[6].text+"";function r(){return n[5](n[6])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable hl0")},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(t,i){n=t,64&i&&o!==(o=n[6].text+"")&&S(e,o)},d(n){n&&x(t),i=!1,s()}}}function td(n){let t;function e(n,t){return n[6].highlight?nd:Zu}let i=e(n),s=i(n);return{c(){s.c(),t=P()},m(n,e){s.m(n,e),y(n,t,e)},p(n,o){i===(i=e(n))&&s?s.p(n,o):(s.d(1),s=i(n),s&&(s.c(),s.m(t.parentNode,t)))},d(n){n&&x(t),s.d(n)}}}function ed(n){let t,e;return t=new Xu({props:{phraselength:n[3],text:n[0],hits:n[2],$$slots:{default:[td,({tk:n})=>({6:n}),({tk:n})=>n?64:0]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,[e]){const i={};8&e&&(i.phraselength=n[3]),1&e&&(i.text=n[0]),4&e&&(i.hits=n[2]),210&e&&(i.$$scope={dirty:e,ctx:n}),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function id(n,t,e){let{linetext:i=""}=t,{line:s=0}=t,{hits:o=[]}=t,{phraselength:r=[]}=t,{gochar:l=function(n){}}=t;return n.$$set=n=>{"linetext"in n&&e(0,i=n.linetext),"line"in n&&e(1,s=n.line),"hits"in n&&e(2,o=n.hits),"phraselength"in n&&e(3,r=n.phraselength),"gochar"in n&&e(4,l=n.gochar)},[i,s,o,r,l,n=>l(s,n.choff)]}class sd extends $n{constructor(n){super(),mn(this,n,id,ed,r,{linetext:0,line:1,hits:2,phraselength:3,gochar:4})}}function od(n,t,e){const i=n.slice();return i[32]=t[e],i[34]=e,i}function rd(n,t,e){const i=n.slice();return i[35]=t[e],i[34]=e,i}function ld(n,t,e){const i=n.slice();return i[39]=t[e],i[34]=e,i}function cd(n){let t,e,i,o,r,l,c=wl(n[39].caption)+"",a="("+n[39].count+")";function u(){return n[19](n[34])}function d(){return n[20](n[34])}return{c(){t=A("span"),e=C(c),i=A("span"),o=C(a),T(t,"aria-hidden","true"),T(t,"class","clickable scopebtn"),L(t,"selected",2*n[34]==n[5]),T(i,"aria-hidden","true"),T(i,"class","clickable hitbtn"),L(i,"selected",1+2*n[34]==n[5])},m(n,s){y(n,t,s),b(t,e),y(n,i,s),b(i,o),r||(l=[I(t,"click",u),I(i,"click",d)],r=!0)},p(s,r){n=s,8&r[0]&&c!==(c=wl(n[39].caption)+"")&&S(e,c),32&r[0]&&L(t,"selected",2*n[34]==n[5]),8&r[0]&&a!==(a="("+n[39].count+")")&&S(o,a),32&r[0]&&L(i,"selected",1+2*n[34]==n[5])},d(n){n&&(x(t),x(i)),r=!1,s(l)}}}function ad(n){let t,e,i,s,o=wl(n[37])+"";function r(){return n[21](n[34])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",n[38])},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(i,s){n=i,64&s[1]&&o!==(o=wl(n[37])+"")&&S(e,o),128&s[1]&&L(t,"selected",n[38])},d(n){n&&x(t),i=!1,s()}}}function ud(n){let e,i,s,o,r,l,c,a,u,d,f,h=n[34]+n[2]*gd+1+"",p=Eu(Nu(n[35].line))+"";const g=[{gochar:n[14]},n[35]];let m={};for(let n=0;n<g.length;n+=1)m=t(m,g[n]);function $(){return n[23](n[34])}return o=new sd({props:m}),{c(){e=A("div"),i=A("span"),s=C(h),fn(o.$$.fragment),r=O(),l=A("span"),c=C(p),a=O(),T(i,"class","excerptseq"),T(l,"class","clickable ck"),T(l,"aria-hidden","true"),L(l,"selected",n[6]==n[34]+n[2]*gd),T(e,"class","excerptline"),L(e,"oddline",n[34]%2==0)},m(n,t){y(n,e,t),b(e,i),b(i,s),hn(o,e,null),b(e,r),b(e,l),b(l,c),b(e,a),u=!0,d||(f=I(l,"click",$),d=!0)},p(t,e){n=t,(!u||4&e[0])&&h!==(h=n[34]+n[2]*gd+1+"")&&S(s,h);const i=16385&e[0]?cn(g,[16384&e[0]&&{gochar:n[14]},1&e[0]&&an(n[35])]):{};o.$set(i),(!u||1&e[0])&&p!==(p=Eu(Nu(n[35].line))+"")&&S(c,p),(!u||68&e[0])&&L(l,"selected",n[6]==n[34]+n[2]*gd)},i(n){u||(on(o.$$.fragment,n),u=!0)},o(n){rn(o.$$.fragment,n),u=!1},d(n){n&&x(e),pn(o),d=!1,f()}}}function dd(n){let t,e,i=ln(n[0]),s=[];for(let t=0;t<i.length;t+=1)s[t]=ud(rd(n,i,t));const o=n=>rn(s[n],1,1,(()=>{s[n]=null}));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();t=P()},m(n,i){for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(n,i);y(n,t,i),e=!0},p(n,e){if(20549&e[0]){let r;for(i=ln(n[0]),r=0;r<i.length;r+=1){const o=rd(n,i,r);s[r]?(s[r].p(o,e),on(s[r],1)):(s[r]=ud(o),s[r].c(),on(s[r],1),s[r].m(t.parentNode,t))}for(en(),r=i.length;r<s.length;r+=1)o(r);sn()}},i(n){if(!e){for(let n=0;n<i.length;n+=1)on(s[n]);e=!0}},o(n){s=s.filter(Boolean);for(let n=0;n<s.length;n+=1)rn(s[n]);e=!1},d(n){n&&x(t),w(s,n)}}}function fd(n){var t;let e,i,o,r,l,c,a,u,d,f,h,p,g=n[34]+n[2]*gd+1+"",m=wl(null===(t=n[32].ck.bk)||void 0===t?void 0:t.caption)+"",$=wl(n[32].ck.caption)+"",v=" "+n[32].hits;function k(){return n[24](n[34])}function w(){return n[25](n[32])}return{c(){e=A("div"),i=A("span"),o=C(g),r=O(),l=C(m),c=C("/"),a=C($),u=O(),d=A("span"),f=C(v),T(i,"aria-hidden","true"),T(i,"class","excerptseq clickable"),L(i,"selected",n[6]==n[34]),T(d,"aria-hidden","true"),T(d,"class","clickable hit"),T(e,"class","excerptline"),L(e,"oddline",n[34]%2==0)},m(n,t){y(n,e,t),b(e,i),b(i,o),b(i,r),b(i,l),b(i,c),b(i,a),b(e,u),b(e,d),b(d,f),h||(p=[I(i,"click",k),I(d,"click",w)],h=!0)},p(t,e){var s;n=t,4&e[0]&&g!==(g=n[34]+n[2]*gd+1+"")&&S(o,g),2&e[0]&&m!==(m=wl(null===(s=n[32].ck.bk)||void 0===s?void 0:s.caption)+"")&&S(l,m),2&e[0]&&$!==($=wl(n[32].ck.caption)+"")&&S(a,$),64&e[0]&&L(i,"selected",n[6]==n[34]),2&e[0]&&v!==(v=" "+n[32].hits)&&S(f,v)},d(n){n&&x(e),h=!1,s(p)}}}function hd(n){let t,e=ln(n[1]),i=[];for(let t=0;t<e.length;t+=1)i[t]=fd(od(n,e,t));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();t=P()},m(n,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,e);y(n,t,e)},p(n,s){if(10310&s[0]){let o;for(e=ln(n[1]),o=0;o<e.length;o+=1){const r=od(n,e,o);i[o]?i[o].p(r,s):(i[o]=fd(r),i[o].c(),i[o].m(t.parentNode,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},d(n){n&&x(t),w(i,n)}}}function pd(n){let t,e,i,s,o,r,l,c,a,u,d=ln(n[3]),f=[];for(let t=0;t<d.length;t+=1)f[t]=cd(ld(n,d,t));function h(t){n[22](t)}let p={caption:n[7],count:n[4],onselect:n[10],$$slots:{default:[ad,({idx:n,caption:t,active:e})=>({34:n,37:t,38:e}),({idx:n,caption:t,active:e})=>[0,(n?8:0)|(t?64:0)|(e?128:0)]]},$$scope:{ctx:n}};return void 0!==n[2]&&(p.now=n[2]),s=new Ya({props:p}),U.push((()=>dn(s,"now",h))),l=new za({props:{onSwipe:n[15],reverse:"1"==n[8],$$slots:{default:[dd]},$$scope:{ctx:n}}}),a=new za({props:{onSwipe:n[15],reverse:"1"==n[8],$$slots:{default:[hd]},$$scope:{ctx:n}}}),{c(){t=A("div");for(let n=0;n<f.length;n+=1)f[n].c();e=O(),i=A("div"),fn(s.$$.fragment),r=O(),fn(l.$$.fragment),c=O(),fn(a.$$.fragment),T(i,"class","pager"),T(t,"class","bodytextarea")},m(n,o){y(n,t,o);for(let n=0;n<f.length;n+=1)f[n]&&f[n].m(t,null);b(t,e),b(t,i),hn(s,i,null),b(t,r),hn(l,t,null),b(t,c),hn(a,t,null),u=!0},p(n,i){if(552&i[0]){let s;for(d=ln(n[3]),s=0;s<d.length;s+=1){const o=ld(n,d,s);f[s]?f[s].p(o,i):(f[s]=cd(o),f[s].c(),f[s].m(t,e))}for(;s<f.length;s+=1)f[s].d(1);f.length=d.length}const r={};128&i[0]&&(r.caption=n[7]),16&i[0]&&(r.count=n[4]),1224&i[1]&&(r.$$scope={dirty:i,ctx:n}),!o&&4&i[0]&&(o=!0,r.now=n[2],Q((()=>o=!1))),s.$set(r);const c={};256&i[0]&&(c.reverse="1"==n[8]),69&i[0]|1024&i[1]&&(c.$$scope={dirty:i,ctx:n}),l.$set(c);const u={};256&i[0]&&(u.reverse="1"==n[8]),70&i[0]|1024&i[1]&&(u.$$scope={dirty:i,ctx:n}),a.$set(u)},i(n){u||(on(s.$$.fragment,n),on(l.$$.fragment,n),on(a.$$.fragment,n),u=!0)},o(n){rn(s.$$.fragment,n),rn(l.$$.fragment,n),rn(a.$$.fragment,n),u=!1},d(n){n&&x(t),w(f,n),pn(s),pn(l),pn(a)}}}const gd=5;function md(n,t,e){let i,s,o,r;h(n,so,(n=>e(17,s=n))),h(n,Co,(n=>e(18,o=n))),h(n,Go,(n=>e(8,r=n)));let{goLine:l}=t,c=[],a=[],u=[],d=[],f=0,p=[],g=0,m=0,$=-1,v="";const k=async(n,t)=>{var s;const r=Math.floor(n/2);if(e(4,g=0),!(null===(s=p[r])||void 0===s?void 0:s.count))return;e(5,m=n),t||e(7,v="");const{lines:l,chunks:a,phrases:d,postings:f}=await(async(n,t,e={})=>{var i;if(!n)return{};const s=null===(i=n.inverted)||void 0===i?void 0:i.tokenlinepos;if(!s)return{};let o=0,r=0;if(e.range){const[t,i]=n.rangeOfAddress(e.range);o=s[t],r=s[i]}else o=s[0],r=s[n.header.eot];const[l,c]=await n.parseQuery(t,{tosim:"zh"==n.attributes.lang});let a={},u={},d=0;const f=(n.defines.ck||n.defines.dk).linepos,h=n.defines.ck?"ck":"dk";for(let t=0;t<c.length;t++){const i=Mt(c[t],o,r),[s,h]=Ft(i,n.inverted.tokenlinepos,!0),p=l[t].length;d+=i.length;for(let n=0;n<s.length;n++){const t=s[n];let i=!1;if(e.includelines){const n=Qn(e.includelines,t);e.includelines[n]!==t&&(i=!0)}if(e.excludelines){const n=Qn(e.excludelines,t);e.excludelines[n]==t&&(i=!0)}if(i)continue;u[t]||(u[t]=[]),u[t].push(...h[n].map((n=>16*n+p)));const o=Qn(f,t+1)-1;a[o]||(a[o]=0),a[o]++}}return{lines:tt(u,((n,t)=>[parseInt(n),t.sort()])).sort(((n,t)=>n[0]-t[0])),chunks:tt(a,((n,t)=>[parseInt(n),t])).sort(((n,t)=>t[1]-n[1])),phrases:l,postings:c,chunktag:h}})(i,o,{range:t||p[r].scope});m%2==0?(u=a.map((n=>({ck:i.getChunk(n[0]),hits:n[1]}))),e(4,g=Math.floor(u.length/gd)+1),b(0)):(c=l,e(4,g=Math.floor(c.length/gd)+1),b(0))},b=async n=>{if(e(0,a.length=0,a),e(1,d.length=0,d),e(6,$=-1),m%2==0)e(1,d=u.slice(n*gd,(n+1)*gd)),e(4,g=Math.floor(u.length/gd)+1);else{const t=[];for(let e=n*gd;e<(n+1)*gd&&e<c.length;e++)t.push(c[e]);await i.loadLines(t.map((n=>n[0])));for(let n=0;n<t.length;n++){const[e,s]=t[n],o=i.getLine(e),r=s.map((n=>Math.floor(n/16))),l=s.map((n=>n%16));a.push({linetext:o,line:e,hits:r,phraselength:l})}e(4,g=Math.floor(c.length/gd)+1)}e(0,a),e(1,d),e(2,f=n)},y=n=>{var t;const i="bk#"+n.bk.id+".ck#"+n.id;e(7,v=((null===(t=n.bk)||void 0===t?void 0:t.caption)||"")+"/"+n.caption),k(2*m+1,i)},x=n=>{let t=c[n][0];l(t),e(6,$=n)},w=n=>{const t=d[n].ck.line;l(t),e(6,$=n)};return n.$$set=n=>{"goLine"in n&&e(16,l=n.goLine)},n.$$.update=()=>{var t;131072&n.$$.dirty[0]&&(i=Ki(s)),393216&n.$$.dirty[0]&&(t=o,i.scanText(t).then((n=>{e(3,p=n);let t=!1;for(let n=0;n<p.length;n++)if(p[n].count){k(2*n+1),t=!0;break}t||(c=[],b(0))})))},[a,d,f,p,g,m,$,v,r,k,b,y,x,w,(n,t)=>{l(n,t)},n=>{const t=a.length?a:d;e(2,f+=n),f<0&&e(2,f=0),f>=t.length-1&&e(2,f=t.length-1),b(f)},l,s,o,n=>k(2*n),n=>k(2*n+1),n=>b(n),function(n){f=n,e(2,f)},n=>x(n+f*gd),n=>w(n),n=>y(n.ck)]}class $d extends $n{constructor(n){super(),mn(this,n,md,pd,r,{goLine:16},null,[-1,-1])}}function vd(n,t,e){const i=n.slice();return i[18]=t[e],i[20]=e,i}function kd(n){let t,e,i,s,o=wl(n[18])+"";function r(){return n[14](n[20])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","searchable"),L(t,"selectedsearchable",n[20]<=n[2])},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(i,s){n=i,1&s&&o!==(o=wl(n[18])+"")&&S(e,o),4&s&&L(t,"selectedsearchable",n[20]<=n[2])},d(n){n&&x(t),i=!1,s()}}}function bd(n){let t,e,i,s=wl("候選區")+"";return{c(){t=C("【"),e=C(s),i=C("】")},m(n,s){y(n,t,s),y(n,e,s),y(n,i,s)},d(n){n&&(x(t),x(e),x(i))}}}function yd(t){let e,i,s,o,r;return i=new $d({props:{goLine:t[7]}}),o=new Ql({}),{c(){e=A("div"),fn(i.$$.fragment),s=O(),fn(o.$$.fragment),T(e,"class","bodytext")},m(n,t){y(n,e,t),hn(i,e,null),y(n,s,t),hn(o,n,t),r=!0},p:n,i(n){r||(on(i.$$.fragment,n),on(o.$$.fragment,n),r=!0)},o(n){rn(i.$$.fragment,n),rn(o.$$.fragment,n),r=!1},d(n){n&&(x(e),x(s)),pn(i),pn(o,n)}}}function xd(t){let e,i,s,o;return e=new Su({}),s=new Ql({}),{c(){fn(e.$$.fragment),i=O(),fn(s.$$.fragment)},m(n,t){hn(e,n,t),y(n,i,t),hn(s,n,t),o=!0},p:n,i(n){o||(on(e.$$.fragment,n),on(s.$$.fragment,n),o=!0)},o(n){rn(e.$$.fragment,n),rn(s.$$.fragment,n),o=!1},d(n){n&&x(i),pn(e,n),pn(s,n)}}}function wd(n){let t,e,i,o,r,l,c,a,u,d,f,h,p=ln(n[0]),g=[];for(let t=0;t<p.length;t+=1)g[t]=kd(vd(n,p,t));let m=!n[0].length&&bd();const $=[xd,yd],v=[];function k(n,t){return 24&t&&(l=null),null==l&&(l=!("input"!=n[4]||""!=n[3].trim())),l?0:1}return c=k(n,-1),a=v[c]=$[c](n),{c(){t=A("div"),e=A("input"),i=O();for(let n=0;n<g.length;n+=1)g[n].c();o=O(),m&&m.c(),r=O(),a.c(),u=P(),T(e,"class","tofind svelte-a8ib29"),T(e,"placeholder",wl("輸入區")),T(e,"size",8),T(e,"id","tofind"),L(e,"diminput",n[2]>-1),T(t,"class","bodytext")},m(s,l){y(s,t,l),b(t,e),n[12](e),N(e,n[3]),b(t,i);for(let n=0;n<g.length;n+=1)g[n]&&g[n].m(t,null);b(t,o),m&&m.m(t,null),y(s,r,l),v[c].m(s,l),y(s,u,l),d=!0,f||(h=[I(e,"focus",n[9]),I(e,"blur",n[8]),I(e,"input",n[6]),I(e,"input",n[13])],f=!0)},p(n,[i]){if(8&i&&e.value!==n[3]&&N(e,n[3]),(!d||4&i)&&L(e,"diminput",n[2]>-1),37&i){let e;for(p=ln(n[0]),e=0;e<p.length;e+=1){const s=vd(n,p,e);g[e]?g[e].p(s,i):(g[e]=kd(s),g[e].c(),g[e].m(t,o))}for(;e<g.length;e+=1)g[e].d(1);g.length=p.length}n[0].length?m&&(m.d(1),m=null):m||(m=bd(),m.c(),m.m(t,null));let s=c;c=k(n,i),c===s?v[c].p(n,i):(en(),rn(v[s],1,1,(()=>{v[s]=null})),sn(),a=v[c],a?a.p(n,i):(a=v[c]=$[c](n),a.c()),on(a,1),a.m(u.parentNode,u))},i(n){d||(on(a),d=!0)},o(n){rn(a),d=!1},d(e){e&&(x(t),x(r),x(u)),n[12](null),w(g,e),m&&m.d(),v[c].d(e),f=!1,s(h)}}}function Ad(n,t,e){let i,s;h(n,xo,(n=>e(11,i=n))),h(n,wo,(n=>e(4,s=n)));let o,{ptk:r}=t,l=[],c=-1,a="";let u="";const d=n=>{u="";for(let t=0;t<=n;t++)u+=l[t]||"";n==c?a==u?e(3,a=""):(e(3,a=u),e(2,c=-1)):e(2,c=n),Co.set(u)};let p=0;return n.$$set=n=>{"ptk"in n&&e(10,r=n.ptk)},n.$$.update=()=>{2048&n.$$.dirty&&(n=>{e(0,l.length=0,l);const t=En(n);for(let n=0;n<t.length;n++)l.push(t[n]);l.length>=2?e(2,c=2):1==l.length?e(2,c=0):0==l.length&&e(2,c=-1)})(i)},[l,o,c,a,s,d,()=>{e(2,c=-1),clearTimeout(p),p=setTimeout((()=>{Co.set(a)}),250)},(n,t=0)=>{wr(r,n,t),wo.set("folio"),(n=>{if(!(n=n.trim().slice(0,20)))return;let t=f(Oo);if(t[0]!=n){for(t=hr(n),t.unshift(n);t.length>10;)t.pop();Oo.set(t.slice(0,t.length))}})(a)},()=>{setTimeout((()=>{wo.set("folio")}),200)},()=>{e(2,c=-1),wo.set("input")},r,i,function(n){U[n?"unshift":"push"]((()=>{o=n,e(1,o)}))},function(){a=this.value,e(3,a)},n=>d(n)]}class Cd extends $n{constructor(n){super(),mn(this,n,Ad,wd,r,{ptk:10})}}function Od(n,t,e){const i=n.slice();return i[1]=t[e][0],i[2]=t[e][1],i}function Pd(n){let t,e,i,s,o=n[1]+"";return{c(){t=A("a"),e=C(o),s=C(" "),T(t,"href",i=n[2]),T(t,"target","_new")},m(n,i){y(n,t,i),b(t,e),y(n,s,i)},p(n,s){1&s&&o!==(o=n[1]+"")&&S(e,o),1&s&&i!==(i=n[2])&&T(t,"href",i)},d(n){n&&(x(t),x(s))}}}function Id(t){let e,i=ln(t[0]),s=[];for(let n=0;n<i.length;n+=1)s[n]=Pd(Od(t,i,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=P()},m(n,t){for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,t);y(n,e,t)},p(n,[t]){if(1&t){let o;for(i=ln(n[0]),o=0;o<i.length;o+=1){const r=Od(n,i,o);s[o]?s[o].p(r,t):(s[o]=Pd(r),s[o].c(),s[o].m(e.parentNode,e))}for(;o<s.length;o+=1)s[o].d(1);s.length=i.length}},i:n,o:n,d(n){n&&x(e),w(s,n)}}}function Td(n,t,e){let{links:i=[]}=t;return n.$$set=n=>{"links"in n&&e(0,i=n.links)},[i]}class _d extends $n{constructor(n){super(),mn(this,n,Td,Id,r,{links:0})}}function Sd(n,t,e){const i=n.slice();return i[6]=t[e],i}function Nd(n){let t,e,i=Wn(n[6])[0]+"";return{c(){t=A("div"),e=C(i)},m(n,i){y(n,t,i),b(t,e)},p(n,t){2&t&&i!==(i=Wn(n[6])[0]+"")&&S(e,i)},d(n){n&&x(t)}}}function Ed(t){let e,i,s,o,r,l,c,a=ln(t[1]),u=[];for(let n=0;n<a.length;n+=1)u[n]=Nd(Sd(t,a,n));return{c(){e=A("div"),i=A("span"),s=C("←"),o=C(t[0]),r=O();for(let n=0;n<u.length;n+=1)u[n].c();T(i,"aria-hidden","true"),T(i,"class","clickable"),T(e,"class","bodytext")},m(n,a){y(n,e,a),b(e,i),b(i,s),b(i,o),b(e,r);for(let n=0;n<u.length;n+=1)u[n]&&u[n].m(e,null);l||(c=I(i,"click",t[2]),l=!0)},p(n,[t]){if(1&t&&S(o,n[0]),2&t){let i;for(a=ln(n[1]),i=0;i<a.length;i+=1){const s=Sd(n,a,i);u[i]?u[i].p(s,t):(u[i]=Nd(s),u[i].c(),u[i].m(e,null))}for(;i<u.length;i+=1)u[i].d(1);u.length=a.length}},i:n,o:n,d(n){n&&x(e),w(u,n),l=!1,c()}}}function zd(n,t,e){let{address:i}=t,{ptk:s}=t,{caption:o}=t,r=[];return n.$$set=n=>{"address"in n&&e(3,i=n.address),"ptk"in n&&e(4,s=n.ptk),"caption"in n&&e(0,o=n.caption)},n.$$.update=()=>{8&n.$$.dirty&&(async()=>{e(1,r=await s.fetchAddress(i))})()},[o,r,()=>{Ar(s)},i,s]}class Ld extends $n{constructor(n){super(),mn(this,n,zd,Ed,r,{address:3,ptk:4,caption:0})}}function Md(n,t,e){const i=n.slice();return i[19]=t[e],i[21]=e,i}function jd(n,t,e){const i=n.slice();return i[19]=t[e],i[21]=e,i}function Fd(n){let t,e,i;return{c(){t=A("span"),t.textContent="原文",T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected","sourcetext"==n[2])},m(s,o){y(s,t,o),e||(i=I(t,"click",n[12]),e=!0)},p(n,e){4&e&&L(t,"selected","sourcetext"==n[2])},d(n){n&&x(t),e=!1,i()}}}function Bd(n){let t,e,i,s,o=wl("別譯",n[6])+"";return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected","translations"==n[2])},m(o,r){y(o,t,r),b(t,e),i||(s=I(t,"click",n[13]),i=!0)},p(n,i){64&i&&o!==(o=wl("別譯",n[6])+"")&&S(e,o),4&i&&L(t,"selected","translations"==n[2])},d(n){n&&x(t),i=!1,s()}}}function qd(n){let t,e,i,s,o=wl("集註",n[6])+"";return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected","variorum"==n[2])},m(o,r){y(o,t,r),b(t,e),i||(s=I(t,"click",n[14]),i=!0)},p(n,i){64&i&&o!==(o=wl("集註",n[6])+"")&&S(e,o),4&i&&L(t,"selected","variorum"==n[2])},d(n){n&&x(t),i=!1,s()}}}function Rd(n){let t,e,i,s,o=n[19][0]+"";function r(){return n[15](n[21])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",n[2]=="link"+n[21])},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(i,s){n=i,8&s&&o!==(o=n[19][0]+"")&&S(e,o),4&s&&L(t,"selected",n[2]=="link"+n[21])},d(n){n&&x(t),i=!1,s()}}}function Hd(n){let t,e;return t=new _d({props:{links:n[4]}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};16&e&&(i.links=n[4]),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function Ud(n){let t,e,i;return e=new Ld({props:{closePopup:n[0],caption:n[19][0],ptk:n[5],address:n[19][1]}}),{c(){t=A("div"),fn(e.$$.fragment),T(t,"class","subtab-content"),L(t,"visible",n[2]=="link"+n[21])},m(n,s){y(n,t,s),hn(e,t,null),i=!0},p(n,s){const o={};1&s&&(o.closePopup=n[0]),8&s&&(o.caption=n[19][0]),32&s&&(o.ptk=n[5]),8&s&&(o.address=n[19][1]),e.$set(o),(!i||4&s)&&L(t,"visible",n[2]=="link"+n[21])},i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){n&&x(t),pn(e)}}}function Wd(t){let e,i,o,l,c,a,u,d,f,h,p,g,m,$,v,k,_,N,E,z,M,j,F,B,q,R,H,U,W,D,K=wl("搜尋",t[6])+"",J=tr(Mo(t[1])),Y=er(t[5],Mo(t[1])),Q=nr(Mo(t[1])),V=t[4],G=J&&Fd(t),X=Y&&Bd(t),Z=Q&&qd(t),nn=ln(t[3]),tn=[];for(let n=0;n<nn.length;n+=1)tn[n]=Rd(jd(t,nn,n));let cn=Hd(t);m=new Cd({props:{ptk:t[5]}}),k=new mu({props:{ptk:t[5]}}),E=new yu({props:{ptk:t[5]}}),j=new su({props:{closePopup:t[0],ptk:t[5]}}),q=new Au({});let an=ln(t[3]),un=[];for(let n=0;n<an.length;n+=1)un[n]=Ud(Md(t,an,n));const dn=n=>rn(un[n],1,1,(()=>{un[n]=null}));return{c(){e=A("div"),i=A("span"),o=C(K),l=O(),c=A("span"),c.textContent="全文",a=O(),G&&G.c(),u=O(),X&&X.c(),d=O(),Z&&Z.c(),f=O();for(let n=0;n<tn.length;n+=1)tn[n].c();h=O(),cn.c(),p=O(),g=A("div"),fn(m.$$.fragment),$=O(),v=A("div"),fn(k.$$.fragment),_=O(),N=A("div"),fn(E.$$.fragment),z=O(),M=A("div"),fn(j.$$.fragment),F=O(),B=A("div"),fn(q.$$.fragment),R=O();for(let n=0;n<un.length;n+=1)un[n].c();H=P(),T(i,"aria-hidden","true"),T(i,"class","clickable"),L(i,"selected","search"==t[2]),T(c,"aria-hidden","true"),T(c,"class","clickable"),L(c,"selected","chunktext"==t[2]),T(e,"class","tabs"),T(g,"class","subtab-content"),L(g,"visible","search"==t[2]),T(v,"class","subtab-content"),L(v,"visible","chunktext"==t[2]),T(N,"class","subtab-content"),L(N,"visible","sourcetext"==t[2]),T(M,"class","subtab-content"),L(M,"visible","translations"==t[2]),T(B,"class","subtab-content"),L(B,"visible","variorum"==t[2])},m(n,s){y(n,e,s),b(e,i),b(i,o),b(e,l),b(e,c),b(e,a),G&&G.m(e,null),b(e,u),X&&X.m(e,null),b(e,d),Z&&Z.m(e,null),b(e,f);for(let n=0;n<tn.length;n+=1)tn[n]&&tn[n].m(e,null);b(e,h),cn.m(e,null),y(n,p,s),y(n,g,s),hn(m,g,null),y(n,$,s),y(n,v,s),hn(k,v,null),y(n,_,s),y(n,N,s),hn(E,N,null),y(n,z,s),y(n,M,s),hn(j,M,null),y(n,F,s),y(n,B,s),hn(q,B,null),y(n,R,s);for(let t=0;t<un.length;t+=1)un[t]&&un[t].m(n,s);y(n,H,s),U=!0,W||(D=[I(i,"click",t[10]),I(c,"click",t[11])],W=!0)},p(t,[s]){if((!U||64&s)&&K!==(K=wl("搜尋",t[6])+"")&&S(o,K),(!U||4&s)&&L(i,"selected","search"==t[2]),(!U||4&s)&&L(c,"selected","chunktext"==t[2]),2&s&&(J=tr(Mo(t[1]))),J?G?G.p(t,s):(G=Fd(t),G.c(),G.m(e,u)):G&&(G.d(1),G=null),34&s&&(Y=er(t[5],Mo(t[1]))),Y?X?X.p(t,s):(X=Bd(t),X.c(),X.m(e,d)):X&&(X.d(1),X=null),2&s&&(Q=nr(Mo(t[1]))),Q?Z?Z.p(t,s):(Z=qd(t),Z.c(),Z.m(e,f)):Z&&(Z.d(1),Z=null),140&s){let n;for(nn=ln(t[3]),n=0;n<nn.length;n+=1){const i=jd(t,nn,n);tn[n]?tn[n].p(i,s):(tn[n]=Rd(i),tn[n].c(),tn[n].m(e,h))}for(;n<tn.length;n+=1)tn[n].d(1);tn.length=nn.length}16&s&&r(V,V=t[4])?(en(),rn(cn,1,1,n),sn(),cn=Hd(t),cn.c(),on(cn,1),cn.m(e,null)):cn.p(t,s);const l={};32&s&&(l.ptk=t[5]),m.$set(l),(!U||4&s)&&L(g,"visible","search"==t[2]);const a={};32&s&&(a.ptk=t[5]),k.$set(a),(!U||4&s)&&L(v,"visible","chunktext"==t[2]);const p={};32&s&&(p.ptk=t[5]),E.$set(p),(!U||4&s)&&L(N,"visible","sourcetext"==t[2]);const $={};if(1&s&&($.closePopup=t[0]),32&s&&($.ptk=t[5]),j.$set($),(!U||4&s)&&L(M,"visible","translations"==t[2]),(!U||4&s)&&L(B,"visible","variorum"==t[2]),45&s){let n;for(an=ln(t[3]),n=0;n<an.length;n+=1){const e=Md(t,an,n);un[n]?(un[n].p(e,s),on(un[n],1)):(un[n]=Ud(e),un[n].c(),on(un[n],1),un[n].m(H.parentNode,H))}for(en(),n=an.length;n<un.length;n+=1)dn(n);sn()}},i(n){if(!U){on(cn),on(m.$$.fragment,n),on(k.$$.fragment,n),on(E.$$.fragment,n),on(j.$$.fragment,n),on(q.$$.fragment,n);for(let n=0;n<an.length;n+=1)on(un[n]);U=!0}},o(n){rn(cn),rn(m.$$.fragment,n),rn(k.$$.fragment,n),rn(E.$$.fragment,n),rn(j.$$.fragment,n),rn(q.$$.fragment,n),un=un.filter(Boolean);for(let n=0;n<un.length;n+=1)rn(un[n]);U=!1},d(n){n&&(x(e),x(p),x(g),x($),x(v),x(_),x(N),x(z),x(M),x(F),x(B),x(R),x(H)),G&&G.d(),X&&X.d(),Z&&Z.d(),w(tn,n),cn.d(n),pn(m),pn(k),pn(E),pn(j),pn(q),w(un,n),W=!1,s(D)}}}function Dd(n,t,e){let i,s,o,r,l,c,a,u,d;h(n,ao,(n=>e(8,r=n))),h(n,uo,(n=>e(1,l=n))),h(n,Wo,(n=>e(16,c=n))),h(n,Ao,(n=>e(17,a=n))),h(n,so,(n=>e(9,u=n))),h(n,_o,(n=>e(6,d=n)));let{closePopup:f}=t;const p=n=>{const t=Ki("dc"),[s,o]=i.rangeOfAddress("folio#"+n+".pb#"+r),l=[],u=[],d=n.match(/agms(\d+)$/),f=a;if(!f)return[[],[]];let h,p,g,$;if(d){const n=i.nearestTag(o+1,"n"),e=i.defines.n;p=parseInt(e.fields.id.values[n]),g=wl("雜")+p+wl("導讀"),$="https://buddhaspace.org/agama/"+d[1]+".html#"+(n=>{let t="";for(;n;)t=["〇","一","二","三","四","五","六","七","八","九"][n%10]+t,n=Math.floor(n/10);return t})(p),l.push([g,$]),h=t.columns.par_agms}if(n.match(/agmss(\d+)$/)){const n=i.nearestTag(o+1,"n"),e=i.defines.n;p=parseInt(e.fields.id.values[n]),h=t.columns.par_agmss}if(n.match(/agmd(\d+)$/)){const n=f.fromFolioPos(c);n&&n.ckid&&(g="長"+parseInt(n.ckid)+wl("導讀"),$="https://buddhaspace.org/agama3/"+parseInt(n.ckid)+".html",p=n.ckid,l.push([g,$])),h=t.columns.par_agmd}if(n.match(/agmm(\d+)$/)){const n=f.fromFolioPos(c);n&&n.ckid&&(p=n.ckid,g="中"+parseInt(n.ckid)+wl("導讀"),$="https://buddhaspace.org/agama2/sub/"+n.ckid+".html",l.push([g,$])),h=t.columns.par_agmm}if(n.match(/agmu(\d+)$/)){h=t.columns.par_agmu;const n=f.fromFolioPos(c);n&&n.ckid&&(p=n.ckid)}if(h&&p){const n=h.keys.indexOf(p.toString()),t=(h.parallels[n]||"").split(",");for(let n=0;n<t.length;n++){const e=t[n];if(e.match(/ak#[dmsa]n/)){const n=location.host.replace("5002","5080"),t=location.protocol+"//"+n+location.pathname.replace("ylz","sz")+"#"+e;l.push([zu(e),t])}else u.push([Eu(e),e])}}return m.startsWith("link")&&e(2,m="chunktext"),[l,u]},g=n=>{wo.set("folio"),e(2,m=n)};let m="search";return n.$$set=n=>{"closePopup"in n&&e(0,f=n.closePopup)},n.$$.update=()=>{512&n.$$.dirty&&e(5,i=Ki(u)),258&n.$$.dirty&&e(4,[s,o]=p(l),s,(e(3,o),e(1,l),e(8,r)))},[f,l,m,o,s,i,d,g,r,u,()=>g("search"),()=>g("chunktext"),()=>g("sourcetext"),()=>g("translations"),()=>g("variorum"),n=>g("link"+n)]}class Kd extends $n{constructor(n){super(),mn(this,n,Dd,Wd,r,{closePopup:0})}}function Jd(t){let e,i,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,w,P,_,N,E,z=wl(t[3])+"",L=wl(t[0])+"",M=wl(t[1])+"",j=wl(t[2])+"",F=fr()+"";return{c(){e=A("div"),i=C(z),o=A("br"),r=C(L),l=C("《"),c=C(M),a=C("》"),u=C(j),d=O(),f=A("button"),f.textContent=`${wl("複製連結")}`,h=O(),p=A("button"),p.textContent=`${wl("複製經文及連結")}`,g=O(),m=A("button"),m.textContent=`${wl("HTML格式連結")}`,$=O(),v=A("button"),v.textContent=`${wl("MarkDown格式連結")}`,k=O(),w=A("span"),P=O(),_=C(F),T(e,"class","bodytext"),T(f,"class","svelte-1o0xp9s"),T(p,"class","svelte-1o0xp9s"),T(m,"class","svelte-1o0xp9s"),T(v,"class","svelte-1o0xp9s")},m(n,s){y(n,e,s),b(e,i),b(e,o),b(e,r),b(e,l),b(e,c),b(e,a),b(e,u),y(n,d,s),y(n,f,s),y(n,h,s),y(n,p,s),y(n,g,s),y(n,m,s),y(n,$,s),y(n,v,s),y(n,k,s),y(n,w,s),w.innerHTML=t[4],y(n,P,s),y(n,_,s),N||(E=[I(f,"click",t[6]),I(p,"click",t[5]),I(m,"click",t[8]),I(v,"click",t[7])],N=!0)},p(n,[t]){8&t&&z!==(z=wl(n[3])+"")&&S(i,z),1&t&&L!==(L=wl(n[0])+"")&&S(r,L),2&t&&M!==(M=wl(n[1])+"")&&S(c,M),4&t&&j!==(j=wl(n[2])+"")&&S(u,j)},i:n,o:n,d(n){n&&(x(e),x(d),x(f),x(h),x(p),x(g),x(m),x($),x(v),x(k),x(w),x(P),x(_)),N=!1,s(E)}}}const Yd="已複製連結到剪貼薄";function Qd(n,t,e){let i,s;h(n,Wo,(n=>e(9,i=n))),h(n,Ao,(n=>e(10,s=n)));let o,r="",l="",c=Yd;B((async()=>{const n=s.fromFolioPos(i);e(0,o=Wn((null==n?void 0:n.linetext)||"")[0]),e(1,r=(null==n?void 0:n.ck.bk.heading)||""),e(2,l=null==n?void 0:n.ck.caption)}));const a=n=>{e(3,c=n),clearTimeout(undefined)};return[o,r,l,c,"",async()=>{const n=fr()+"\t「"+o+"」《"+r+"》"+l;await navigator.clipboard.writeText(n),a("已複製經文及連結到剪貼薄")},async()=>{navigator.clipboard.writeText(fr()),a(Yd)},async()=>{const n="["+o+"《"+r+"》"+l+"]("+fr()+")";await navigator.clipboard.writeText(n),a("已複製Markdown格式到剪貼薄")},async()=>{const n=o+'<a href="'+fr()+'">《'+r+"》"+l+"</a>";await navigator.clipboard.writeText(n),a("已複製HTML格式到剪貼薄")}]}class Vd extends $n{constructor(n){super(),mn(this,n,Qd,Jd,r,{})}}function Gd(n){let t,e,i;function s(t){n[11](t)}let o={max:n[0].length,min:1,$$slots:{caption:[nf]},$$scope:{ctx:n}};return void 0!==n[1]&&(o.value=n[1]),t=new wc({props:o}),U.push((()=>dn(t,"value",s))),t.$on("input",kt(n[4],300)),{c(){fn(t.$$.fragment)},m(n,e){hn(t,n,e),i=!0},p(n,i){const s={};1&i&&(s.max=n[0].length),262147&i&&(s.$$scope={dirty:i,ctx:n}),!e&&2&i&&(e=!0,s.value=n[1],Q((()=>e=!1))),t.$set(s)},i(n){i||(on(t.$$.fragment,n),i=!0)},o(n){rn(t.$$.fragment,n),i=!1},d(n){pn(t,n)}}}function Xd(n){let t,e;return t=new Ya({props:{pages:n[0],caption:"卷",now:n[2]-1,onselect:n[10],$$slots:{default:[tf,({active:n,caption:t,id:e})=>({15:n,16:t,17:e}),({active:n,caption:t,id:e})=>(n?32768:0)|(t?65536:0)|(e?131072:0)]},$$scope:{ctx:n}}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};1&e&&(i.pages=n[0]),491520&e&&(i.$$scope={dirty:e,ctx:n}),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function Zd(t){let e;return{c(){e=A("span")},m(n,t){y(n,e,t)},p:n,i:n,o:n,d(n){n&&x(e)}}}function nf(n){let t,e,i,s,o,r=(n[1][0]||1)+"",l=n[0].length+"";return{c(){t=A("span"),e=C("卷"),i=C(r),s=C("/"),o=C(l),T(t,"slot","caption"),E(t,"float","right")},m(n,r){y(n,t,r),b(t,e),b(t,i),b(t,s),b(t,o)},p(n,t){2&t&&r!==(r=(n[1][0]||1)+"")&&S(i,r),1&t&&l!==(l=n[0].length+"")&&S(o,l)},d(n){n&&x(t)}}}function tf(n){let t,e,i,s,o=n[16]+"";function r(){return n[9](n[17])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected",n[15])},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(i,s){n=i,65536&s&&o!==(o=n[16]+"")&&S(e,o),32768&s&&L(t,"selected",n[15])},d(n){n&&x(t),i=!1,s()}}}function ef(n){let t,e,i,s;const o=[Zd,Xd,Gd],r=[];function l(n,t){return 0==n[0].length?0:n[0].length<10?1:2}return t=l(n),e=r[t]=o[t](n),{c(){e.c(),i=P()},m(n,e){r[t].m(n,e),y(n,i,e),s=!0},p(n,[s]){let c=t;t=l(n),t===c?r[t].p(n,s):(en(),rn(r[c],1,1,(()=>{r[c]=null})),sn(),e=r[t],e?e.p(n,s):(e=r[t]=o[t](n),e.c()),on(e,1),e.m(i.parentNode,i))},i(n){s||(on(e),s=!0)},o(n){rn(e),s=!1},d(n){n&&x(i),r[t].d(n)}}}function sf(n,t,e){let i,s,o,r;h(n,ro,(n=>e(6,s=n))),h(n,uo,(n=>e(7,o=n))),h(n,so,(n=>e(8,r=n)));let{closePopup:l}=t,c=[];const a=o.match(/([a-z_]+)(\d+$)/);let u=a?parseInt(a[2]):1,d=[1,0];const f=n=>{const t=o,e=t.replace(/\d+$/,n);e!=t&&kr(e,(function(){ao.set("1"),Wo.set(["1",0,0]),wt(sr()),l(),p(e)}))},p=(n,t)=>{if(!i||t)return[];if(!n.match(/([a-z_]+)(\d+$)/))return[];e(1,d[0]=u,d);return br(i,n).map(((n,t)=>({caption:n,idx:parseInt(t),id:(t+1).toString()})))};return n.$$set=n=>{"closePopup"in n&&e(5,l=n.closePopup)},n.$$.update=()=>{256&n.$$.dirty&&(i=Ki(r)),192&n.$$.dirty&&e(0,c=p(o,s))},[c,d,u,f,n=>{const t=(n.detail[0]||1).toString();f(t)},l,s,o,r,n=>f(n),n=>f(n+1),function(n){d=n,e(1,d)}]}class of extends $n{constructor(n){super(),mn(this,n,sf,ef,r,{closePopup:5})}}function rf(n,t,e){const i=n.slice();return i[17]=t[e],i}function lf(t){let e;return{c(){e=C("載入中")},m(n,t){y(n,e,t)},p:n,i:n,o:n,d(n){n&&x(e)}}}function cf(n){let t,e,i,s,o,l,c,a,u,d=n[7];function f(t){n[13](t)}t=new of({props:{closePopup:n[0]}});let h={max:n[6],min:1,$$slots:{caption:[af]},$$scope:{ctx:n}};void 0!==n[5]&&(h.value=n[5]),i=new wc({props:h}),U.push((()=>dn(i,"value",f))),i.$on("input",kt(n[8],800));let p=df(n);return a=new Ql({}),{c(){fn(t.$$.fragment),e=O(),fn(i.$$.fragment),o=O(),l=A("div"),p.c(),c=O(),fn(a.$$.fragment),T(l,"class","toc svelte-1ubc3jc")},m(n,s){hn(t,n,s),y(n,e,s),hn(i,n,s),y(n,o,s),y(n,l,s),p.m(l,null),b(l,c),hn(a,l,null),u=!0},p(n,e){const o={};1&e&&(o.closePopup=n[0]),t.$set(o);const a={};64&e&&(a.max=n[6]),1048672&e&&(a.$$scope={dirty:e,ctx:n}),!s&&32&e&&(s=!0,a.value=n[5],Q((()=>s=!1))),i.$set(a),128&e&&r(d,d=n[7])?(p.d(1),p=df(n),p.c(),p.m(l,c)):p.p(n,e)},i(n){u||(on(t.$$.fragment,n),on(i.$$.fragment,n),on(a.$$.fragment,n),u=!0)},o(n){rn(t.$$.fragment,n),rn(i.$$.fragment,n),rn(a.$$.fragment,n),u=!1},d(n){n&&(x(e),x(o),x(l)),pn(t,n),pn(i,n),p.d(n),pn(a)}}}function af(n){let t,e,i,s,o,r=(n[5][0]||1)+"";return{c(){t=A("span"),e=C("折"),i=C(r),s=C("/"),o=C(n[6]),T(t,"slot","caption"),E(t,"float","right")},m(n,r){y(n,t,r),b(t,e),b(t,i),b(t,s),b(t,o)},p(n,t){32&t&&r!==(r=(n[5][0]||1)+"")&&S(i,r),64&t&&S(o,n[6])},d(n){n&&x(t)}}}function uf(n){let t,e,i,s,o=xt(n[17].id,"①")+wl(n[17].caption)+"";function r(){return n[14](n[17])}return{c(){t=A("div"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","tocitem"),L(t,"selecteditem",n[4]==n[17].id)},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(i,s){n=i,8&s&&o!==(o=xt(n[17].id,"①")+wl(n[17].caption)+"")&&S(e,o),24&s&&L(t,"selecteditem",n[4]==n[17].id)},d(n){n&&x(t),i=!1,s()}}}function df(n){let t,e=ln(n[3]),i=[];for(let t=0;t<e.length;t+=1)i[t]=uf(rf(n,e,t));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();t=P()},m(n,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,e);y(n,t,e)},p(n,s){if(538&s){let o;for(e=ln(n[3]),o=0;o<e.length;o+=1){const r=rf(n,e,o);i[o]?i[o].p(r,s):(i[o]=uf(r),i[o].c(),i[o].m(t.parentNode,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},d(n){n&&x(t),w(i,n)}}}function ff(n){let t,e,i,s;const o=[cf,lf],r=[];function l(n,t){return n[2]?1:0}return e=l(n),i=r[e]=o[e](n),{c(){t=A("div"),i.c(),T(t,"class","bodytext")},m(n,i){y(n,t,i),r[e].m(t,null),s=!0},p(n,[s]){let c=e;e=l(n),e===c?r[e].p(n,s):(en(),rn(r[c],1,1,(()=>{r[c]=null})),sn(),i=r[e],i?i.p(n,s):(i=r[e]=o[e](n),i.c()),on(i,1),i.m(t,null))},i(n){s||(on(i),s=!0)},o(n){rn(i),s=!1},d(n){n&&x(t),r[e].d()}}}function hf(n,t,e){let i,s,o,r,l,c,a,u,d;h(n,ro,(n=>e(2,o=n))),h(n,ao,(n=>e(10,r=n))),h(n,uo,(n=>e(11,l=n))),h(n,Ao,(n=>e(15,c=n))),h(n,so,(n=>e(12,a=n))),h(n,fo,(n=>e(6,u=n))),h(n,_o,(n=>e(7,d=n)));let{closePopup:f}=t;let p,g=[];const m=(n,t)=>{const e=n.defines.ck,i=n.nearestTag(e.linepos[t]+1,"folio","id");i!==l?kr(i,(()=>{vr(n,t)})):vr(n,t)};return n.$$set=n=>{"closePopup"in n&&e(0,f=n.closePopup)},n.$$.update=()=>{1024&n.$$.dirty&&e(5,i=[parseInt(r),0]),4096&n.$$.dirty&&e(1,s=Ki(a)),2054&n.$$.dirty&&e(3,g=((n,t,e)=>{if(e)return[];const i=[],s="bk#"+Mo(t),[o,r]=n.rangeOfAddress(s),l=n.defines.ck,c=Qn(l.linepos,o),a=Qn(l.linepos,r);for(let n=c;n<a;n++)i.push({caption:l._innertext.get(n),at:n,id:l.fields.id.values[n]});return i})(s,l,o)),1028&n.$$.dirty&&e(4,p=((n,t)=>{if(t)return"";const e=c;if(!e||!e.fromFolioPos)return"";const{ckid:i}=e.fromFolioPos(r);return i})(0,o))},[f,s,o,g,p,i,u,d,async n=>{if(o)return;const t=(n.detail[0]||1).toString();r!==t&&ao.set(t)},m,r,l,a,function(n){i=n,e(5,i),e(10,r)},n=>m(s,n.at)]}class pf extends $n{constructor(n){super(),mn(this,n,hf,ff,r,{closePopup:0})}}function gf(n){let t,e;return{c(){t=new M(!1),e=O(),t.a=e},m(n,i){t.m("&nbsp;",n,i),y(n,e,i)},d(n){n&&(t.d(),x(e))}}}function mf(n){let t;return{c(){t=C("首")},m(n,e){y(n,t,e)},d(n){n&&x(t)}}}function $f(n){let t,e=wl("錄",n[7])+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){128&i&&e!==(e=wl("錄",n[7])+"")&&S(t,e)},d(n){n&&x(t)}}}function vf(n){let t;return{c(){t=C("次")},m(n,e){y(n,t,e)},d(n){n&&x(t)}}}function kf(n){let t;return{c(){t=C("文")},m(n,e){y(n,t,e)},d(n){n&&x(t)}}}function bf(n){let t,e,i=n[5]&&xf(n);return{c(){t=C("🔠"),i&&i.c(),e=P()},m(n,s){y(n,t,s),i&&i.m(n,s),y(n,e,s)},p(n,t){n[5]?i?i.p(n,t):(i=xf(n),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null)},d(n){n&&(x(t),x(e)),i&&i.d(n)}}}function yf(n){let t,e,i=n[5]&&wf(n);return{c(){t=C("🔗"),i&&i.c(),e=P()},m(n,s){y(n,t,s),i&&i.m(n,s),y(n,e,s)},p(n,t){n[5]?i?i.p(n,t):(i=wf(n),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null)},d(n){n&&(x(t),x(e)),i&&i.d(n)}}}function xf(n){let t,e=wl("詞",n[7])+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){128&i&&e!==(e=wl("詞",n[7])+"")&&S(t,e)},d(n){n&&x(t)}}}function wf(n){let t,e=wl("鏈",n[7])+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){128&i&&e!==(e=wl("鏈",n[7])+"")&&S(t,e)},d(n){n&&x(t)}}}function Af(n){let t,e,i,s,o=n[5]&&Cf(n);return{c(){t=A("span"),e=C("🎵"),o&&o.c(),T(t,"aria-hidden","true"),T(t,"class","clickable"),L(t,"selected","audio"==n[1])},m(r,l){y(r,t,l),b(t,e),o&&o.m(t,null),i||(s=I(t,"click",n[15]),i=!0)},p(n,e){n[5]?o?o.p(n,e):(o=Cf(n),o.c(),o.m(t,null)):o&&(o.d(1),o=null),2&e&&L(t,"selected","audio"==n[1])},d(n){n&&x(t),o&&o.d(),i=!1,s()}}}function Cf(n){let t,e=wl("誦",n[7])+"";return{c(){t=C(e)},m(n,e){y(n,t,e)},p(n,i){128&i&&e!==(e=wl("誦",n[7])+"")&&S(t,e)},d(n){n&&x(t)}}}function Of(n){let t,e,i;return e=new Fl({props:{entries:n[4]}}),{c(){t=A("div"),fn(e.$$.fragment),T(t,"class","tab-content"),L(t,"visible","dict"==n[1])},m(n,s){y(n,t,s),hn(e,t,null),i=!0},p(n,s){const o={};16&s&&(o.entries=n[4]),e.$set(o),(!i||2&s)&&L(t,"visible","dict"==n[1])},i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){n&&x(t),pn(e)}}}function Pf(n){let t,e,i;return e=new Vd({}),{c(){t=A("div"),fn(e.$$.fragment),T(t,"class","tab-content"),L(t,"visible","dict"==n[1])},m(n,s){y(n,t,s),hn(e,t,null),i=!0},p(n,e){(!i||2&e)&&L(t,"visible","dict"==n[1])},i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){n&&x(t),pn(e)}}}function If(n){let t,e,i,o,r,l,c,a,u,d,f,h,p,g,m,$,v,k,w,P,_,S,N,E,z,M,j,F,B,q,R,H,W,D,K,J,Y,V,G,X=!n[5]&&gf(),Z=n[5]&&mf(),nn=n[5]&&$f(n),tn=n[5]&&vf(),ln=n[5]&&kf();function cn(n,t){return n[2]?yf:bf}let an=cn(n),un=an(n),gn=n[8].length>1&&Af(n);function mn(t){n[16](t)}let $n={closePopup:n[0]};void 0!==n[1]&&($n.thetab=n[1]),w=new ac({props:$n}),U.push((()=>dn(w,"thetab",mn))),N=new pf({props:{closePopup:n[0]}}),M=new Kd({props:{closePopup:n[0]}});const vn=[Pf,Of],kn=[];function bn(n,t){return n[2]?0:1}return F=bn(n),B=kn[F]=vn[F](n),H=new Dc({}),K=new _a({}),{c(){t=A("div"),e=A("div"),i=A("span"),X&&X.c(),o=C("⚙️"),Z&&Z.c(),r=O(),l=A("span"),c=C("📚"),nn&&nn.c(),a=O(),u=A("span"),d=C("🧭"),tn&&tn.c(),f=O(),h=A("span"),p=C("📜"),ln&&ln.c(),g=O(),m=A("span"),un.c(),$=O(),gn&&gn.c(),v=O(),k=A("div"),fn(w.$$.fragment),_=O(),S=A("div"),fn(N.$$.fragment),E=O(),z=A("div"),fn(M.$$.fragment),j=O(),B.c(),q=O(),R=A("div"),fn(H.$$.fragment),W=O(),D=A("div"),fn(K.$$.fragment),T(i,"aria-hidden","true"),T(i,"class","clickable"),L(i,"needupdate",n[6]),L(i,"selected","about"==n[1]),T(l,"aria-hidden","true"),T(l,"class","clickable"),L(l,"selected","list"==n[1]),T(u,"aria-hidden","true"),T(u,"class","clickable"),L(u,"selected","toc"==n[1]),T(h,"aria-hidden","true"),T(h,"class","clickable"),L(h,"selected","textual"==n[1]),T(m,"aria-hidden","true"),T(m,"class","clickable"),L(m,"selected","dict"==n[1]),T(e,"class","tabs"),T(k,"class","tab-content"),L(k,"visible","list"==n[1]),T(S,"class","tab-content"),L(S,"visible","toc"==n[1]),T(z,"class","tab-content"),L(z,"visible","textual"==n[1]),T(R,"class","tab-content"),L(R,"visible","audio"==n[1]),T(D,"class","tab-content"),L(D,"visible","about"==n[1]),T(t,"class","popup"),T(t,"style",J=n[5]?lr(n[5]):"")},m(s,x){y(s,t,x),b(t,e),b(e,i),X&&X.m(i,null),b(i,o),Z&&Z.m(i,null),b(e,r),b(e,l),b(l,c),nn&&nn.m(l,null),b(e,a),b(e,u),b(u,d),tn&&tn.m(u,null),b(e,f),b(e,h),b(h,p),ln&&ln.m(h,null),b(e,g),b(e,m),un.m(m,null),b(e,$),gn&&gn.m(e,null),b(t,v),b(t,k),hn(w,k,null),b(t,_),b(t,S),hn(N,S,null),b(t,E),b(t,z),hn(M,z,null),b(t,j),kn[F].m(t,null),b(t,q),b(t,R),hn(H,R,null),b(t,W),b(t,D),hn(K,D,null),Y=!0,V||(G=[I(i,"click",n[10]),I(l,"click",n[11]),I(u,"click",n[12]),I(h,"click",n[13]),I(m,"click",n[14])],V=!0)},p(n,s){n[5]?X&&(X.d(1),X=null):X||(X=gf(),X.c(),X.m(i,o)),n[5]?Z||(Z=mf(),Z.c(),Z.m(i,null)):Z&&(Z.d(1),Z=null),(!Y||64&s)&&L(i,"needupdate",n[6]),(!Y||2&s)&&L(i,"selected","about"==n[1]),n[5]?nn?nn.p(n,s):(nn=$f(n),nn.c(),nn.m(l,null)):nn&&(nn.d(1),nn=null),(!Y||2&s)&&L(l,"selected","list"==n[1]),n[5]?tn||(tn=vf(),tn.c(),tn.m(u,null)):tn&&(tn.d(1),tn=null),(!Y||2&s)&&L(u,"selected","toc"==n[1]),n[5]?ln||(ln=kf(),ln.c(),ln.m(h,null)):ln&&(ln.d(1),ln=null),(!Y||2&s)&&L(h,"selected","textual"==n[1]),an===(an=cn(n))&&un?un.p(n,s):(un.d(1),un=an(n),un&&(un.c(),un.m(m,null))),(!Y||2&s)&&L(m,"selected","dict"==n[1]),n[8].length>1?gn?gn.p(n,s):(gn=Af(n),gn.c(),gn.m(e,null)):gn&&(gn.d(1),gn=null);const r={};1&s&&(r.closePopup=n[0]),!P&&2&s&&(P=!0,r.thetab=n[1],Q((()=>P=!1))),w.$set(r),(!Y||2&s)&&L(k,"visible","list"==n[1]);const c={};1&s&&(c.closePopup=n[0]),N.$set(c),(!Y||2&s)&&L(S,"visible","toc"==n[1]);const a={};1&s&&(a.closePopup=n[0]),M.$set(a),(!Y||2&s)&&L(z,"visible","textual"==n[1]);let d=F;F=bn(n),F===d?kn[F].p(n,s):(en(),rn(kn[d],1,1,(()=>{kn[d]=null})),sn(),B=kn[F],B?B.p(n,s):(B=kn[F]=vn[F](n),B.c()),on(B,1),B.m(t,q)),(!Y||2&s)&&L(R,"visible","audio"==n[1]),(!Y||2&s)&&L(D,"visible","about"==n[1]),(!Y||32&s&&J!==(J=n[5]?lr(n[5]):""))&&T(t,"style",J)},i(n){Y||(on(w.$$.fragment,n),on(N.$$.fragment,n),on(M.$$.fragment,n),on(B),on(H.$$.fragment,n),on(K.$$.fragment,n),Y=!0)},o(n){rn(w.$$.fragment,n),rn(N.$$.fragment,n),rn(M.$$.fragment,n),rn(B),rn(H.$$.fragment,n),rn(K.$$.fragment,n),Y=!1},d(n){n&&x(t),X&&X.d(),Z&&Z.d(),nn&&nn.d(),tn&&tn.d(),ln&&ln.d(),un.d(),gn&&gn.d(),pn(w),pn(N),pn(M),kn[F].d(),pn(H),pn(K),V=!1,s(G)}}}function Tf(t){let e,i,s=t[3],o=If(t);return{c(){o.c(),e=P()},m(n,t){o.m(n,t),y(n,e,t),i=!0},p(t,[i]){8&i&&r(s,s=t[3])?(en(),rn(o,1,1,n),sn(),o=If(t),o.c(),on(o,1),o.m(e.parentNode,e)):o.p(t,i)},i(n){i||(on(o),i=!0)},o(n){rn(o),i=!1},d(n){n&&x(e),o.d(n)}}}function _f(n,t,e){let i,s,o,r,l,c,a;h(n,po,(n=>e(2,s=n))),h(n,bo,(n=>e(3,o=n))),h(n,so,(n=>e(17,r=n))),h(n,So,(n=>e(6,l=n))),h(n,_o,(n=>e(7,c=n))),h(n,zo,(n=>e(8,a=n)));let{tofind:u=""}=t,{closePopup:d}=t,f=o||!u?"textual":"dict";navigator.onLine||"dict"!=f||(f="list");let p=[];return n.$$set=n=>{"tofind"in n&&e(9,u=n.tofind),"closePopup"in n&&e(0,d=n.closePopup)},n.$$.update=()=>{8&n.$$.dirty&&e(5,i=o),512&n.$$.dirty&&(n=>{const t=n.indexOf(mr);xo.set(n.slice(t+1))})(u),4&n.$$.dirty&&s&&e(1,f="dict"),514&n.$$.dirty&&"dict"==f&&(n=>{var t;const i=n.indexOf(mr),s=Ki(r);e(4,p=(null===(t=s.columns.entries)||void 0===t?void 0:t.keys.findMatches(n.replace(mr,"")).map((n=>[Math.abs(n[0]-i-1),n[1],n[2]])))||[]),p.sort(((n,t)=>n[0]-t[0]))})(u)},[d,f,s,o,p,i,l,c,a,u,()=>e(1,f="about"),()=>e(1,f="list"),()=>e(1,f="toc"),()=>e(1,f="textual"),()=>e(1,f="dict"),()=>e(1,f="audio"),function(n){f=n,e(1,f),e(2,s)}]}class Sf extends $n{constructor(n){super(),mn(this,n,_f,Tf,r,{tofind:9,closePopup:0})}}function Nf(n){let t,e;return{c(){t=A("source"),u(t.src,e=Zs+n[1].replace(/\^\d+$/,"")+".mp3")||T(t,"src",e)},m(n,e){y(n,t,e)},p(n,i){2&i&&!u(t.src,e=Zs+n[1].replace(/\^\d+$/,"")+".mp3")&&T(t,"src",e)},d(n){n&&x(t)}}}function Ef(n){let t,e=n[1]&&Nf(n);return{c(){t=A("audio"),e&&e.c()},m(i,s){y(i,t,s),e&&e.m(t,null),n[3](t)},p(n,i){n[1]?e?e.p(n,i):(e=Nf(n),e.c(),e.m(t,null)):e&&(e.d(1),e=null)},d(i){i&&x(t),e&&e.d(),n[3](null)}}}function zf(t){let e,i=t[1],s=Ef(t);return{c(){s.c(),e=P()},m(n,t){s.m(n,t),y(n,e,t)},p(n,[t]){2&t&&r(i,i=n[1])?(s.d(1),s=Ef(n),s.c(),s.m(e.parentNode,e)):s.p(n,t)},i:n,o:n,d(n){n&&x(e),s.d(n)}}}function Lf(n,t,e){let i,s,o,r,l,c;h(n,jo,(n=>e(1,i=n))),h(n,ao,(n=>e(2,s=n))),h(n,uo,(n=>e(5,o=n))),h(n,Ro,(n=>e(6,r=n))),h(n,Ho,(n=>e(7,l=n)));return n.$$.update=()=>{1&n.$$.dirty&&(Eo=c),6&n.$$.dirty&&((n,t)=>{if(!t||l||!r)return;const{timestamp:e,bookid:i}=Xo(t);if(i!==o&&Zo(),!e)return;const s=e[(parseInt(n)-1)*Bo()];setTimeout((()=>{Eo&&(Eo.currentTime=s/100)}),100)})(s,i)},[c,i,s,function(n){U[n?"unshift":"push"]((()=>{c=n,e(0,c)}))}]}class Mf extends $n{constructor(n){super(),mn(this,n,Lf,zf,r,{})}}function jf(n){let t,e,i,s,r,l,c,a,u,d,f,h,p,g,m,$,v,k,b,w,P,_,S,N,z,L,M,j,F,B,q,R,H,W,D=wl("僅供非佛學專業人士使用")+"",K=wl("漢字顯示")+"",J=wl("全屏模式安裝步驟")+"",Y=wl("安卓：右上角⋮ →安裝應用程式")+"",V=wl("iOS：分享→加到主畫面")+"",G=wl("本軟件不會主動收集個人資訊")+"",X=wl("同意接受使用本軟件產生的任何結果")+"";function Z(t){n[3](t)}u=new pa({props:{states:{0:"原貌",1:wl("简體（「乾後發」等不變）"),2:"简体"},storeid:_o}});let nn={label:wl("啟用時再度顯示此畫面"),design:"slider"};return void 0!==n[1]&&(nn.value=n[1]),B=new Sc({props:nn}),U.push((()=>dn(B,"value",Z))),{c(){t=A("span"),t.textContent=`${wl("永樂藏")} ${Vs}`,e=O(),i=A("br"),s=C(D),r=O(),l=A("br"),c=C(K),a=C("："),fn(u.$$.fragment),d=O(),f=A("br"),h=C(J),p=O(),g=A("br"),m=C(Y),$=O(),v=A("br"),k=C(V),b=O(),w=A("hr"),P=O(),_=C(G),S=O(),N=A("br"),z=C(X),L=O(),M=A("br"),j=A("button"),j.textContent="同意",F=O(),fn(B.$$.fragment),T(t,"class","welcome"),E(j,"font-size","150%"),E(j,"width","100%")},m(x,A){y(x,t,A),y(x,e,A),y(x,i,A),y(x,s,A),y(x,r,A),y(x,l,A),y(x,c,A),y(x,a,A),hn(u,x,A),y(x,d,A),y(x,f,A),y(x,h,A),y(x,p,A),y(x,g,A),y(x,m,A),y(x,$,A),y(x,v,A),y(x,k,A),y(x,b,A),y(x,w,A),y(x,P,A),y(x,_,A),y(x,S,A),y(x,N,A),y(x,z,A),y(x,L,A),y(x,M,A),y(x,j,A),y(x,F,A),hn(B,x,A),R=!0,H||(W=I(j,"click",(function(){o(n[0])&&n[0].apply(this,arguments)})),H=!0)},p(t,e){n=t;const i={};!q&&2&e&&(q=!0,i.value=n[1],Q((()=>q=!1))),B.$set(i)},i(n){R||(on(u.$$.fragment,n),on(B.$$.fragment,n),R=!0)},o(n){rn(u.$$.fragment,n),rn(B.$$.fragment,n),R=!1},d(n){n&&(x(t),x(e),x(i),x(s),x(r),x(l),x(c),x(a),x(d),x(f),x(h),x(p),x(g),x(m),x($),x(v),x(k),x(b),x(w),x(P),x(_),x(S),x(N),x(z),x(L),x(M),x(j),x(F)),pn(u,n),pn(B,n),H=!1,W()}}}function Ff(t){let e,i,s,o=t[2],l=jf(t);return{c(){e=A("div"),i=A("div"),l.c(),T(i,"class","bodytext"),T(e,"class","popup")},m(n,t){y(n,e,t),b(e,i),l.m(i,null),s=!0},p(t,[e]){4&e&&r(o,o=t[2])?(en(),rn(l,1,1,n),sn(),l=jf(t),l.c(),on(l,1),l.m(i,null)):l.p(t,e)},i(n){s||(on(l),s=!0)},o(n){rn(l),s=!1},d(n){n&&x(e),l.d(n)}}}function Bf(n,t,e){let i,s;h(n,Ko,(n=>e(4,i=n))),h(n,_o,(n=>e(2,s=n)));let o=i,{closePopup:r}=t;return q((()=>{Ko.set(o)})),n.$$set=n=>{"closePopup"in n&&e(0,r=n.closePopup)},[r,o,s,function(n){o=n,e(1,o)}]}class qf extends $n{constructor(n){super(),mn(this,n,Bf,Ff,r,{closePopup:0})}}function Rf(n){let t,e,i,s,o,r,l,c,a,d;return{c(){t=A("div"),e=A("img"),s=O(),o=A("div"),r=C(n[1]),c=O(),a=A("div"),a.innerHTML='<div class="paijitext"><br/>　諸供養中　法供養最\n<br/>願以此功德　普及於一切\n<br/>我等與眾生　皆共成佛道</div>',T(e,"alt","frame"),u(e.src,i="frames/red.jpg")||T(e,"src","frames/red.jpg"),T(e,"class","svelte-1p857lj"),T(o,"class","sponsor"),T(o,"style",l="padding-left:"+(n[0]?cr(n[3],.45):"45vw")),T(a,"class","paijitextcontainer"),T(t,"class","paiji"),T(t,"style",d="width:"+(n[0]?cr():""))},m(n,i){y(n,t,i),b(t,e),b(t,s),b(t,o),b(o,r),b(t,c),b(t,a)},p(n,e){2&e&&S(r,n[1]),9&e&&l!==(l="padding-left:"+(n[0]?cr(n[3],.45):"45vw"))&&T(o,"style",l),1&e&&d!==(d="width:"+(n[0]?cr():""))&&T(t,"style",d)},d(n){n&&x(t)}}}function Hf(n){let t,e,i,s,o,r,l;return{c(){t=A("div"),e=A("div"),i=C(n[1]),s=O(),o=A("div"),o.textContent="我等與眾生皆共成佛道",r=O(),l=A("div"),l.textContent="願以此功德普及於一切",T(e,"class","sidesponsor"),T(o,"class","sidesponsortext"),T(l,"class","sidesponsortext2"),T(t,"class","sidepaiji"),T(t,"style",lr())},m(n,c){y(n,t,c),b(t,e),b(e,i),b(t,s),b(t,o),b(t,r),b(t,l)},p(n,t){2&t&&S(i,n[1])},d(n){n&&x(t)}}}function Uf(t){let e,i;function s(n,t){return 1&t&&(e=null),null==e&&(e=!(!ur()||n[0])),e?Hf:n[2]?void 0:Rf}let o=s(t,-1),r=o&&o(t);return{c(){r&&r.c(),i=P()},m(n,t){r&&r.m(n,t),y(n,i,t)},p(n,[t]){o===(o=s(n,t))&&r?r.p(n,t):(r&&r.d(1),r=o&&o(n),r&&(r.c(),r.m(i.parentNode,i)))},i:n,o:n,d(n){n&&x(i),r&&r.d(n)}}}function Wf(n,t,e){let i,s;h(n,Ro,(n=>e(2,i=n))),h(n,bo,(n=>e(3,s=n)));let o=0,{forceshow:r=!1}=t,l=ar[0],c=setInterval((()=>{e(1,l=ar[++o%ar.length])}),5e3);return q((()=>{clearInterval(c)})),n.$$set=n=>{"forceshow"in n&&e(0,r=n.forceshow)},[r,l,i,s]}class Df extends $n{constructor(n){super(),mn(this,n,Wf,Uf,r,{forceshow:0})}}function Kf(n){let t,e;return{c(){t=A("div"),e=C(n[0]),T(t,"class","notification")},m(n,i){y(n,t,i),b(t,e)},p(n,t){1&t&&S(e,n[0])},d(n){n&&x(t)}}}function Jf(t){let e,i=t[0]&&Kf(t);return{c(){i&&i.c(),e=P()},m(n,t){i&&i.m(n,t),y(n,e,t)},p(n,[t]){n[0]?i?i.p(n,t):(i=Kf(n),i.c(),i.m(e.parentNode,e)):i&&(i.d(1),i=null)},i:n,o:n,d(n){n&&x(e),i&&i.d(n)}}}function Yf(n,t,e){let i;h(n,Lo,(n=>e(1,i=n)));let s,o="";return n.$$.update=()=>{2&n.$$.dirty&&(e(0,o=i),clearTimeout(s),s=setTimeout((()=>{e(0,o="")}),4e3))},[o,i]}class Qf extends $n{constructor(n){super(),mn(this,n,Yf,Jf,r,{})}}function Vf(n,t,e){const i=n.slice();return i[10]=t[e],i}function Gf(n,t,e){const i=n.slice();return i[10]=t[e],i}function Xf(n,t,e){const i=n.slice();return i[10]=t[e],i}function Zf(n){let t,e,i,s,o=n[0].get(n[10])+" ";function r(){return n[6](n[10])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable")},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(t,i){n=t,3&i&&o!==(o=n[0].get(n[10])+" ")&&S(e,o)},d(n){n&&x(t),i=!1,s()}}}function nh(n){let t,e,i,s,o=n[0].get(n[10])+" ";function r(){return n[7](n[10])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable")},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(t,i){n=t,9&i&&o!==(o=n[0].get(n[10])+" ")&&S(e,o)},d(n){n&&x(t),i=!1,s()}}}function th(n){let t,e,i,s,o=n[0].get(n[10])+" ";function r(){return n[8](n[10])}return{c(){t=A("span"),e=C(o),T(t,"aria-hidden","true"),T(t,"class","clickable")},m(n,o){y(n,t,o),b(t,e),i||(s=I(t,"click",r),i=!0)},p(t,i){n=t,5&i&&o!==(o=n[0].get(n[10])+" ")&&S(e,o)},d(n){n&&x(t),i=!1,s()}}}function eh(t){let e,i,s,o,r,l,c,a,u,d=ln(t[1]),f=[];for(let n=0;n<d.length;n+=1)f[n]=Zf(Xf(t,d,n));let h=ln(t[3]),p=[];for(let n=0;n<h.length;n+=1)p[n]=nh(Gf(t,h,n));let g=ln(t[2]),m=[];for(let n=0;n<g.length;n+=1)m[n]=th(Vf(t,g,n));return{c(){e=A("div");for(let n=0;n<f.length;n+=1)f[n].c();i=O(),s=A("hr"),o=O(),r=A("div");for(let n=0;n<p.length;n+=1)p[n].c();l=O(),c=A("hr"),a=O(),u=A("div");for(let n=0;n<m.length;n+=1)m[n].c();T(e,"class","bodytext"),T(r,"class","bodytext"),T(u,"class","bodytext")},m(n,t){y(n,e,t);for(let n=0;n<f.length;n+=1)f[n]&&f[n].m(e,null);y(n,i,t),y(n,s,t),y(n,o,t),y(n,r,t);for(let n=0;n<p.length;n+=1)p[n]&&p[n].m(r,null);y(n,l,t),y(n,c,t),y(n,a,t),y(n,u,t);for(let n=0;n<m.length;n+=1)m[n]&&m[n].m(u,null)},p(n,[t]){if(3&t){let i;for(d=ln(n[1]),i=0;i<d.length;i+=1){const s=Xf(n,d,i);f[i]?f[i].p(s,t):(f[i]=Zf(s),f[i].c(),f[i].m(e,null))}for(;i<f.length;i+=1)f[i].d(1);f.length=d.length}if(9&t){let e;for(h=ln(n[3]),e=0;e<h.length;e+=1){const i=Gf(n,h,e);p[e]?p[e].p(i,t):(p[e]=nh(i),p[e].c(),p[e].m(r,null))}for(;e<p.length;e+=1)p[e].d(1);p.length=h.length}if(5&t){let e;for(g=ln(n[2]),e=0;e<g.length;e+=1){const i=Vf(n,g,e);m[e]?m[e].p(i,t):(m[e]=th(i),m[e].c(),m[e].m(u,null))}for(;e<m.length;e+=1)m[e].d(1);m.length=g.length}},i:n,o:n,d(n){n&&(x(e),x(i),x(s),x(o),x(r),x(l),x(c),x(a),x(u)),w(f,n),w(p,n),w(m,n)}}}function ih(n,t,e){let i;h(n,Co,(n=>e(5,i=n)));let s,{ptk:o}=t,r=[],l=[],c=[];return n.$$set=n=>{"ptk"in n&&e(4,o=n.ptk)},n.$$.update=()=>{var t;32&n.$$.dirty&&(t=i,e(1,r=[]),e(2,l=[]),e(3,c=[]),t.trim()&&(t.length>4||(e(0,s=o.columns.entries.keys),e(1,r=s.enumStart(t,20)),e(2,l=s.enumMiddle(t,20)),e(3,c=s.enumEnd(t,20)))))},[s,r,l,c,o,i,n=>xo.set(s.get(n)),n=>xo.set(s.get(n)),n=>xo.set(s.get(n))]}class sh extends $n{constructor(n){super(),mn(this,n,ih,eh,r,{ptk:4})}}function oh(n){let t,e;return t=new sh({props:{ptk:n[0]}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};1&e&&(i.ptk=n[0]),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function rh(n){let t,e,i,s="input"==n[2]&&oh(n);return{c(){t=A("div"),s&&s.c(),T(t,"class","left svelte-1uyqkjl"),T(t,"style",e="width:"+cr(n[1]))},m(n,e){y(n,t,e),s&&s.m(t,null),i=!0},p(n,[o]){"input"==n[2]?s?(s.p(n,o),4&o&&on(s,1)):(s=oh(n),s.c(),on(s,1),s.m(t,null)):s&&(en(),rn(s,1,1,(()=>{s=null})),sn()),(!i||2&o&&e!==(e="width:"+cr(n[1])))&&T(t,"style",e)},i(n){i||(on(s),i=!0)},o(n){rn(s),i=!1},d(n){n&&x(t),s&&s.d()}}}function lh(n,t,e){let i,s,o,r;return h(n,so,(n=>e(3,s=n))),h(n,bo,(n=>e(1,o=n))),h(n,wo,(n=>e(2,r=n))),n.$$.update=()=>{8&n.$$.dirty&&e(0,i=Ki(s))},[i,o,r,s]}class ch extends $n{constructor(n){super(),mn(this,n,lh,rh,r,{})}}function ah(t){let e,i,s,o,r,l,c,a;return{c(){e=A("div"),i=C("永樂藏 "),s=C(Vs),o=O(),r=A("a"),r.textContent="官網",l=O(),c=A("br"),a=C(t[4]),T(r,"href","https://nissaya.cn/"),T(r,"target","_new"),T(e,"class","bodytext")},m(n,t){y(n,e,t),b(e,i),b(e,s),b(e,o),b(e,r),b(e,l),b(e,c),b(e,a)},p(n,t){16&t&&S(a,n[4])},i:n,o:n,d(n){n&&x(e)}}}function uh(t){let e,i,s,o,l,c,a,u,d,f,h=t[9],p=t[8]&&!t[5]&&!t[6]&&!t[0]&&"on"==t[7]&&dh(),g=fh(t),m="folio"!==t[10]&&hh(),$=(t[6]||t[5])&&!t[0]&&ph(t),v=(t[5]||t[0])&&gh(t),k=t[6]&&mh(t);return a=new Mf({}),d=new Qf({}),{c(){p&&p.c(),e=O(),g.c(),i=O(),m&&m.c(),s=O(),$&&$.c(),o=O(),v&&v.c(),l=O(),k&&k.c(),c=O(),fn(a.$$.fragment),u=O(),fn(d.$$.fragment)},m(n,t){p&&p.m(n,t),y(n,e,t),g.m(n,t),y(n,i,t),m&&m.m(n,t),y(n,s,t),$&&$.m(n,t),y(n,o,t),v&&v.m(n,t),y(n,l,t),k&&k.m(n,t),y(n,c,t),hn(a,n,t),y(n,u,t),hn(d,n,t),f=!0},p(t,a){!t[8]||t[5]||t[6]||t[0]||"on"!=t[7]?p&&(en(),rn(p,1,1,(()=>{p=null})),sn()):p?481&a&&on(p,1):(p=dh(),p.c(),on(p,1),p.m(e.parentNode,e)),512&a&&r(h,h=t[9])?(en(),rn(g,1,1,n),sn(),g=fh(t),g.c(),on(g,1),g.m(i.parentNode,i)):g.p(t,a),"folio"!==t[10]?m?1024&a&&on(m,1):(m=hh(),m.c(),on(m,1),m.m(s.parentNode,s)):m&&(en(),rn(m,1,1,(()=>{m=null})),sn()),!t[6]&&!t[5]||t[0]?$&&($.d(1),$=null):$?$.p(t,a):($=ph(t),$.c(),$.m(o.parentNode,o)),t[5]||t[0]?v?(v.p(t,a),33&a&&on(v,1)):(v=gh(t),v.c(),on(v,1),v.m(l.parentNode,l)):v&&(en(),rn(v,1,1,(()=>{v=null})),sn()),t[6]?k?(k.p(t,a),64&a&&on(k,1)):(k=mh(t),k.c(),on(k,1),k.m(c.parentNode,c)):k&&(en(),rn(k,1,1,(()=>{k=null})),sn())},i(n){f||(on(p),on(g),on(m),on(v),on(k),on(a.$$.fragment,n),on(d.$$.fragment,n),f=!0)},o(n){rn(p),rn(g),rn(m),rn(v),rn(k),rn(a.$$.fragment,n),rn(d.$$.fragment,n),f=!1},d(n){n&&(x(e),x(i),x(s),x(o),x(l),x(c),x(u)),p&&p.d(n),g.d(n),m&&m.d(n),$&&$.d(n),v&&v.d(n),k&&k.d(n),pn(a,n),pn(d,n)}}}function dh(n){let t,e;return t=new Df({}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function fh(n){let t,e;return t=new yl({props:{src:n[9]+".zip",onTapText:n[13],onMainmenu:n[12]}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};512&e&&(i.src=n[9]+".zip"),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function hh(n){let t,e;return t=new ch({}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function ph(t){let e,i,s;return{c(){e=A("span"),e.textContent="✖️",T(e,"aria-hidden","true"),T(e,"class","closepopup")},m(n,o){y(n,e,o),i||(s=I(e,"click",t[11]),i=!0)},p:n,d(n){n&&x(e),i=!1,s()}}}function gh(n){let t,e;return t=new Sf({props:{tofind:n[1],closePopup:n[11]}}),{c(){fn(t.$$.fragment)},m(n,i){hn(t,n,i),e=!0},p(n,e){const i={};2&e&&(i.tofind=n[1]),t.$set(i)},i(n){e||(on(t.$$.fragment,n),e=!0)},o(n){rn(t.$$.fragment,n),e=!1},d(n){pn(t,n)}}}function mh(t){let e,i;return e=new qf({props:{closePopup:t[11]}}),{c(){fn(e.$$.fragment)},m(n,t){hn(e,n,t),i=!0},p:n,i(n){i||(on(e.$$.fragment,n),i=!0)},o(n){rn(e.$$.fragment,n),i=!1},d(n){pn(e,n)}}}function $h(n){let t,e,i,s;const o=[uh,ah],r=[];function l(n,t){return n[3]?0:1}return e=l(n),i=r[e]=o[e](n),{c(){t=A("div"),i.c(),T(t,"class","app")},m(i,o){y(i,t,o),r[e].m(t,null),n[14](t),s=!0},p(n,[s]){let c=e;e=l(n),e===c?r[e].p(n,s):(en(),rn(r[c],1,1,(()=>{r[c]=null})),sn(),i=r[e],i?i.p(n,s):(i=r[e]=o[e](n),i.c()),on(i,1),i.m(t,null))},i(n){s||(on(i),s=!0)},o(n){rn(i),s=!1},d(i){i&&x(t),r[e].d(),n[14](null)}}}function vh(n,t,e){let i,s,o,r,l,c,a,u;h(n,bo,(n=>e(0,i=n))),h(n,Ko,(n=>e(16,s=n))),h(n,Jo,(n=>e(17,o=n))),h(n,vo,(n=>e(7,r=n))),h(n,Yo,(n=>e(8,l=n))),h(n,uo,(n=>e(9,c=n))),h(n,wo,(n=>e(10,a=n))),function(n="./sw.js"){const t=Qr(),e=document.location.protocol;"serviceWorker"in navigator&&(t||"https:"==e)&&navigator.serviceWorker.register(n)}(),yo.set(!!navigator.userAgent.match(/Android/i));const d=()=>{eo.set(navigator.onLine||"127.0.0.1"==location.hostname||"localhost"==location.hostname)};let p;window.addEventListener("online",d),window.addEventListener("offline",d);let g,m=!1,$="啟動中";q((()=>clearInterval(g)));const v=async n=>{e(4,$="try to download "+n+".ptk");const t=await Gr(Qs,n+".ptk",(t=>{e(4,$=n+".ptk "+t)})),i=await t.arrayBuffer(),s=await Di(n,new Uint8Array(i));return Fs(s),s};let k=!1,b="on"==s;return setTimeout((async()=>{xl();const n=await Xr(Qs);for(let t=0;t<Qo.length;t++)~n.indexOf(Qo[t])||n.push(Qo[t]);for(let t=0;t<n.length;t++){const i=await v(n[t]);e(4,$="open ptk "+n[t]),"dc"==n[t]&&no(i)}e(4,$="fetching foliolist from cache"),await pr(oo),e(4,$="load folio address from url");let t=At();~t.indexOf("bk")||(t=localStorage.getItem(Rs+"homeurl")||""),await Ar(t),e(4,$="loaded"),e(3,m=!0),g=setInterval((()=>{Yo.set(o>=30),b||k||"on"!=r||Jo.set(o+2)}),2e3)}),500),n.$$.update=()=>{var t;1&n.$$.dirty&&(t=i,e(5,k=!1),t&&e(6,b=!1),Jo.set(0))},[i,u,p,m,$,k,b,r,l,c,a,()=>{e(6,b=!1),f(bo)||e(5,k=!1)},()=>{e(5,k=!1)},n=>{e(5,k=!0),"string"==typeof n&&e(1,u=n)},function(n){U[n?"unshift":"push"]((()=>{p=n,e(2,p)}))}]}const kh=new class extends $n{constructor(n){super(),mn(this,n,vh,$h,r,{})}}({target:document.body});return document.querySelector("#bootmessage").innerHTML="",kh}();
//# sourceMappingURL=index.js.map
